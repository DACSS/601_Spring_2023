<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.427">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aditya Salveru">
<meta name="dcterms.date" content="2023-05-22">
<meta name="description" content="Project &amp; Data Description">

<title>Final Project : Aditya Salveru</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="Final Project : Aditya Salveru">
<meta name="twitter:description" content="Project &amp; Data Description">
<meta name="twitter:image" content="https://dacss.github.io/601_Spring_2023/posts/AdityaSalveruFinalProject_files/figure-html/unnamed-chunk-13-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/DACSS" rel="" target="">
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#describe-the-data-sets" id="toc-describe-the-data-sets" class="nav-link active" data-scroll-target="#describe-the-data-sets">Part 1. Introduction</a>
  <ul class="collapse">
  <li><a href="#datasets-introduction" id="toc-datasets-introduction" class="nav-link" data-scroll-target="#datasets-introduction">1. Dataset(s) Introduction:</a></li>
  <li><a href="#what-questions-do-you-like-to-answer-with-this-datasets" id="toc-what-questions-do-you-like-to-answer-with-this-datasets" class="nav-link" data-scroll-target="#what-questions-do-you-like-to-answer-with-this-datasets">2. What questions do you like to answer with this dataset(s)?</a></li>
  </ul></li>
  <li><a href="#describe-the-data-sets-1" id="toc-describe-the-data-sets-1" class="nav-link" data-scroll-target="#describe-the-data-sets-1">Part 2. Describe the data set(s)</a>
  <ul class="collapse">
  <li><a href="#clean-the-data" id="toc-clean-the-data" class="nav-link" data-scroll-target="#clean-the-data">Clean the Data</a></li>
  </ul></li>
  <li><a href="#part-3-visualization" id="toc-part-3-visualization" class="nav-link" data-scroll-target="#part-3-visualization">Part 3: Visualization</a>
  <ul class="collapse">
  <li><a href="#analysis-of-various-factors-and-the-probability-of-heart-disease" id="toc-analysis-of-various-factors-and-the-probability-of-heart-disease" class="nav-link" data-scroll-target="#analysis-of-various-factors-and-the-probability-of-heart-disease">Analysis of various factors and the probability of heart disease</a></li>
  <li><a href="#analyzing-the-most-vulnerable-population" id="toc-analyzing-the-most-vulnerable-population" class="nav-link" data-scroll-target="#analyzing-the-most-vulnerable-population">Analyzing the most vulnerable population</a></li>
  </ul></li>
  <li><a href="#part-4-conclusion" id="toc-part-4-conclusion" class="nav-link" data-scroll-target="#part-4-conclusion">Part 4 : Conclusion</a></li>
  <li><a href="#part-5-bibliography" id="toc-part-5-bibliography" class="nav-link" data-scroll-target="#part-5-bibliography">Part 5 : Bibliography</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project : Aditya Salveru</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">final_Project_assignment_1</div>
    <div class="quarto-category">Behavioral Risk Factor Surveillance System (BRFSS)</div>
  </div>
  </div>

<div>
  <div class="description">
    Project &amp; Data Description
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aditya Salveru </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 22, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<!-- ## Important Formatting & Submission Notes: {#important-formatting-submission-notes} -->
<!-- 1.  **Use this file as the template to work on: start your own writing from Section "Part.1"** -->
<!-- 2.  **Please make the following changes to the above YAML header:** -->
<!--     -   Change the "title" to "Final Project Assignment#1: First Name Last Name"; -->
<!--     -   Change the "author" to your name; -->
<!--     -   Change the "date" to the current date in the "MM-DD-YYYY" format; -->
<!-- 3.  **Submission:** -->
<!--     -   Delete the unnecessary sections ("Overview", "Tasks", "Special Note", and "Evaluation"). -->
<!--     -   **In the posts folder of your local 601_Spring_2023 project, create a folder named "FirstNameLastName_FinalProjectData", and save your final project dataset(s) in this folder. DO NOT save the dataset(s) to the \_data folder which stores the dataset(s) for challenges.** -->
<!--     -   Render and submit the file to the blog post like a regular challenge. -->
<!-- ## Overview of the Final Project {#overview-of-the-final-project} -->
<!-- The goal is to tell a coherent and focused story with your data, which answers a question (or questions) that a researcher, or current or future employer, might want to have answered. The goal might be to understand a source of covariance, make a recommendation, or understand change over time. We don't expect you to reach a definitive conclusion in this analysis. Still, you are expected to tell a data-driven story using evidence to support the claims you are making on the basis of the exploratory analysis conducted over the past term. -->
<!-- In this final project, statistical analyses **are not required**, but any students who wish to include these may do so. However, **your primary analysis should center around visualization rather than inferential statistics.** Many scientists only compute statistics after a careful process of exploratory data analysis and data visualization. Statistics are a way to gauge your certainty in your results - **NOT A WAY TO DISCOVER MEANINGFUL DATA PATTERNS**. **Do not run a multiple regression with numerous predictors and report which predictors are significant!!** -->
<!-- ## Tasks of Assignment#1 {#Tasks-of-assignment1} -->
<!-- This assignment is the first component of your final project. Together with the later assignments, it make up a short paper/report. In this assignment, you should introduce a dataset(s) and how you plan to present this dataset(s). This assignment should include the following components: -->
<!-- 1.  **A clear description of the dataset(s) that you are using.** -->
<!-- 2.  **What "story" do you want to present to the audience? In other words, what "question(s)" do you like to answer with this dataset(s)?** -->
<!-- 3.  **The Plan for Further Analysis and Visualization.** -->
<!-- We will have a special class meeting on April 12 to review and discuss students' proposed datasets for the final project. **If you want your project being discussed in the class, please submit this assignment before April 12.** -->
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="describe-the-data-sets" class="level2">
<h2 class="anchored" data-anchor-id="describe-the-data-sets">Part 1. Introduction</h2>
<p>My projects aims to analyze the heart disease data and explore the causes and general trends in the individuals with and without the heart disease. Particularly I am interested in finding the factors that contribute to the heart disease the most and early signs that might lead to a heart disease. I would also like to analyze the healthy habits that would keep the heart diseases away.</p>
<section id="datasets-introduction" class="level3">
<h3 class="anchored" data-anchor-id="datasets-introduction">1. Dataset(s) Introduction:</h3>
<p>I have chosen the 2020 annual CDC survey data of 400k adults related to their health status collected by Behavioral Risk Factor Surveillance System (BRFSS). For people of the majority of racial groups in the US (African Americans, American Indians and Alaska Natives, and white people), heart disease is one of the leading causes of death, according to the CDC. In the field of medicine, it is crucial to identify and combat the causes that have the biggest influence on heart disease.</p>
<p>The Behavioral Risk Factor Surveillance System (BRFSS) is a collaborative project between all the states in the United States and participating US territories and the Centers for Disease Control and Prevention (CDC). The BRFSS is administered and supported by CDC’s Population Health Surveillance Branch, under the Division of Population Health at CDC’s National Center for Chronic Disease Prevention and Health Promotion. The BRFSS is a system of ongoing health-related telephone surveys designed to collect data on health-related risk behaviors, chronic health conditions, health-care access, and use of preventive services from the non institutionalized adult population (≥ 18 years) residing in the United States and participating areas.</p>
</section>
<section id="what-questions-do-you-like-to-answer-with-this-datasets" class="level3">
<h3 class="anchored" data-anchor-id="what-questions-do-you-like-to-answer-with-this-datasets">2. What questions do you like to answer with this dataset(s)?</h3>
<ul>
<li><p>How is heart disease related to physical attributes such as Gender, sleep time, BMI etc.</p></li>
<li><p>Is there any particular group of people who are at high risk?</p></li>
<li><p>What changes should the high risk people incorporate to reduce the risk of heart disease.</p></li>
</ul>
</section>
</section>
<section id="describe-the-data-sets-1" class="level2">
<h2 class="anchored" data-anchor-id="describe-the-data-sets-1">Part 2. Describe the data set(s)</h2>
<!-- This part contains both a coding and a storytelling component. -->
<!-- In the coding component, you should: -->
<ol type="1">
<li>read the dataset;</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>columns <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"/home/aditya/Desktop/HealthData/2020/2020-column-layout.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>columns<span class="sc">$</span>File_Width <span class="ot">=</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(columns), <span class="cf">function</span>(y) <span class="fu">ifelse</span>(y <span class="sc">&lt;</span> <span class="fu">nrow</span>(columns),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    columns<span class="sc">$</span>Starting_Column[y <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">-</span> columns<span class="sc">$</span>Starting_Column[y], <span class="dv">1</span>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>columns <span class="ot">=</span> columns[columns<span class="sc">$</span>File_Width <span class="sc">&gt;</span> <span class="dv">0</span>,]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>responses <span class="ot">=</span> <span class="fu">read.fwf</span>(<span class="st">"/home/aditya/Desktop/HealthData/2020/LLCP2020.ASC "</span>, <span class="at">widths =</span> columns<span class="sc">$</span>File_Width, <span class="at">col.names =</span> columns<span class="sc">$</span>Variable_Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- ```{r} -->
<!-- responses = read_csv('/home/aditya/Desktop/HealthData/2020/filtered.csv') -->
<!-- ``` -->
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(responses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 401958</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(responses)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 277</code></pre>
</div>
</div>
<ul>
<li>There are 401958 rows in the data set</li>
<li>There are 277 columns in the data set</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>responses <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "ACEDEPRS"  "ACEDIVRC"  "ACEDRINK"  "ACEDRUGS"  "ACEHURT1"  "ACEHVSEX" 
  [7] "ACEPRISN"  "ACEPUNCH"  "ACESWEAR"  "ACETOUCH"  "ACETTHEM"  "ADDEPEV3" 
 [13] "ALCDAY5"   "ASTHMA3"   "ASTHNOW"   "AVEDRNK3"  "BIRTHSEX"  "BLDSTOL1" 
 [19] "BLDSUGAR"  "BLIND"     "CADULT1"   "CAREGIV1"  "CASTHDX2"  "CASTHNO2" 
 [25] "CCLGHOUS"  "CDASSIST"  "CDDISCUS"  "CDHELP"    "CDHOUSE"   "CDSOCIAL" 
 [31] "CELLFON5"  "CELLSEX"   "CELPHONE"  "CHCCOPD2"  "CHCKDNY2"  "CHCOCNCR" 
 [37] "CHCSCNCR"  "CHECKUP1"  "CHILDREN"  "CHKHEMO3"  "CIMEMLOS"  "CNCRAGE"  
 [43] "CNCRDIFF"  "CNCRTYP1"  "COLGHOUS"  "COLGSEX"   "COLNSCPY"  "COLNTEST" 
 [49] "CPDEMO1B"  "CRGVALZD"  "CRGVEXPT"  "CRGVHOU1"  "CRGVHRS1"  "CRGVLNG1" 
 [55] "CRGVPER1"  "CRGVPRB3"  "CRGVREL4"  "CSRVCLIN"  "CSRVCTL2"  "CSRVDEIN" 
 [61] "CSRVDOC1"  "CSRVINSR"  "CSRVINST"  "CSRVPAIN"  "CSRVRTRN"  "CSRVSUM"  
 [67] "CSRVTRT3"  "CSTATE1"   "CTELENM1"  "CTELNUM1"  "CVDCRHD4"  "CVDINFR4" 
 [73] "CVDSTRK3"  "DEAF"      "DECIDE"    "DIABAGE3"  "DIABEDU"   "DIABETE4" 
 [79] "DIABEYE"   "DIFFALON"  "DIFFDRES"  "DIFFWALK"  "DISPCODE"  "DOCTDIAB" 
 [85] "DRNK3GE5"  "DRNKANY5"  "DRNKDRI2"  "DROCDY3_"  "ECIGARET"  "ECIGNOW"  
 [91] "EDUCA"     "EMPLOY1"   "EXERANY2"  "EYEEXAM1"  "FALL12MN"  "FALLINJ4" 
 [97] "FEETCHK"   "FEETCHK3"  "FLSHTMY3"  "FLUSHOT7"  "FMONTH"    "GENHLTH"  
[103] "HADHYST2"  "HADMAM"    "HADPAP2"   "HAVARTH4"  "HAVECFS"   "HAVEHEPB" 
[109] "HAVEHEPC"  "HEIGHT3"   "HHADULT"   "HIVRISK5"  "HIVTST7"   "HIVTSTD3" 
[115] "HLTHCVR1"  "HLTHPLN1"  "HOWLONG"   "HPLSTTST"  "HPVADSHT"  "HPVADVC4" 
[121] "HPVTEST"   "HTIN4"     "HTM4"      "IDAY"      "IMFVPLA1"  "IMONTH"   
[127] "INCOME2"   "INSULIN1"  "IYEAR"     "LADULT1"   "LANDLINE"  "LANDSEX"  
[133] "LASTDEN4"  "LASTPAP2"  "LASTSMK2"  "LCSCTSCN"  "LCSFIRST"  "LCSLAST"  
[139] "LCSNUMCG"  "LSTBLDS4"  "MARIJAN1"  "MARITAL"   "MAXDRNKS"  "MEDCOST"  
[145] "MEDSHEPB"  "MENTHLTH"  "MSCODE"    "NUMADULT"  "NUMHHOL3"  "NUMMEN"   
[151] "NUMPHON3"  "NUMWOMEN"  "PCDMDEC1"  "PCPSAAD3"  "PCPSADE1"  "PCPSADI1" 
[157] "PCPSARE1"  "PCPSARS1"  "PDIABTST"  "PERSDOC2"  "PHYSHLTH"  "PNEUVAC4" 
[163] "POORHLTH"  "PREDIAB1"  "PREGNANT"  "PRIRHEPC"  "PSATEST1"  "PSATIME"  
[169] "PVTRESD1"  "PVTRESD3"  "QSTLANG"   "QSTVER"    "RCSGENDR"  "RCSRLTN2" 
[175] "RENTHOM1"  "RESPSLCT"  "RMVTETH4"  "RSNMRJN1"  "SAFETIME"  "SDNATEST" 
[181] "SEATBELT"  "SEXVAR"    "SHINGLE2"  "SIGMSCPY"  "SIGMTEST"  "SLEPTIM1" 
[187] "SMOKDAY2"  "SMOKE100"  "SOFEMALE"  "SOMALE"    "STATERE1"  "STOOLDNA" 
[193] "STOPSMK2"  "TETANUS1"  "TOLDCFS"   "TOLDHEPC"  "TRETHEPC"  "TRNSGNDR" 
[199] "USEMRJN2"  "USENOW3"   "VCLNTEST"  "VETERAN3"  "VIRCOLON"  "WEIGHT2"  
[205] "WORKCFS"   "WTKG3"     "X_AGE_G"   "X_AGE65YR" "X_AGE80"   "X_AGEG5YR"
[211] "X_AIDTST4" "X_ALTETH3" "X_ASTHMS1" "X_BMI5"    "X_BMI5CAT" "X_CASTHM1"
[217] "X_CHISPNC" "X_CHLDCNT" "X_CLLCPWT" "X_CLNSCPY" "X_CPRACE"  "X_CRACE1" 
[223] "X_CRCREC1" "X_DENVST3" "X_DRDXAR2" "X_DRNKDRV" "X_DRNKWK1" "X_DUALCOR"
[229] "X_DUALUSE" "X_EDUCAG"  "X_EXTETH3" "X_FLSHOT7" "X_HCVU651" "X_HISPANC"
[235] "X_IMPRACE" "X_INCOMG"  "X_LLCPWT"  "X_LLCPWT2" "X_LTASTH1" "X_MAM5023"
[241] "X_MENT14D" "X_METSTAT" "X_MICHD"   "X_MRACE1"  "X_PHYS14D" "X_PNEUMO3"
[247] "X_PRACE1"  "X_PSU"     "X_RACE"    "X_RACEG21" "X_RACEGR3" "X_RACEPRV"
[253] "X_RAWRAKE" "X_RFBING5" "X_RFBLDS4" "X_RFBMI5"  "X_RFDRHV7" "X_RFHLTH" 
[259] "X_RFMAM22" "X_RFPAP35" "X_RFPSA23" "X_RFSEAT2" "X_RFSEAT3" "X_RFSMOK3"
[265] "X_SBONTIM" "X_SEX"     "X_SGMS10Y" "X_SGMSCPY" "X_SMOKER3" "X_STATE"  
[271] "X_STOLDNA" "X_STRWT"   "X_STSTR"   "X_TOTINDA" "X_URBSTAT" "X_VIRCOLN"
[277] "X_WT2RAKE"</code></pre>
</div>
</div>
<!-- ```{r} -->
<!-- # write_csv(responses, "/home/aditya/Desktop/HealthData/2020/filtered.csv") -->
<!-- ``` -->
<p>Out of the 277 columns in the data set, for our study of the heart disease and the factors of the same, we use only a subset of all the columns in the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>responses <span class="ot">&lt;-</span> responses <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    X_SEX,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    SLEPTIM1,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    WEIGHT2,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    HEIGHT3,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    X_AGE80,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    SMOKE100,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    EXERANY2,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    VETERAN3,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    X_MICHD</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- ```{r} -->
<!-- responses <- responses %>%  -->
<!--   select( -->
<!--     X_SEX, -->
<!--     SLEPTIM1, -->
<!--     WEIGHT2, -->
<!--     HEIGHT3, -->
<!--     X_AGE80, -->
<!--     DIFFWALK, -->
<!--     SMOKE100, -->
<!--     EXERANY2, -->
<!--     VETERAN3, -->
<!--     X_LTASTH1, -->
<!--     X_MICHD, -->
<!--     CVDSTRK3, -->
<!--     EMPLOY1, -->
<!--     INCOME2, -->
<!--     X_RACE -->
<!--   ) -->
<!-- ``` -->
<p>Out of around the three hundred columns, the following are the columns of interest:</p>
<ul>
<li><p>X_SEX : The sex of the subject, Possible Values : 1(Male),2(Female)</p></li>
<li><p>SLEPTIM1 : On average, how many hours of sleep does the subject get in a 24-hour period? Possible Values : 1-24(Number of hours), 77(Not Sure), 99(Refused), Blank(Missing)</p></li>
<li><p>WEIGHT2 : About how much does the subject weigh without shoes in pounds Possible Values : 50 -776(Weight in pounds), 7777(Don’t know), 9023-9352(Weight in KG without ‘9’), 9999 (Missing)</p></li>
<li><p>HEIGHT3 : About how tall is the subject without shoes Possible Values : 200 to 711(FeetInchInch format), 7777(Not Sure), 9061-9998(MeterCmCm format without leading ‘9’),9999(Missing)</p></li>
<li><p>X_AGE80 : Imputed Age value collapsed above 80 Possible Values : 18-99</p></li>
<li><p>SMOKE100 : smoked at least 100 cigarettes in your entire life? Possible Values : 1(Yest), 2(No), 7(Not Sure), 9(Refused), Blank(Missing)</p></li>
<li><p>EXERANY2 : During the past month, other than your regular job, has the subject participated in any exercises such as running, calisthenics, golf, gardening, or walking for exercise? Possible Values : 1(Yes), 2(No), 7(Don’t know, Not Sure)</p></li>
<li><p>VETERAN3 : ever served on active duty in the United States Armed Forces, either in the regular military or in a National Guard or military reserve unit? Possible Values : 1(Yes), 2(No), 7(Don’t know, Not Sure), 9(Refused), Blank(Missing)</p></li>
<li><p>X_MICHD : Ever reported having coronary heart disease (CHD) or myocardial infarction(MI) Possible Values : 1(Yes), 2(No), Blank(Missing)</p></li>
</ul>
<section id="clean-the-data" class="level3">
<h3 class="anchored" data-anchor-id="clean-the-data">Clean the Data</h3>
<p>The raw data from the survey is not directly usable for our analysis. It need to be converted to a representation and units that will help us visualize the data and the trends.</p>
<p>First, we will rename the column names so that they will make more sense and represent the features they refer to.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>responses <span class="ot">&lt;-</span> responses <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> X_SEX, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> X_AGE80,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">SleepTime =</span> SLEPTIM1,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Weight =</span> WEIGHT2,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Height =</span> HEIGHT3,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Veteran =</span> VETERAN3,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exercise =</span> EXERANY2,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">HeartDisease =</span> X_MICHD,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Smoke =</span> SMOKE100</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> responses <span class="sc">%&gt;%</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>      Sex, </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>      Age,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>      SleepTime,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>      Weight,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>      Height,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>      Veteran,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>      Exercise,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>      HeartDisease,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>      Smoke</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The raw Sex values are numerical where 1 represents male and 2 represents female. We would like to convert them into “Male” and “Female”. There are other values which Sex column can take(Such as missing, refused etc.) we mark all of them as NA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the Sex to "Male" and "Female"</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sex =</span> <span class="fu">ifelse</span>(Sex <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Male"</span>, <span class="fu">ifelse</span>(Sex <span class="sc">==</span> <span class="dv">2</span>,<span class="st">"Female"</span>,<span class="cn">NA</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The height column has some values in Feet-Inch format and others in Meter-Centimeter format. We will clean it up and convert all of the values in Centimeters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the heights in Feet,Inches and Meter,Centimeter format to centimeters</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Height <span class="ot">&lt;-</span> <span class="fu">replace_na</span>(data<span class="sc">$</span>Height,<span class="dv">0</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>convert_height <span class="ot">&lt;-</span> <span class="cf">function</span>(height) {</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if the height is invalid due to any reason, return NA</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.na</span>(height) <span class="sc">|</span> height <span class="sc">==</span> <span class="dv">7777</span> <span class="sc">|</span> height <span class="sc">==</span> <span class="dv">9999</span>){</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (height <span class="sc">&gt;=</span> <span class="dv">1000</span> <span class="sc">&amp;&amp;</span> height <span class="sc">&lt;=</span> <span class="dv">9999</span>) {</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert MeterCmCm format to centimeters</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    cms <span class="ot">&lt;-</span> height <span class="sc">%%</span> <span class="dv">100</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    meters <span class="ot">&lt;-</span> (height <span class="sc">%/%</span> <span class="dv">100</span>) <span class="sc">%%</span> <span class="dv">10</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    centimeters <span class="ot">&lt;-</span> (meters <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">+</span> cms</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(centimeters)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (height <span class="sc">&gt;=</span> <span class="dv">200</span> <span class="sc">&amp;&amp;</span> height <span class="sc">&lt;=</span> <span class="dv">711</span>) {</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert FeetInchInch format to centimeters</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    inches <span class="ot">&lt;-</span> height <span class="sc">%%</span> <span class="dv">100</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    feet <span class="ot">&lt;-</span> height <span class="sc">%/%</span> <span class="dv">100</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    centimeters <span class="ot">&lt;-</span> (feet <span class="sc">*</span> <span class="fl">30.48</span>) <span class="sc">+</span> (inches <span class="sc">*</span> <span class="fl">2.54</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(centimeters)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Height <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span>Height, convert_height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The weight also has values in both Pounds and Kgs, we clean it up and convert all the values into Kgs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the Weights in different formats to Kgs</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>convert_weight <span class="ot">&lt;-</span> <span class="cf">function</span>(weight) {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if the height is invalid due to any reason, return NA</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.na</span>(weight) <span class="sc">|</span> weight <span class="sc">==</span> <span class="dv">7777</span> <span class="sc">|</span> weight <span class="sc">==</span> <span class="dv">9999</span>){</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (weight <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;&amp;</span> weight <span class="sc">&lt;=</span> <span class="dv">0776</span>) {</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert pounds to Kg</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    kgs <span class="ot">&lt;-</span> weight <span class="sc">/</span> <span class="fl">2.2</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(kgs)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (weight <span class="sc">&gt;=</span> <span class="dv">9000</span> <span class="sc">&amp;&amp;</span> weight <span class="sc">&lt;=</span> <span class="dv">10000</span>) {</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract Kilograms</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    kgs <span class="ot">=</span> weight <span class="sc">%%</span> <span class="dv">1000</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(kgs)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Weight <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span>Weight, convert_weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similar to Sex, we convert veteran status, smoking, Exercise and Heart Disease columns into corresponding strings from numerical values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Convert veteran status, Smoking, Exercise and  Heart Disease to strings</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Veteran =</span> <span class="fu">ifelse</span>(Veteran <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Yes"</span>, <span class="fu">ifelse</span>(Veteran <span class="sc">==</span> <span class="dv">2</span>,<span class="st">"No"</span>,<span class="cn">NA</span>)),<span class="at">HeartDisease =</span> <span class="fu">ifelse</span>(HeartDisease <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Yes"</span>, <span class="fu">ifelse</span>(HeartDisease <span class="sc">==</span> <span class="dv">2</span>, <span class="st">"No"</span>, <span class="st">"0"</span>)), <span class="at">Smoke =</span> <span class="fu">ifelse</span>(Smoke <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Yes"</span>, <span class="fu">ifelse</span>(Smoke <span class="sc">==</span> <span class="dv">2</span>,<span class="st">"No"</span>,<span class="cn">NA</span>)),<span class="at">Exercise =</span> <span class="fu">ifelse</span>(Exercise <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Yes"</span>, <span class="fu">ifelse</span>(Exercise <span class="sc">==</span> <span class="dv">2</span>,<span class="st">"No"</span>,<span class="cn">NA</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Convert Sleep time to 1-24H</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SleepTime =</span> <span class="fu">ifelse</span>(SleepTime <span class="sc">&lt;</span> <span class="dv">25</span>, SleepTime, <span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sex"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Age"],"name":[2],"type":["int"],"align":["right"]},{"label":["SleepTime"],"name":[3],"type":["int"],"align":["right"]},{"label":["Weight"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Height"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Veteran"],"name":[6],"type":["chr"],"align":["left"]},{"label":["Exercise"],"name":[7],"type":["chr"],"align":["left"]},{"label":["HeartDisease"],"name":[8],"type":["chr"],"align":["left"]},{"label":["Smoke"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"Female","2":"56","3":"5","4":"48.18182","5":"170.18","6":"No","7":"Yes","8":"No","9":"Yes","_rn_":"1"},{"1":"Female","2":"80","3":"7","4":"57.27273","5":"167.64","6":"No","7":"Yes","8":"No","9":"No","_rn_":"5"},{"1":"Male","2":"66","3":"8","4":"81.81818","5":"175.26","6":"No","7":"Yes","8":"No","9":"Yes","_rn_":"6"},{"1":"Female","2":"75","3":"6","4":"68.18182","5":"167.64","6":"No","7":"No","8":"No","9":"No","_rn_":"7"},{"1":"Female","2":"69","3":"6","4":"68.18182","5":"160.02","6":"No","7":"Yes","8":"No","9":"Yes","_rn_":"8"},{"1":"Female","2":"41","3":"8","4":"77.27273","5":"180.34","6":"No","7":"Yes","8":"No","9":"No","_rn_":"9"},{"1":"Female","2":"78","3":"12","4":"74.09091","5":"160.02","6":"No","7":"No","8":"Yes","9":"Yes","_rn_":"10"},{"1":"Female","2":"73","3":"4","4":"60.90909","5":"167.64","6":"No","7":"Yes","8":"No","9":"No","_rn_":"11"},{"1":"Female","2":"80","3":"9","4":"73.63636","5":"152.40","6":"No","7":"No","8":"No","9":"Yes","_rn_":"12"},{"1":"Female","2":"80","3":"5","4":"63.63636","5":"154.94","6":"No","7":"No","8":"No","9":"No","_rn_":"14"},{"1":"Male","2":"68","3":"10","4":"136.36364","5":"182.88","6":"No","7":"Yes","8":"No","9":"No","_rn_":"15"},{"1":"Male","2":"63","3":"15","4":"118.18182","5":"185.42","6":"No","7":"No","8":"Yes","9":"Yes","_rn_":"16"},{"1":"Female","2":"58","3":"5","4":"66.81818","5":"152.40","6":"No","7":"Yes","8":"No","9":"Yes","_rn_":"17"},{"1":"Male","2":"79","3":"8","4":"97.72727","5":"185.42","6":"No","7":"Yes","8":"No","9":"Yes","_rn_":"18"},{"1":"Female","2":"80","3":"7","4":"74.54545","5":"162.56","6":"No","7":"No","8":"No","9":"No","_rn_":"19"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   347975 obs. of  9 variables:
 $ Sex         : chr  "Female" "Female" "Male" "Female" ...
 $ Age         : int  56 80 66 75 69 41 78 73 80 80 ...
 $ SleepTime   : int  5 7 8 6 6 8 12 4 9 5 ...
 $ Weight      : num  48.2 57.3 81.8 68.2 68.2 ...
 $ Height      : num  170 168 175 168 160 ...
 $ Veteran     : chr  "No" "No" "No" "No" ...
 $ Exercise    : chr  "Yes" "Yes" "Yes" "No" ...
 $ HeartDisease: chr  "No" "No" "No" "No" ...
 $ Smoke       : chr  "Yes" "No" "Yes" "No" ...
 - attr(*, "na.action")= 'omit' Named int [1:53983] 2 3 4 13 25 28 37 51 68 73 ...
  ..- attr(*, "names")= chr [1:53983] "2" "3" "4" "13" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Sex                 Age          SleepTime          Weight      
 Length:347975      Min.   :18.00   Min.   : 1.000   Min.   : 22.73  
 Class :character   1st Qu.:40.00   1st Qu.: 6.000   1st Qu.: 68.18  
 Mode  :character   Median :57.00   Median : 7.000   Median : 79.55  
                    Mean   :54.37   Mean   : 7.095   Mean   : 82.59  
                    3rd Qu.:69.00   3rd Qu.: 8.000   3rd Qu.: 93.18  
                    Max.   :80.00   Max.   :24.000   Max.   :352.00  
     Height         Veteran            Exercise         HeartDisease      
 Min.   : 71.12   Length:347975      Length:347975      Length:347975     
 1st Qu.:162.56   Class :character   Class :character   Class :character  
 Median :170.18   Mode  :character   Mode  :character   Mode  :character  
 Mean   :170.33                                                           
 3rd Qu.:177.80                                                           
 Max.   :233.68                                                           
    Smoke          
 Length:347975     
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
</div>
<p>We have shown the final columns and summary of the data above after cleaning and remapping the data.</p>
</section>
</section>
<section id="part-3-visualization" class="level2">
<h2 class="anchored" data-anchor-id="part-3-visualization">Part 3: Visualization</h2>
<section id="tentative-plan-for-visualization" class="level4">
<h4 class="anchored" data-anchor-id="tentative-plan-for-visualization">Tentative plan for visualization</h4>
<ul>
<li><p>We will first visualize the distribution of samples with respect to age and gender.</p></li>
<li><p>Then we will study the impact of the following factors on heart disease using Bar plots, Histograms and pie charts.</p></li>
</ul>
<ol type="1">
<li>Gender</li>
<li>Age</li>
<li>Veteran Status</li>
<li>Somking</li>
<li>BMI</li>
<li>Exercise</li>
<li>Sleeping time</li>
</ol>
<ul>
<li>Finally, We will analyze the most vulnerable population and find out which changes if made in lifestyle could help in reduce the risk of heart disease using Pie Charts.</li>
</ul>
</section>
<section id="distribution-of-male-and-female-subjects-for-the-data" class="level4">
<h4 class="anchored" data-anchor-id="distribution-of-male-and-female-subjects-for-the-data">Distribution of Male and Female subjects for the data</h4>
<p>One of the major factor which we want to study with respect to the heart disease is the gender of the person. Therefore, we first try see the distribution of the male and female proportion in the data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table with the number of males and females</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>sex_table <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sex) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>()</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of males and females</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>sex_percent <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">prop.table</span>(sex_table)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot of the sex data with percentages</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(sex_table, <span class="at">main=</span><span class="st">"Number of Males and Females"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Sex"</span>, <span class="at">ylab=</span><span class="st">"Frequency"</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"pink"</span>, <span class="st">"lightblue"</span>),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(sex_table)<span class="sc">*</span><span class="fl">1.2</span>))</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, sex_table <span class="sc">+</span> <span class="fl">0.2</span>, <span class="fu">paste0</span>(sex_percent, <span class="st">"%"</span>), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AdityaSalveruFinalProject_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As we can see the number of samples of both genders is fairly equal and none of the gender dominate the dataset.</p>
</section>
<section id="distribution-of-subjects-across-age-groups" class="level4">
<h4 class="anchored" data-anchor-id="distribution-of-subjects-across-age-groups">Distribution of Subjects across age groups</h4>
<p>Another important factor that we take into our study is the age of the people in the dataset. We divide the people into buckets with a range of 5 and plot a bar chart to see the distribution of the people in different age groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the age groups</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>ages<span class="sc">$</span>AgeGroup <span class="ot">&lt;-</span> <span class="fu">cut</span>(ages<span class="sc">$</span>Age, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">15</span>, <span class="dv">90</span>, <span class="at">by =</span> <span class="dv">10</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ages, <span class="fu">aes</span>(<span class="at">x =</span> AgeGroup)) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">title =</span> <span class="st">"Age Distribution"</span>) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AdityaSalveruFinalProject_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Though there are a little higher people in the range 40-60, there are good number samples of other ages too. Therefore again the results will not be skewed towards any particular age groups.</p>
<!-- #### Distribution of Subjects across Race -->
<!-- ```{r} -->
<!-- ggplot(data, aes(x = Race)) + -->
<!--   geom_bar(fill = "lightblue") + -->
<!--   xlab("Race") + -->
<!--   ylab("Count") + -->
<!--   ggtitle("Count of Race") + -->
<!--   geom_text(stat='count', aes(label=..count..), vjust=-0.5)  -->
<!-- ``` -->
</section>
<section id="analysis-of-various-factors-and-the-probability-of-heart-disease" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-various-factors-and-the-probability-of-heart-disease">Analysis of various factors and the probability of heart disease</h3>
<p>We now have a look at some factors and check what percentages of people have heart disease with these factors.</p>
<section id="how-is-heart-disease-related-to-the-gender-of-the-person" class="level4">
<h4 class="anchored" data-anchor-id="how-is-heart-disease-related-to-the-gender-of-the-person">How is heart disease related to the gender of the person</h4>
<p>We now study the relation of gender to the likeliness of getting a heart disease. We plot a bar graph of male and female and fill it with the proportion of people with heart disease to study the impact of gender on heart disease.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Sex_HeartDisease <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Sex</span><span class="st">`</span>,<span class="st">`</span><span class="at">HeartDisease</span><span class="st">`</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the N/A values</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>Sex_HeartDisease <span class="ot">&lt;-</span> Sex_HeartDisease <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(HeartDisease))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the proportions</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> Sex_HeartDisease <span class="sc">%&gt;%</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex, HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count))</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proportions, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> proportion, <span class="at">fill =</span> HeartDisease)) <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(proportion, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sex"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>, <span class="at">fill =</span> <span class="st">"Heart Disease"</span>) <span class="sc">+</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"NA"</span> <span class="ot">=</span> <span class="st">"gray"</span>), <span class="at">na.value =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AdityaSalveruFinalProject_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Among men, 10.7% have heart disease, while 89.3% do not. Among women, 6.8% have heart disease, while 93.2% do not.</p>
<p>From these figures, we can infer that both men and women are susceptible to heart disease, but there is a slightly higher prevalence among men compared to women. The data suggests that men have a higher risk of developing heart disease than women, with a 10.7% prevalence compared to 6.8%. This aligns with existing research indicating that men are generally more prone to heart disease.</p>
</section>
<section id="how-is-heart-disease-releated-to-the-age-of-the-person" class="level4">
<h4 class="anchored" data-anchor-id="how-is-heart-disease-releated-to-the-age-of-the-person">How is heart disease releated to the age of the person?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(Age,HeartDisease)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the ratio of people with and without heart disease for each age group, handling NA values</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ratio_data <span class="ot">&lt;-</span> <span class="fu">tapply</span>(data<span class="sc">$</span>HeartDisease, data<span class="sc">$</span>Age, <span class="cf">function</span>(x) {</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  n_yes <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  n_no <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="st">"No"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(n_yes) <span class="sc">||</span> <span class="fu">is.na</span>(n_no))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(n_yes <span class="sc">/</span> (n_yes<span class="sc">+</span>n_no))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot of the ratio, excluding NA values</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ratio_data[<span class="sc">!</span><span class="fu">is.na</span>(ratio_data)], <span class="at">col =</span> <span class="st">"#4D4D4D"</span>, <span class="at">xlab =</span> <span class="st">"Age"</span>, <span class="at">ylab =</span> <span class="st">"Ratio of People"</span>, <span class="at">main =</span> <span class="st">"Ratio of People with Heart Disease by Age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AdityaSalveruFinalProject_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The provided data represents the ratio of people with heart disease to people without heart disease across different age groups. The data shows that the prevalence of heart disease tends to increase with age. In the younger age groups (18-29), the ratios range from 0.005562914 to 0.010360138, indicating a relatively low proportion of individuals with heart disease. However, as the age increases, the ratios gradually rise. From ages 30 to 47, the ratios range from 0.012141280 to 0.037837838, suggesting a notable increase in the prevalence of heart disease. This trend continues in the subsequent age groups, with ratios ranging from 0.042045868 to 0.290657149 in the age range of 48-80.</p>
<p>The data implies that as individuals grow older, they are more likely to develop heart disease. This inference aligns with the widely recognized understanding that age is a significant risk factor for heart disease. The progressive increase in the ratio of individuals with heart disease across the age groups highlights the importance of preventive measures and regular cardiovascular health monitoring, especially as individuals approach and surpass middle age. These findings underscore the need for early detection, lifestyle modifications, and appropriate medical interventions to mitigate the risk and impact of heart disease, particularly in older populations.</p>
</section>
<section id="veterans-vs-non-veterans" class="level4">
<h4 class="anchored" data-anchor-id="veterans-vs-non-veterans">Veterans Vs Non Veterans</h4>
<p>We now study the probability of heart disease on veterans and non veterans by using a similar bar plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>VeteranHeartDisease <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(Veteran, HeartDisease)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> VeteranHeartDisease <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Veteran, HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Veteran) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>proportions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Veteran"],"name":[1],"type":["chr"],"align":["left"]},{"label":["HeartDisease"],"name":[2],"type":["chr"],"align":["left"]},{"label":["count"],"name":[3],"type":["int"],"align":["right"]},{"label":["proportion"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"No","2":"No","3":"281263","4":"0.92503379"},{"1":"No","2":"Yes","3":"22794","4":"0.07496621"},{"1":"Yes","2":"No","3":"36282","4":"0.82613052"},{"1":"Yes","2":"Yes","3":"7636","4":"0.17386948"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proportions, <span class="fu">aes</span>(<span class="at">x =</span> Veteran, <span class="at">y =</span> proportion, <span class="at">fill =</span> HeartDisease)) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(proportion, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Veteran"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>, <span class="at">fill =</span> <span class="st">"Heart Disease"</span>) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"NA"</span> <span class="ot">=</span> <span class="st">"gray"</span>), <span class="at">na.value =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AdityaSalveruFinalProject_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These statistics suggest that there is a notable difference in the prevalence of heart disease between veterans and non-veterans. Veterans appear to have a higher percentage of individuals with heart disease compared to non-veterans. This finding may indicate that veteran status is associated with a higher risk or susceptibility to heart disease.</p>
</section>
<section id="how-is-heart-disease-related-to-smoking-status" class="level4">
<h4 class="anchored" data-anchor-id="how-is-heart-disease-related-to-smoking-status">How is heart disease related to Smoking status?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>SmokingHeartDisease <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(Smoke, HeartDisease)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> SmokingHeartDisease <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Smoke, HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Smoke) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proportions, <span class="fu">aes</span>(<span class="at">x =</span> Smoke, <span class="at">y =</span> proportion, <span class="at">fill =</span> HeartDisease)) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(proportion, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Smoke"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>, <span class="at">fill =</span> <span class="st">"Heart Disease"</span>) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"NA"</span> <span class="ot">=</span> <span class="st">"gray"</span>), <span class="at">na.value =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AdityaSalveruFinalProject_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The data presented sheds light on the prevalence of heart disease among smokers and non-smokers, providing valuable insights into the impact of smoking on cardiovascular health. Among smokers, 12.3% are affected by heart disease, while the vast majority, accounting for 87.7%, remain free from this condition. This stark contrast between the two groups underscores the profound influence of smoking on heart health. The statistics reveal that smoking significantly increases the risk of developing heart disease.</p>
<p>On the other hand, among non-smokers, the prevalence of heart disease is considerably lower, with only 6.1% of individuals being affected. This finding emphasizes the importance of maintaining a smoke-free lifestyle in mitigating the risk of heart disease. It highlights the fact that non-smokers have a significantly reduced likelihood of developing heart issues, further emphasizing the bad impact of smoking on heart health.</p>
<!-- ### How is weight of the individuals affecting the heart disease? -->
<!-- ```{r} -->
<!-- WeightHeartDisease <- data %>% -->
<!--   select(Weight, HeartDisease) %>% -->
<!--   filter(!is.na(Weight) & !is.na(HeartDisease)) -->
<!-- # Create the scatter plot -->
<!-- ggplot(WeightHeartDisease, aes(x = Weight, y = HeartDisease)) + -->
<!--   geom_point(size = 3, shape = 16, color = "blue") + -->
<!--   labs(x = "Weight (kg)", y = "Heart Disease") + -->
<!--   ggtitle("Weight vs. Heart Disease") + -->
<!--   theme_minimal() -->
<!-- # Create the box plot -->
<!-- ggplot(WeightHeartDisease , aes(x = HeartDisease, y = Weight, fill = HeartDisease)) + -->
<!--   geom_boxplot() + -->
<!--   labs(x = "Heart Disease", y = "Weight (kg)") + -->
<!--   ggtitle("Weight Distribution by Heart Disease") + -->
<!--   theme_minimal() -->
<!-- ``` -->
</section>
<section id="how-is-heart-disease-releated-to-whether-a-person-exercises" class="level4">
<h4 class="anchored" data-anchor-id="how-is-heart-disease-releated-to-whether-a-person-exercises">How is heart disease releated to whether a person exercises?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(Exercise, HeartDisease)<span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Exercise) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(HeartDisease))<span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Exercise, HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Exercise) <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count))</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>proportions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Exercise"],"name":[1],"type":["chr"],"align":["left"]},{"label":["HeartDisease"],"name":[2],"type":["chr"],"align":["left"]},{"label":["count"],"name":[3],"type":["int"],"align":["right"]},{"label":["proportion"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"No","2":"No","3":"68806","4":"0.86048373"},{"1":"No","2":"Yes","3":"11156","4":"0.13951627"},{"1":"Yes","2":"No","3":"248739","4":"0.92808558"},{"1":"Yes","2":"Yes","3":"19274","4":"0.07191442"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>It can be clearly seen that people who exercise are less likely to have the heart disease.</p>
</section>
<section id="how-is-bmi-of-the-individuals-affecting-the-heart-disease" class="level4">
<h4 class="anchored" data-anchor-id="how-is-bmi-of-the-individuals-affecting-the-heart-disease">How is BMI of the individuals affecting the heart disease?</h4>
<p>We compute the BMI of the individuals from the height and weight information available and segregate them into five standard BMI categories and plot the percentage of people having the heart diseases in the respective categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>BMI <span class="ot">&lt;-</span> <span class="fu">round</span>(data<span class="sc">$</span>Weight <span class="sc">/</span> ((data<span class="sc">$</span>Height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column for BMI categories</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>BMICategory <span class="ot">&lt;-</span> <span class="fu">cut</span>(data<span class="sc">$</span>BMI, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">18.5</span>, <span class="fl">24.9</span>, <span class="fl">29.9</span>, <span class="fl">34.9</span>, <span class="fl">39.9</span>, <span class="cn">Inf</span>),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Underweight"</span>, <span class="st">"Normal weight"</span>, <span class="st">"Overweight"</span>, <span class="st">"Obesity (Class I)"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Obesity (Class II)"</span>, <span class="st">"Obesity (Class III)"</span>))</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>BMICategoryHeartDisease <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(BMICategory,HeartDisease)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of people with heart disease for each BMI category</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>percent <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(HeartDisease <span class="sc">~</span> BMICategory, BMICategoryHeartDisease, <span class="cf">function</span>(x) <span class="fu">mean</span>(x <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>percent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["BMICategory"],"name":[1],"type":["fct"],"align":["left"]},{"label":["HeartDisease"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Underweight","2":"8.160369"},{"1":"Normal weight","2":"6.582813"},{"1":"Overweight","2":"8.714392"},{"1":"Obesity (Class I)","2":"10.167626"},{"1":"Obesity (Class II)","2":"10.804440"},{"1":"Obesity (Class III)","2":"11.307970"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot using ggplot2</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(percent, <span class="fu">aes</span>(<span class="at">x =</span> BMICategory, <span class="at">y =</span> HeartDisease)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"BMI Category"</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Percentage of People with Heart Disease"</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"lightgray"</span>)) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AdityaSalveruFinalProject_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Analyzing the data, it can be observed that the heart disease percentage varies across different BMI categories. The lowest heart disease percentage is associated with the “Normal weight” category, which stands at 6.661403. The “Underweight” category follows closely with a slightly higher heart disease percentage of 8.388409. Moving towards higher BMI categories, the heart disease percentages gradually increase. The “Overweight” category has a percentage of 8.742972, while “Obesity (Class I)” records a higher percentage of 10.245310.</p>
<p>As the BMI categories progress to higher levels of obesity, the heart disease percentages continue to rise. “Obesity (Class II)” displays a percentage of 10.934172, and the highest heart disease percentage is observed in the “Obesity (Class III)” category, standing at 11.441625.</p>
<p>These findings suggest a positive correlation between BMI categories and the likelihood of heart disease. Individuals with higher BMI categories, especially those classified as obese, have a higher risk of developing heart disease. These observations emphasize the importance of maintaining a healthy weight and highlight the potential health risks associated with obesity.</p>
</section>
<section id="heart-disease-relation-with-sleep-time" class="level4">
<h4 class="anchored" data-anchor-id="heart-disease-relation-with-sleep-time">Heart Disease relation with sleep time:</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(SleepTime,HeartDisease)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate frequency</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>frequency <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>SleepTime)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pie chart</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="fu">as.factor</span>(SleepTime))) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Sleep Time"</span>, <span class="at">title =</span> <span class="st">"Pie Chart of Sleep Time"</span>) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">"Sleep Time"</span>) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AdityaSalveruFinalProject_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>filtered <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SleepTime,HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SleepTime<span class="sc">&gt;</span><span class="dv">2</span> <span class="sc">&amp;</span> SleepTime<span class="sc">&lt;</span><span class="dv">13</span>) </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of people with heart disease for each sleep time</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>percentage <span class="ot">&lt;-</span> filtered <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SleepTime) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">HeartDiseasePercentage =</span> <span class="fu">sum</span>(HeartDisease <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">/</span> <span class="fu">n</span>() <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>percentage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["SleepTime"],"name":[1],"type":["int"],"align":["right"]},{"label":["HeartDiseasePercentage"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"17.582897"},{"1":"4","2":"15.640790"},{"1":"5","2":"10.767280"},{"1":"6","2":"8.313709"},{"1":"7","2":"6.569760"},{"1":"8","2":"8.709945"},{"1":"9","2":"10.752137"},{"1":"10","2":"15.109321"},{"1":"11","2":"17.835671"},{"1":"12","2":"19.030449"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(percentage, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(SleepTime), <span class="at">y =</span> HeartDiseasePercentage)) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sleep Time"</span>, <span class="at">y =</span> <span class="st">"Percentage of People with Heart Disease"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Percentage of People with Heart Disease by Sleep Time"</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">drop =</span> <span class="cn">FALSE</span>)  <span class="co"># To include all sleep times on the x-axis</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AdityaSalveruFinalProject_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Upon analyzing the data, it can be observed that individuals who sleep for shorter durations tend to have higher percentages of heart disease. For instance, those who sleep for 3 or 4 hours have a relatively higher percentage of heart disease at 17.07% and 15.36%, respectively. As sleep duration increases to 5, 6, and 7 hours, the percentage of heart disease decreases to 10.52%, 8.11%, and 6.41%, respectively. The trend continues, with the lowest percentage of heart disease observed at 7 hours of sleep. However, as sleep time increases beyond 7 hours, the percentage of heart disease starts to rise again, reaching its peak at 12 hours with 18.38%. This dataset suggests a potential association between sleep duration and the prevalence of heart disease, with an optimal sleep duration of around 7 hours for maintaining heart health.</p>
</section>
</section>
<section id="analyzing-the-most-vulnerable-population" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-most-vulnerable-population">Analyzing the most vulnerable population</h3>
<p>From the above analysis we can suspect that the most vulnerable population has the following characteristics: 1. Male 2. Older 3. Smoke 4. Bad sleeping habits 5. High BMI 6. No Exercise</p>
<p>Let us see what percentage of people with these characteristics have heart disease.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex<span class="sc">==</span><span class="st">"Male"</span> <span class="sc">&amp;</span> Veteran <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> (SleepTime<span class="sc">&gt;</span><span class="dv">9</span> <span class="sc">|</span> SleepTime<span class="sc">&lt;</span><span class="dv">6</span>) <span class="sc">&amp;</span> Smoke <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> BMI<span class="sc">&gt;</span><span class="dv">30</span> <span class="sc">&amp;</span> Age<span class="sc">&gt;</span><span class="dv">60</span> <span class="sc">&amp;</span> Exercise <span class="sc">==</span> <span class="st">"No"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(HeartDisease)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of heart disease</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>original_percentage <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">HeartDiseasePercentage =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(filtered_data) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>original_percentage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["HeartDisease"],"name":[1],"type":["chr"],"align":["left"]},{"label":["HeartDiseasePercentage"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"No","2":"61.99461"},{"1":"Yes","2":"38.00539"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>A whopping 38 % of the people with above characteristics have the disease.</p>
<p>Let us now analyze the benefit of giving up bad habits for these population:</p>
<section id="exercise-and-reduce-the-bmi-below-the-obesity-levels" class="level4">
<h4 class="anchored" data-anchor-id="exercise-and-reduce-the-bmi-below-the-obesity-levels">1. Exercise and Reduce the BMI below the Obesity levels</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex<span class="sc">==</span><span class="st">"Male"</span> <span class="sc">&amp;</span> Veteran <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> (SleepTime<span class="sc">&gt;</span><span class="dv">9</span> <span class="sc">|</span> SleepTime<span class="sc">&lt;</span><span class="dv">6</span>) <span class="sc">&amp;</span> Smoke <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> BMI<span class="sc">&lt;</span><span class="dv">30</span> <span class="sc">&amp;</span> Age<span class="sc">&gt;</span><span class="dv">60</span> <span class="sc">&amp;</span> Exercise <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(HeartDisease)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(filtered_data)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of heart disease</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>percentage <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">HeartDiseasePercentage =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(filtered_data) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>percentage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["HeartDisease"],"name":[1],"type":["chr"],"align":["left"]},{"label":["HeartDiseasePercentage"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"No","2":"71.92394"},{"1":"Yes","2":"28.07606"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Exercising and getting the BMI below 30 has reduced the probability of having the heart disease by over 10%.</p>
</section>
<section id="having-the-right-amount-of-sleep" class="level4">
<h4 class="anchored" data-anchor-id="having-the-right-amount-of-sleep">2. Having the right amount of sleep</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex<span class="sc">==</span><span class="st">"Male"</span> <span class="sc">&amp;</span> Veteran <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> (SleepTime<span class="sc">&gt;=</span><span class="dv">6</span> <span class="sc">&amp;</span> SleepTime<span class="sc">&lt;=</span><span class="dv">9</span>) <span class="sc">&amp;</span> Smoke <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> BMI<span class="sc">&lt;</span><span class="dv">30</span> <span class="sc">&amp;</span> Age<span class="sc">&gt;</span><span class="dv">60</span> <span class="sc">&amp;</span> Exercise <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(HeartDisease)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(filtered_data)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of heart disease</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>percentage <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">HeartDiseasePercentage =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(filtered_data) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>percentage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["HeartDisease"],"name":[1],"type":["chr"],"align":["left"]},{"label":["HeartDiseasePercentage"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"No","2":"75.83708"},{"1":"Yes","2":"24.16292"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Sleeping for 6-9 hours a day reduces the heart disease probability of the vulnerable population further by around 4 percent.</p>
</section>
<section id="no-smoking" class="level4">
<h4 class="anchored" data-anchor-id="no-smoking">2. No Smoking</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex<span class="sc">==</span><span class="st">"Male"</span> <span class="sc">&amp;</span> Veteran <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> (SleepTime<span class="sc">&gt;=</span><span class="dv">6</span> <span class="sc">&amp;</span> SleepTime<span class="sc">&lt;=</span><span class="dv">9</span>) <span class="sc">&amp;</span> Smoke <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">&amp;</span> BMI<span class="sc">&lt;</span><span class="dv">30</span> <span class="sc">&amp;</span> Age<span class="sc">&gt;</span><span class="dv">60</span> <span class="sc">&amp;</span> Exercise <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(HeartDisease)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(filtered_data)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of heart disease</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>percentage <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">HeartDiseasePercentage =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(filtered_data) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>percentage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["HeartDisease"],"name":[1],"type":["chr"],"align":["left"]},{"label":["HeartDiseasePercentage"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"No","2":"82.13921"},{"1":"Yes","2":"17.86079"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The people who do not smoke in these population have over 6 percent less chance of heart disease.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plot_heart_disease_percent <span class="ot">&lt;-</span> <span class="cf">function</span>(percentage, title_str){</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(percentage, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> HeartDiseasePercentage, <span class="at">fill =</span> HeartDisease)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Heart Disease"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">title =</span> title_str) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(HeartDiseasePercentage,<span class="dv">2</span>), <span class="st">"%"</span>)), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plot)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>orig <span class="ot">=</span> <span class="fu">plot_heart_disease_percent</span>(original_percentage,<span class="st">"Probability of heart disease"</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>new  <span class="ot">=</span> <span class="fu">plot_heart_disease_percent</span>(percentage, <span class="st">"Probability with suggestions"</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(orig, new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="AdityaSalveruFinalProject_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Overall with the above three changes in the lifestyle, our vulnerable population can actually reduce the risk of heart disease by more than 20%.</p>
</section>
</section>
</section>
<section id="part-4-conclusion" class="level2">
<h2 class="anchored" data-anchor-id="part-4-conclusion">Part 4 : Conclusion</h2>
<ul>
<li><p>When it comes to the heart disease, males are more susceptible than females. Males are 57% more likely to get effected as compare to females.</p></li>
<li><p>The age of a person is also a very important factor of being affected by the heart disease. Older people(&gt;65 years) are more than 10 times prone to the heart disease as compared to young people(25 years)</p></li>
<li><p>We can also conclude that people with High BMI(higher than Obese category) are also more likely to get heart disease than people with low BMI.</p></li>
<li><p>Veterans are affected by the heart disease twice as compare to the non-veterans, there could be multiple reasons for this such as stress.</p></li>
<li><p>Similarly people who smoke are twice as likely to get affected by heart disease.</p></li>
<li><p>People who exercise and have the right amount of sleep are also less likely to get a heart disease.</p></li>
<li><p>Therefore the old male veterans who smoke, do not exercise and do not get a proper sleep are the most at risk population. Our analysis showed that around 40% of the people belonging to this category has the heart disease.</p></li>
<li><p>We have also shown that by following lifestyle changes such as exercising, appropriate sleep, reducing the BMI can drastically reduce the risk for this population.</p></li>
</ul>
</section>
<section id="part-5-bibliography" class="level2">
<h2 class="anchored" data-anchor-id="part-5-bibliography">Part 5 : Bibliography</h2>
<ul>
<li>R: A language and environment for statistical computing. - https://www.R-project.org/</li>
<li>R Studio IDE. - https://posit.co/products/open-source/rstudio/</li>
<li>CDC - BRFSS - https://www.cdc.gov/brfss/index.html</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/601_Spring_2023" data-repo-id="R_kgDOI4JcJA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb39" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project : Aditya Salveru"</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Aditya Salveru"</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Project &amp; Data Description"</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "05/22/2023"</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - final_Project_assignment_1</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - Behavioral Risk Factor Surveillance System (BRFSS)</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## Important Formatting &amp; Submission Notes: {#important-formatting-submission-notes} --&gt;</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 1.  **Use this file as the template to work on: start your own writing from Section "Part.1"** --&gt;</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 2.  **Please make the following changes to the above YAML header:** --&gt;</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     -   Change the "title" to "Final Project Assignment#1: First Name Last Name"; --&gt;</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     -   Change the "author" to your name; --&gt;</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     -   Change the "date" to the current date in the "MM-DD-YYYY" format; --&gt;</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 3.  **Submission:** --&gt;</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     -   Delete the unnecessary sections ("Overview", "Tasks", "Special Note", and "Evaluation"). --&gt;</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     -   **In the posts folder of your local 601_Spring_2023 project, create a folder named "FirstNameLastName_FinalProjectData", and save your final project dataset(s) in this folder. DO NOT save the dataset(s) to the \_data folder which stores the dataset(s) for challenges.** --&gt;</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     -   Render and submit the file to the blog post like a regular challenge. --&gt;</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## Overview of the Final Project {#overview-of-the-final-project} --&gt;</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The goal is to tell a coherent and focused story with your data, which answers a question (or questions) that a researcher, or current or future employer, might want to have answered. The goal might be to understand a source of covariance, make a recommendation, or understand change over time. We don't expect you to reach a definitive conclusion in this analysis. Still, you are expected to tell a data-driven story using evidence to support the claims you are making on the basis of the exploratory analysis conducted over the past term. --&gt;</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- In this final project, statistical analyses **are not required**, but any students who wish to include these may do so. However, **your primary analysis should center around visualization rather than inferential statistics.** Many scientists only compute statistics after a careful process of exploratory data analysis and data visualization. Statistics are a way to gauge your certainty in your results - **NOT A WAY TO DISCOVER MEANINGFUL DATA PATTERNS**. **Do not run a multiple regression with numerous predictors and report which predictors are significant!!** --&gt;</span></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ## Tasks of Assignment#1 {#Tasks-of-assignment1} --&gt;</span></span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This assignment is the first component of your final project. Together with the later assignments, it make up a short paper/report. In this assignment, you should introduce a dataset(s) and how you plan to present this dataset(s). This assignment should include the following components: --&gt;</span></span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 1.  **A clear description of the dataset(s) that you are using.** --&gt;</span></span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 2.  **What "story" do you want to present to the audience? In other words, what "question(s)" do you like to answer with this dataset(s)?** --&gt;</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- 3.  **The Plan for Further Analysis and Visualization.** --&gt;</span></span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We will have a special class meeting on April 12 to review and discuss students' proposed datasets for the final project. **If you want your project being discussed in the class, please submit this assignment before April 12.** --&gt;</span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1. Introduction {#describe-the-data-sets}</span></span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>My projects aims to analyze the heart disease data and explore the causes and general trends in the individuals with and without the heart disease. Particularly I am interested in finding the factors that contribute to the heart disease the most and early signs that might lead to a heart disease. I would also like to analyze the healthy habits that would keep the heart diseases away.</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.  Dataset(s) Introduction:</span></span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>I have chosen the 2020 annual CDC survey data of 400k adults related to their health status collected by Behavioral Risk Factor Surveillance System (BRFSS). For people of the majority of racial groups in the US (African Americans, American Indians and Alaska Natives, and white people), heart disease is one of the leading causes of death, according to the CDC. In the field of medicine, it is crucial to identify and combat the causes that have the biggest influence on heart disease.</span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>The Behavioral Risk Factor Surveillance System (BRFSS) is a collaborative project between all the states in the</span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>United States and participating US territories and the Centers for Disease Control and Prevention (CDC). The</span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>BRFSS is administered and supported by CDC's Population Health Surveillance Branch, under the Division of</span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>Population Health at CDC’s National Center for Chronic Disease Prevention and Health Promotion. The</span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>BRFSS is a system of ongoing health-related telephone surveys designed to collect data on health-related risk</span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a>behaviors, chronic health conditions, health-care access, and use of preventive services from the</span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a>non institutionalized adult population (≥ 18 years) residing in the United States and participating areas.</span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.  What questions do you like to answer with this dataset(s)?</span></span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How is heart disease related to physical attributes such as Gender, sleep time, BMI etc.</span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Is there any particular group of people who are at high risk?</span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What changes should the high risk people incorporate to reduce the risk of heart disease.</span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-98"><a href="#cb39-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-99"><a href="#cb39-99" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2. Describe the data set(s) {#describe-the-data-sets-1}</span></span>
<span id="cb39-100"><a href="#cb39-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-101"><a href="#cb39-101" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This part contains both a coding and a storytelling component. --&gt;</span></span>
<span id="cb39-102"><a href="#cb39-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-103"><a href="#cb39-103" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- In the coding component, you should: --&gt;</span></span>
<span id="cb39-104"><a href="#cb39-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-105"><a href="#cb39-105" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>read the dataset;</span>
<span id="cb39-106"><a href="#cb39-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-109"><a href="#cb39-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-110"><a href="#cb39-110" aria-hidden="true" tabindex="-1"></a>columns <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"/home/aditya/Desktop/HealthData/2020/2020-column-layout.csv"</span>)</span>
<span id="cb39-111"><a href="#cb39-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-112"><a href="#cb39-112" aria-hidden="true" tabindex="-1"></a>columns<span class="sc">$</span>File_Width <span class="ot">=</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(columns), <span class="cf">function</span>(y) <span class="fu">ifelse</span>(y <span class="sc">&lt;</span> <span class="fu">nrow</span>(columns),</span>
<span id="cb39-113"><a href="#cb39-113" aria-hidden="true" tabindex="-1"></a>    columns<span class="sc">$</span>Starting_Column[y <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">-</span> columns<span class="sc">$</span>Starting_Column[y], <span class="dv">1</span>))</span>
<span id="cb39-114"><a href="#cb39-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-115"><a href="#cb39-115" aria-hidden="true" tabindex="-1"></a>columns <span class="ot">=</span> columns[columns<span class="sc">$</span>File_Width <span class="sc">&gt;</span> <span class="dv">0</span>,]</span>
<span id="cb39-116"><a href="#cb39-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-117"><a href="#cb39-117" aria-hidden="true" tabindex="-1"></a>responses <span class="ot">=</span> <span class="fu">read.fwf</span>(<span class="st">"/home/aditya/Desktop/HealthData/2020/LLCP2020.ASC "</span>, <span class="at">widths =</span> columns<span class="sc">$</span>File_Width, <span class="at">col.names =</span> columns<span class="sc">$</span>Variable_Name)</span>
<span id="cb39-118"><a href="#cb39-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-119"><a href="#cb39-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-120"><a href="#cb39-120" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb39-121"><a href="#cb39-121" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- responses = read_csv('/home/aditya/Desktop/HealthData/2020/filtered.csv') --&gt;</span></span>
<span id="cb39-122"><a href="#cb39-122" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb39-123"><a href="#cb39-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-126"><a href="#cb39-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-127"><a href="#cb39-127" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(responses)</span>
<span id="cb39-128"><a href="#cb39-128" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(responses)</span>
<span id="cb39-129"><a href="#cb39-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-130"><a href="#cb39-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-131"><a href="#cb39-131" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>There are 401958 rows in the data set</span>
<span id="cb39-132"><a href="#cb39-132" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>There are 277 columns in the data set</span>
<span id="cb39-133"><a href="#cb39-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-136"><a href="#cb39-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-137"><a href="#cb39-137" aria-hidden="true" tabindex="-1"></a>responses <span class="sc">%&gt;%</span></span>
<span id="cb39-138"><a href="#cb39-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-139"><a href="#cb39-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>()</span>
<span id="cb39-140"><a href="#cb39-140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-141"><a href="#cb39-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-142"><a href="#cb39-142" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb39-143"><a href="#cb39-143" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- # write_csv(responses, "/home/aditya/Desktop/HealthData/2020/filtered.csv") --&gt;</span></span>
<span id="cb39-144"><a href="#cb39-144" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb39-145"><a href="#cb39-145" aria-hidden="true" tabindex="-1"></a>Out of the 277 columns in the data set, for our study of the heart disease and the factors of the same, we use only a subset of all the columns in the dataset.</span>
<span id="cb39-146"><a href="#cb39-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-149"><a href="#cb39-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-150"><a href="#cb39-150" aria-hidden="true" tabindex="-1"></a>responses <span class="ot">&lt;-</span> responses <span class="sc">%&gt;%</span> </span>
<span id="cb39-151"><a href="#cb39-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb39-152"><a href="#cb39-152" aria-hidden="true" tabindex="-1"></a>    X_SEX,</span>
<span id="cb39-153"><a href="#cb39-153" aria-hidden="true" tabindex="-1"></a>    SLEPTIM1,</span>
<span id="cb39-154"><a href="#cb39-154" aria-hidden="true" tabindex="-1"></a>    WEIGHT2,</span>
<span id="cb39-155"><a href="#cb39-155" aria-hidden="true" tabindex="-1"></a>    HEIGHT3,</span>
<span id="cb39-156"><a href="#cb39-156" aria-hidden="true" tabindex="-1"></a>    X_AGE80,</span>
<span id="cb39-157"><a href="#cb39-157" aria-hidden="true" tabindex="-1"></a>    SMOKE100,</span>
<span id="cb39-158"><a href="#cb39-158" aria-hidden="true" tabindex="-1"></a>    EXERANY2,</span>
<span id="cb39-159"><a href="#cb39-159" aria-hidden="true" tabindex="-1"></a>    VETERAN3,</span>
<span id="cb39-160"><a href="#cb39-160" aria-hidden="true" tabindex="-1"></a>    X_MICHD</span>
<span id="cb39-161"><a href="#cb39-161" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-162"><a href="#cb39-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-163"><a href="#cb39-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-164"><a href="#cb39-164" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb39-165"><a href="#cb39-165" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- responses &lt;- responses %&gt;%  --&gt;</span></span>
<span id="cb39-166"><a href="#cb39-166" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   select( --&gt;</span></span>
<span id="cb39-167"><a href="#cb39-167" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     X_SEX, --&gt;</span></span>
<span id="cb39-168"><a href="#cb39-168" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     SLEPTIM1, --&gt;</span></span>
<span id="cb39-169"><a href="#cb39-169" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     WEIGHT2, --&gt;</span></span>
<span id="cb39-170"><a href="#cb39-170" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     HEIGHT3, --&gt;</span></span>
<span id="cb39-171"><a href="#cb39-171" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     X_AGE80, --&gt;</span></span>
<span id="cb39-172"><a href="#cb39-172" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     DIFFWALK, --&gt;</span></span>
<span id="cb39-173"><a href="#cb39-173" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     SMOKE100, --&gt;</span></span>
<span id="cb39-174"><a href="#cb39-174" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     EXERANY2, --&gt;</span></span>
<span id="cb39-175"><a href="#cb39-175" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     VETERAN3, --&gt;</span></span>
<span id="cb39-176"><a href="#cb39-176" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     X_LTASTH1, --&gt;</span></span>
<span id="cb39-177"><a href="#cb39-177" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     X_MICHD, --&gt;</span></span>
<span id="cb39-178"><a href="#cb39-178" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     CVDSTRK3, --&gt;</span></span>
<span id="cb39-179"><a href="#cb39-179" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     EMPLOY1, --&gt;</span></span>
<span id="cb39-180"><a href="#cb39-180" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     INCOME2, --&gt;</span></span>
<span id="cb39-181"><a href="#cb39-181" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     X_RACE --&gt;</span></span>
<span id="cb39-182"><a href="#cb39-182" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   ) --&gt;</span></span>
<span id="cb39-183"><a href="#cb39-183" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb39-184"><a href="#cb39-184" aria-hidden="true" tabindex="-1"></a>Out of around the three hundred columns, the following are the columns of interest:</span>
<span id="cb39-185"><a href="#cb39-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-186"><a href="#cb39-186" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>X_SEX : The sex of the subject,</span>
<span id="cb39-187"><a href="#cb39-187" aria-hidden="true" tabindex="-1"></a>Possible Values : 1(Male),2(Female)</span>
<span id="cb39-188"><a href="#cb39-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-189"><a href="#cb39-189" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>SLEPTIM1 : On average, how many hours of sleep does the subject get in a 24-hour period?</span>
<span id="cb39-190"><a href="#cb39-190" aria-hidden="true" tabindex="-1"></a>Possible Values : 1-24(Number of hours), 77(Not Sure), 99(Refused), Blank(Missing)</span>
<span id="cb39-191"><a href="#cb39-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-192"><a href="#cb39-192" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>WEIGHT2 : About how much does the subject weigh without shoes in pounds</span>
<span id="cb39-193"><a href="#cb39-193" aria-hidden="true" tabindex="-1"></a>Possible Values : 50 -776(Weight in pounds), 7777(Don't know), 9023-9352(Weight in KG without '9'), 9999 (Missing)</span>
<span id="cb39-194"><a href="#cb39-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-195"><a href="#cb39-195" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>HEIGHT3 : About how tall is the subject without shoes</span>
<span id="cb39-196"><a href="#cb39-196" aria-hidden="true" tabindex="-1"></a>Possible Values : 200 to 711(FeetInchInch format), 7777(Not Sure), 9061-9998(MeterCmCm format without leading '9'),9999(Missing)</span>
<span id="cb39-197"><a href="#cb39-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-198"><a href="#cb39-198" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>X_AGE80 : Imputed Age value collapsed above 80</span>
<span id="cb39-199"><a href="#cb39-199" aria-hidden="true" tabindex="-1"></a>Possible Values : 18-99</span>
<span id="cb39-200"><a href="#cb39-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-201"><a href="#cb39-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-202"><a href="#cb39-202" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>SMOKE100 : smoked at least 100 cigarettes in your entire life?</span>
<span id="cb39-203"><a href="#cb39-203" aria-hidden="true" tabindex="-1"></a>Possible Values : 1(Yest), 2(No), 7(Not Sure), 9(Refused), Blank(Missing)</span>
<span id="cb39-204"><a href="#cb39-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-205"><a href="#cb39-205" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>EXERANY2 : During the past month, other than your regular job, has the subject participated in any exercises</span>
<span id="cb39-206"><a href="#cb39-206" aria-hidden="true" tabindex="-1"></a>such as running, calisthenics, golf, gardening, or walking for exercise?</span>
<span id="cb39-207"><a href="#cb39-207" aria-hidden="true" tabindex="-1"></a>Possible Values : 1(Yes), 2(No), 7(Don't know, Not Sure)</span>
<span id="cb39-208"><a href="#cb39-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-209"><a href="#cb39-209" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>VETERAN3 : ever served on active duty in the United States Armed Forces, either in the regular military or in a</span>
<span id="cb39-210"><a href="#cb39-210" aria-hidden="true" tabindex="-1"></a>National Guard or military reserve unit?</span>
<span id="cb39-211"><a href="#cb39-211" aria-hidden="true" tabindex="-1"></a>Possible Values : 1(Yes), 2(No), 7(Don't know, Not Sure), 9(Refused), Blank(Missing)</span>
<span id="cb39-212"><a href="#cb39-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-213"><a href="#cb39-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-214"><a href="#cb39-214" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>X_MICHD : Ever reported having coronary heart disease (CHD) or myocardial infarction(MI)</span>
<span id="cb39-215"><a href="#cb39-215" aria-hidden="true" tabindex="-1"></a>Possible Values : 1(Yes), 2(No), Blank(Missing)</span>
<span id="cb39-216"><a href="#cb39-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-217"><a href="#cb39-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-218"><a href="#cb39-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-219"><a href="#cb39-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### Clean the Data</span></span>
<span id="cb39-220"><a href="#cb39-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-221"><a href="#cb39-221" aria-hidden="true" tabindex="-1"></a>The raw data from the survey is not directly usable for our analysis. It need to be converted to a representation and units that will help us visualize the data and the trends.</span>
<span id="cb39-222"><a href="#cb39-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-223"><a href="#cb39-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-224"><a href="#cb39-224" aria-hidden="true" tabindex="-1"></a>First, we will rename the column names so that they will make more sense and represent the features they refer to.</span>
<span id="cb39-225"><a href="#cb39-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-228"><a href="#cb39-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-229"><a href="#cb39-229" aria-hidden="true" tabindex="-1"></a>responses <span class="ot">&lt;-</span> responses <span class="sc">%&gt;%</span></span>
<span id="cb39-230"><a href="#cb39-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb39-231"><a href="#cb39-231" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> X_SEX, </span>
<span id="cb39-232"><a href="#cb39-232" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> X_AGE80,</span>
<span id="cb39-233"><a href="#cb39-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">SleepTime =</span> SLEPTIM1,</span>
<span id="cb39-234"><a href="#cb39-234" aria-hidden="true" tabindex="-1"></a>    <span class="at">Weight =</span> WEIGHT2,</span>
<span id="cb39-235"><a href="#cb39-235" aria-hidden="true" tabindex="-1"></a>    <span class="at">Height =</span> HEIGHT3,</span>
<span id="cb39-236"><a href="#cb39-236" aria-hidden="true" tabindex="-1"></a>    <span class="at">Veteran =</span> VETERAN3,</span>
<span id="cb39-237"><a href="#cb39-237" aria-hidden="true" tabindex="-1"></a>    <span class="at">Exercise =</span> EXERANY2,</span>
<span id="cb39-238"><a href="#cb39-238" aria-hidden="true" tabindex="-1"></a>    <span class="at">HeartDisease =</span> X_MICHD,</span>
<span id="cb39-239"><a href="#cb39-239" aria-hidden="true" tabindex="-1"></a>    <span class="at">Smoke =</span> SMOKE100</span>
<span id="cb39-240"><a href="#cb39-240" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb39-241"><a href="#cb39-241" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-242"><a href="#cb39-242" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> responses <span class="sc">%&gt;%</span></span>
<span id="cb39-243"><a href="#cb39-243" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb39-244"><a href="#cb39-244" aria-hidden="true" tabindex="-1"></a>      Sex, </span>
<span id="cb39-245"><a href="#cb39-245" aria-hidden="true" tabindex="-1"></a>      Age,</span>
<span id="cb39-246"><a href="#cb39-246" aria-hidden="true" tabindex="-1"></a>      SleepTime,</span>
<span id="cb39-247"><a href="#cb39-247" aria-hidden="true" tabindex="-1"></a>      Weight,</span>
<span id="cb39-248"><a href="#cb39-248" aria-hidden="true" tabindex="-1"></a>      Height,</span>
<span id="cb39-249"><a href="#cb39-249" aria-hidden="true" tabindex="-1"></a>      Veteran,</span>
<span id="cb39-250"><a href="#cb39-250" aria-hidden="true" tabindex="-1"></a>      Exercise,</span>
<span id="cb39-251"><a href="#cb39-251" aria-hidden="true" tabindex="-1"></a>      HeartDisease,</span>
<span id="cb39-252"><a href="#cb39-252" aria-hidden="true" tabindex="-1"></a>      Smoke</span>
<span id="cb39-253"><a href="#cb39-253" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-254"><a href="#cb39-254" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-255"><a href="#cb39-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-256"><a href="#cb39-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-257"><a href="#cb39-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-258"><a href="#cb39-258" aria-hidden="true" tabindex="-1"></a>The raw Sex values are numerical where 1 represents male and 2 represents female. We would like to convert them into "Male" and "Female". There are other values which Sex column can take(Such as missing, refused etc.) we mark all of them as NA.</span>
<span id="cb39-259"><a href="#cb39-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-262"><a href="#cb39-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-263"><a href="#cb39-263" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the Sex to "Male" and "Female"</span></span>
<span id="cb39-264"><a href="#cb39-264" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb39-265"><a href="#cb39-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sex =</span> <span class="fu">ifelse</span>(Sex <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Male"</span>, <span class="fu">ifelse</span>(Sex <span class="sc">==</span> <span class="dv">2</span>,<span class="st">"Female"</span>,<span class="cn">NA</span>)))</span>
<span id="cb39-266"><a href="#cb39-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-267"><a href="#cb39-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-268"><a href="#cb39-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-269"><a href="#cb39-269" aria-hidden="true" tabindex="-1"></a>The height column has some values in Feet-Inch format and others in Meter-Centimeter format. We will clean it up and convert all of the values in Centimeters.</span>
<span id="cb39-270"><a href="#cb39-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-273"><a href="#cb39-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-274"><a href="#cb39-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the heights in Feet,Inches and Meter,Centimeter format to centimeters</span></span>
<span id="cb39-275"><a href="#cb39-275" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Height <span class="ot">&lt;-</span> <span class="fu">replace_na</span>(data<span class="sc">$</span>Height,<span class="dv">0</span>)</span>
<span id="cb39-276"><a href="#cb39-276" aria-hidden="true" tabindex="-1"></a>convert_height <span class="ot">&lt;-</span> <span class="cf">function</span>(height) {</span>
<span id="cb39-277"><a href="#cb39-277" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if the height is invalid due to any reason, return NA</span></span>
<span id="cb39-278"><a href="#cb39-278" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.na</span>(height) <span class="sc">|</span> height <span class="sc">==</span> <span class="dv">7777</span> <span class="sc">|</span> height <span class="sc">==</span> <span class="dv">9999</span>){</span>
<span id="cb39-279"><a href="#cb39-279" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb39-280"><a href="#cb39-280" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (height <span class="sc">&gt;=</span> <span class="dv">1000</span> <span class="sc">&amp;&amp;</span> height <span class="sc">&lt;=</span> <span class="dv">9999</span>) {</span>
<span id="cb39-281"><a href="#cb39-281" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert MeterCmCm format to centimeters</span></span>
<span id="cb39-282"><a href="#cb39-282" aria-hidden="true" tabindex="-1"></a>    cms <span class="ot">&lt;-</span> height <span class="sc">%%</span> <span class="dv">100</span></span>
<span id="cb39-283"><a href="#cb39-283" aria-hidden="true" tabindex="-1"></a>    meters <span class="ot">&lt;-</span> (height <span class="sc">%/%</span> <span class="dv">100</span>) <span class="sc">%%</span> <span class="dv">10</span></span>
<span id="cb39-284"><a href="#cb39-284" aria-hidden="true" tabindex="-1"></a>    centimeters <span class="ot">&lt;-</span> (meters <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">+</span> cms</span>
<span id="cb39-285"><a href="#cb39-285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(centimeters)</span>
<span id="cb39-286"><a href="#cb39-286" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (height <span class="sc">&gt;=</span> <span class="dv">200</span> <span class="sc">&amp;&amp;</span> height <span class="sc">&lt;=</span> <span class="dv">711</span>) {</span>
<span id="cb39-287"><a href="#cb39-287" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert FeetInchInch format to centimeters</span></span>
<span id="cb39-288"><a href="#cb39-288" aria-hidden="true" tabindex="-1"></a>    inches <span class="ot">&lt;-</span> height <span class="sc">%%</span> <span class="dv">100</span></span>
<span id="cb39-289"><a href="#cb39-289" aria-hidden="true" tabindex="-1"></a>    feet <span class="ot">&lt;-</span> height <span class="sc">%/%</span> <span class="dv">100</span></span>
<span id="cb39-290"><a href="#cb39-290" aria-hidden="true" tabindex="-1"></a>    centimeters <span class="ot">&lt;-</span> (feet <span class="sc">*</span> <span class="fl">30.48</span>) <span class="sc">+</span> (inches <span class="sc">*</span> <span class="fl">2.54</span>)</span>
<span id="cb39-291"><a href="#cb39-291" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(centimeters)</span>
<span id="cb39-292"><a href="#cb39-292" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb39-293"><a href="#cb39-293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb39-294"><a href="#cb39-294" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-295"><a href="#cb39-295" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-296"><a href="#cb39-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-297"><a href="#cb39-297" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Height <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span>Height, convert_height)</span>
<span id="cb39-298"><a href="#cb39-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-299"><a href="#cb39-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-300"><a href="#cb39-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-301"><a href="#cb39-301" aria-hidden="true" tabindex="-1"></a>The weight also has values in both Pounds and Kgs, we clean it up  and convert all the values into Kgs.</span>
<span id="cb39-302"><a href="#cb39-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-305"><a href="#cb39-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-306"><a href="#cb39-306" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the Weights in different formats to Kgs</span></span>
<span id="cb39-307"><a href="#cb39-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-308"><a href="#cb39-308" aria-hidden="true" tabindex="-1"></a>convert_weight <span class="ot">&lt;-</span> <span class="cf">function</span>(weight) {</span>
<span id="cb39-309"><a href="#cb39-309" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if the height is invalid due to any reason, return NA</span></span>
<span id="cb39-310"><a href="#cb39-310" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.na</span>(weight) <span class="sc">|</span> weight <span class="sc">==</span> <span class="dv">7777</span> <span class="sc">|</span> weight <span class="sc">==</span> <span class="dv">9999</span>){</span>
<span id="cb39-311"><a href="#cb39-311" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb39-312"><a href="#cb39-312" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (weight <span class="sc">&gt;=</span> <span class="dv">50</span> <span class="sc">&amp;&amp;</span> weight <span class="sc">&lt;=</span> <span class="dv">0776</span>) {</span>
<span id="cb39-313"><a href="#cb39-313" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert pounds to Kg</span></span>
<span id="cb39-314"><a href="#cb39-314" aria-hidden="true" tabindex="-1"></a>    kgs <span class="ot">&lt;-</span> weight <span class="sc">/</span> <span class="fl">2.2</span></span>
<span id="cb39-315"><a href="#cb39-315" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(kgs)</span>
<span id="cb39-316"><a href="#cb39-316" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (weight <span class="sc">&gt;=</span> <span class="dv">9000</span> <span class="sc">&amp;&amp;</span> weight <span class="sc">&lt;=</span> <span class="dv">10000</span>) {</span>
<span id="cb39-317"><a href="#cb39-317" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract Kilograms</span></span>
<span id="cb39-318"><a href="#cb39-318" aria-hidden="true" tabindex="-1"></a>    kgs <span class="ot">=</span> weight <span class="sc">%%</span> <span class="dv">1000</span></span>
<span id="cb39-319"><a href="#cb39-319" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(kgs)</span>
<span id="cb39-320"><a href="#cb39-320" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb39-321"><a href="#cb39-321" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb39-322"><a href="#cb39-322" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-323"><a href="#cb39-323" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-324"><a href="#cb39-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-325"><a href="#cb39-325" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Weight <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span>Weight, convert_weight)</span>
<span id="cb39-326"><a href="#cb39-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-327"><a href="#cb39-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-328"><a href="#cb39-328" aria-hidden="true" tabindex="-1"></a>Similar to Sex, we convert veteran status, smoking, Exercise and Heart Disease columns into corresponding strings from numerical values.</span>
<span id="cb39-329"><a href="#cb39-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-332"><a href="#cb39-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-333"><a href="#cb39-333" aria-hidden="true" tabindex="-1"></a><span class="do">### Convert veteran status, Smoking, Exercise and  Heart Disease to strings</span></span>
<span id="cb39-334"><a href="#cb39-334" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-335"><a href="#cb39-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Veteran =</span> <span class="fu">ifelse</span>(Veteran <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Yes"</span>, <span class="fu">ifelse</span>(Veteran <span class="sc">==</span> <span class="dv">2</span>,<span class="st">"No"</span>,<span class="cn">NA</span>)),<span class="at">HeartDisease =</span> <span class="fu">ifelse</span>(HeartDisease <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Yes"</span>, <span class="fu">ifelse</span>(HeartDisease <span class="sc">==</span> <span class="dv">2</span>, <span class="st">"No"</span>, <span class="st">"0"</span>)), <span class="at">Smoke =</span> <span class="fu">ifelse</span>(Smoke <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Yes"</span>, <span class="fu">ifelse</span>(Smoke <span class="sc">==</span> <span class="dv">2</span>,<span class="st">"No"</span>,<span class="cn">NA</span>)),<span class="at">Exercise =</span> <span class="fu">ifelse</span>(Exercise <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Yes"</span>, <span class="fu">ifelse</span>(Exercise <span class="sc">==</span> <span class="dv">2</span>,<span class="st">"No"</span>,<span class="cn">NA</span>)))</span>
<span id="cb39-336"><a href="#cb39-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-337"><a href="#cb39-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-338"><a href="#cb39-338" aria-hidden="true" tabindex="-1"></a>Convert Sleep time to 1-24H</span>
<span id="cb39-341"><a href="#cb39-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-342"><a href="#cb39-342" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-343"><a href="#cb39-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SleepTime =</span> <span class="fu">ifelse</span>(SleepTime <span class="sc">&lt;</span> <span class="dv">25</span>, SleepTime, <span class="cn">NA</span>))</span>
<span id="cb39-344"><a href="#cb39-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-345"><a href="#cb39-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-348"><a href="#cb39-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-349"><a href="#cb39-349" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data)</span>
<span id="cb39-350"><a href="#cb39-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-351"><a href="#cb39-351" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">15</span>)</span>
<span id="cb39-352"><a href="#cb39-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-353"><a href="#cb39-353" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span>
<span id="cb39-354"><a href="#cb39-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-355"><a href="#cb39-355" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span>
<span id="cb39-356"><a href="#cb39-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-357"><a href="#cb39-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-358"><a href="#cb39-358" aria-hidden="true" tabindex="-1"></a>We have shown the final columns and summary of the data above after cleaning and remapping the data.</span>
<span id="cb39-359"><a href="#cb39-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-360"><a href="#cb39-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-361"><a href="#cb39-361" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 3: Visualization</span></span>
<span id="cb39-362"><a href="#cb39-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-363"><a href="#cb39-363" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Tentative plan for visualization</span></span>
<span id="cb39-364"><a href="#cb39-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-365"><a href="#cb39-365" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>We will first visualize the distribution of samples with respect to age and gender.</span>
<span id="cb39-366"><a href="#cb39-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-367"><a href="#cb39-367" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Then we will study the impact of the following factors on heart disease using Bar plots, Histograms and pie charts.</span>
<span id="cb39-368"><a href="#cb39-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-369"><a href="#cb39-369" aria-hidden="true" tabindex="-1"></a><span class="ss">  1.    </span>Gender</span>
<span id="cb39-370"><a href="#cb39-370" aria-hidden="true" tabindex="-1"></a><span class="ss">  2.    </span>Age</span>
<span id="cb39-371"><a href="#cb39-371" aria-hidden="true" tabindex="-1"></a><span class="ss">  3.    </span>Veteran Status</span>
<span id="cb39-372"><a href="#cb39-372" aria-hidden="true" tabindex="-1"></a><span class="ss">  4.    </span>Somking</span>
<span id="cb39-373"><a href="#cb39-373" aria-hidden="true" tabindex="-1"></a><span class="ss">  5.    </span>BMI</span>
<span id="cb39-374"><a href="#cb39-374" aria-hidden="true" tabindex="-1"></a><span class="ss">  6.    </span>Exercise</span>
<span id="cb39-375"><a href="#cb39-375" aria-hidden="true" tabindex="-1"></a><span class="ss">  7.    </span>Sleeping time</span>
<span id="cb39-376"><a href="#cb39-376" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb39-377"><a href="#cb39-377" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Finally, We will analyze the most vulnerable population and find out which changes if made in lifestyle could help in reduce the risk of heart disease using Pie Charts.</span>
<span id="cb39-378"><a href="#cb39-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-379"><a href="#cb39-379" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Distribution of Male and Female subjects for the data</span></span>
<span id="cb39-380"><a href="#cb39-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-381"><a href="#cb39-381" aria-hidden="true" tabindex="-1"></a>One of the major factor which we want to study with respect to the heart disease is the gender of the person. Therefore, we first try see the distribution of the male and female proportion in the data set.</span>
<span id="cb39-382"><a href="#cb39-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-385"><a href="#cb39-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-386"><a href="#cb39-386" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a table with the number of males and females</span></span>
<span id="cb39-387"><a href="#cb39-387" aria-hidden="true" tabindex="-1"></a>sex_table <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-388"><a href="#cb39-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sex) <span class="sc">%&gt;%</span></span>
<span id="cb39-389"><a href="#cb39-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>()</span>
<span id="cb39-390"><a href="#cb39-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-391"><a href="#cb39-391" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of males and females</span></span>
<span id="cb39-392"><a href="#cb39-392" aria-hidden="true" tabindex="-1"></a>sex_percent <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">prop.table</span>(sex_table)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb39-393"><a href="#cb39-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-394"><a href="#cb39-394" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot of the sex data with percentages</span></span>
<span id="cb39-395"><a href="#cb39-395" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(sex_table, <span class="at">main=</span><span class="st">"Number of Males and Females"</span>,</span>
<span id="cb39-396"><a href="#cb39-396" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Sex"</span>, <span class="at">ylab=</span><span class="st">"Frequency"</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"pink"</span>, <span class="st">"lightblue"</span>),</span>
<span id="cb39-397"><a href="#cb39-397" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(sex_table)<span class="sc">*</span><span class="fl">1.2</span>))</span>
<span id="cb39-398"><a href="#cb39-398" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, sex_table <span class="sc">+</span> <span class="fl">0.2</span>, <span class="fu">paste0</span>(sex_percent, <span class="st">"%"</span>), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb39-399"><a href="#cb39-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-400"><a href="#cb39-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-401"><a href="#cb39-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-402"><a href="#cb39-402" aria-hidden="true" tabindex="-1"></a>As we can see the number of samples of both genders is fairly equal and none of the gender dominate the dataset.</span>
<span id="cb39-403"><a href="#cb39-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-404"><a href="#cb39-404" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Distribution of Subjects across age groups</span></span>
<span id="cb39-405"><a href="#cb39-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-406"><a href="#cb39-406" aria-hidden="true" tabindex="-1"></a>Another important factor that we take into our study is the age of the people in the dataset. We divide the people into buckets with a range of 5 and plot a bar chart to see the distribution of the people in different age groups.</span>
<span id="cb39-407"><a href="#cb39-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-410"><a href="#cb39-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-411"><a href="#cb39-411" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb39-412"><a href="#cb39-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Age)</span>
<span id="cb39-413"><a href="#cb39-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-414"><a href="#cb39-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the age groups</span></span>
<span id="cb39-415"><a href="#cb39-415" aria-hidden="true" tabindex="-1"></a>ages<span class="sc">$</span>AgeGroup <span class="ot">&lt;-</span> <span class="fu">cut</span>(ages<span class="sc">$</span>Age, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">15</span>, <span class="dv">90</span>, <span class="at">by =</span> <span class="dv">10</span>))</span>
<span id="cb39-416"><a href="#cb39-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-417"><a href="#cb39-417" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb39-418"><a href="#cb39-418" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ages, <span class="fu">aes</span>(<span class="at">x =</span> AgeGroup)) <span class="sc">+</span></span>
<span id="cb39-419"><a href="#cb39-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb39-420"><a href="#cb39-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">title =</span> <span class="st">"Age Distribution"</span>) <span class="sc">+</span></span>
<span id="cb39-421"><a href="#cb39-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb39-422"><a href="#cb39-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-423"><a href="#cb39-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-424"><a href="#cb39-424" aria-hidden="true" tabindex="-1"></a>Though there are a little higher people in the range 40-60, there are good number samples of other ages too. Therefore again the results will not be skewed towards any particular age groups.</span>
<span id="cb39-425"><a href="#cb39-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-426"><a href="#cb39-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-427"><a href="#cb39-427" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #### Distribution of Subjects across Race --&gt;</span></span>
<span id="cb39-428"><a href="#cb39-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-429"><a href="#cb39-429" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb39-430"><a href="#cb39-430" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ggplot(data, aes(x = Race)) + --&gt;</span></span>
<span id="cb39-431"><a href="#cb39-431" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   geom_bar(fill = "lightblue") + --&gt;</span></span>
<span id="cb39-432"><a href="#cb39-432" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   xlab("Race") + --&gt;</span></span>
<span id="cb39-433"><a href="#cb39-433" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   ylab("Count") + --&gt;</span></span>
<span id="cb39-434"><a href="#cb39-434" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   ggtitle("Count of Race") + --&gt;</span></span>
<span id="cb39-435"><a href="#cb39-435" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   geom_text(stat='count', aes(label=..count..), vjust=-0.5)  --&gt;</span></span>
<span id="cb39-436"><a href="#cb39-436" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb39-437"><a href="#cb39-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-438"><a href="#cb39-438" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of various factors and the probability of heart disease</span></span>
<span id="cb39-439"><a href="#cb39-439" aria-hidden="true" tabindex="-1"></a>We now have a look at some factors and check what percentages of people have heart disease with these factors.</span>
<span id="cb39-440"><a href="#cb39-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-441"><a href="#cb39-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-442"><a href="#cb39-442" aria-hidden="true" tabindex="-1"></a><span class="fu">#### How is heart disease related to the gender of the person</span></span>
<span id="cb39-443"><a href="#cb39-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-444"><a href="#cb39-444" aria-hidden="true" tabindex="-1"></a>We now study the relation of gender to the likeliness of getting a heart disease. We plot a bar graph of male and female and fill it with the proportion of people with heart disease to study the impact of gender on heart disease.</span>
<span id="cb39-445"><a href="#cb39-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-448"><a href="#cb39-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-449"><a href="#cb39-449" aria-hidden="true" tabindex="-1"></a>Sex_HeartDisease <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-450"><a href="#cb39-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Sex</span><span class="st">`</span>,<span class="st">`</span><span class="at">HeartDisease</span><span class="st">`</span>)</span>
<span id="cb39-451"><a href="#cb39-451" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the N/A values</span></span>
<span id="cb39-452"><a href="#cb39-452" aria-hidden="true" tabindex="-1"></a>Sex_HeartDisease <span class="ot">&lt;-</span> Sex_HeartDisease <span class="sc">%&gt;%</span></span>
<span id="cb39-453"><a href="#cb39-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(HeartDisease))</span>
<span id="cb39-454"><a href="#cb39-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-455"><a href="#cb39-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-456"><a href="#cb39-456" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the proportions</span></span>
<span id="cb39-457"><a href="#cb39-457" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> Sex_HeartDisease <span class="sc">%&gt;%</span></span>
<span id="cb39-458"><a href="#cb39-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex, HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb39-459"><a href="#cb39-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-460"><a href="#cb39-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex) <span class="sc">%&gt;%</span></span>
<span id="cb39-461"><a href="#cb39-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count))</span>
<span id="cb39-462"><a href="#cb39-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-463"><a href="#cb39-463" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb39-464"><a href="#cb39-464" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proportions, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> proportion, <span class="at">fill =</span> HeartDisease)) <span class="sc">+</span></span>
<span id="cb39-465"><a href="#cb39-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb39-466"><a href="#cb39-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(proportion, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb39-467"><a href="#cb39-467" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb39-468"><a href="#cb39-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sex"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>, <span class="at">fill =</span> <span class="st">"Heart Disease"</span>) <span class="sc">+</span></span>
<span id="cb39-469"><a href="#cb39-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"NA"</span> <span class="ot">=</span> <span class="st">"gray"</span>), <span class="at">na.value =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb39-470"><a href="#cb39-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb39-471"><a href="#cb39-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-472"><a href="#cb39-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-473"><a href="#cb39-473" aria-hidden="true" tabindex="-1"></a>Among men, 10.7% have heart disease, while 89.3% do not. Among women, 6.8% have heart disease, while 93.2% do not.</span>
<span id="cb39-474"><a href="#cb39-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-475"><a href="#cb39-475" aria-hidden="true" tabindex="-1"></a>From these figures, we can infer that both men and women are susceptible to heart disease, but there is a slightly higher prevalence among men compared to women. The data suggests that men have a higher risk of developing heart disease than women, with a 10.7% prevalence compared to 6.8%. This aligns with existing research indicating that men are generally more prone to heart disease.</span>
<span id="cb39-476"><a href="#cb39-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-477"><a href="#cb39-477" aria-hidden="true" tabindex="-1"></a><span class="fu">#### How is heart disease releated to the age of the person?</span></span>
<span id="cb39-478"><a href="#cb39-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-481"><a href="#cb39-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-482"><a href="#cb39-482" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values</span></span>
<span id="cb39-483"><a href="#cb39-483" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(Age,HeartDisease)</span>
<span id="cb39-484"><a href="#cb39-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-485"><a href="#cb39-485" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the ratio of people with and without heart disease for each age group, handling NA values</span></span>
<span id="cb39-486"><a href="#cb39-486" aria-hidden="true" tabindex="-1"></a>ratio_data <span class="ot">&lt;-</span> <span class="fu">tapply</span>(data<span class="sc">$</span>HeartDisease, data<span class="sc">$</span>Age, <span class="cf">function</span>(x) {</span>
<span id="cb39-487"><a href="#cb39-487" aria-hidden="true" tabindex="-1"></a>  n_yes <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-488"><a href="#cb39-488" aria-hidden="true" tabindex="-1"></a>  n_no <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">==</span> <span class="st">"No"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-489"><a href="#cb39-489" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(n_yes) <span class="sc">||</span> <span class="fu">is.na</span>(n_no))</span>
<span id="cb39-490"><a href="#cb39-490" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb39-491"><a href="#cb39-491" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb39-492"><a href="#cb39-492" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(n_yes <span class="sc">/</span> (n_yes<span class="sc">+</span>n_no))</span>
<span id="cb39-493"><a href="#cb39-493" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb39-494"><a href="#cb39-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-495"><a href="#cb39-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-496"><a href="#cb39-496" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot of the ratio, excluding NA values</span></span>
<span id="cb39-497"><a href="#cb39-497" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(ratio_data[<span class="sc">!</span><span class="fu">is.na</span>(ratio_data)], <span class="at">col =</span> <span class="st">"#4D4D4D"</span>, <span class="at">xlab =</span> <span class="st">"Age"</span>, <span class="at">ylab =</span> <span class="st">"Ratio of People"</span>, <span class="at">main =</span> <span class="st">"Ratio of People with Heart Disease by Age"</span>)</span>
<span id="cb39-498"><a href="#cb39-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-499"><a href="#cb39-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-500"><a href="#cb39-500" aria-hidden="true" tabindex="-1"></a>The provided data represents the ratio of people with heart disease to people without heart disease across different age groups. The data shows that the prevalence of heart disease tends to increase with age. In the younger age groups (18-29), the ratios range from 0.005562914 to 0.010360138, indicating a relatively low proportion of individuals with heart disease. However, as the age increases, the ratios gradually rise. From ages 30 to 47, the ratios range from 0.012141280 to 0.037837838, suggesting a notable increase in the prevalence of heart disease. This trend continues in the subsequent age groups, with ratios ranging from 0.042045868 to 0.290657149 in the age range of 48-80.</span>
<span id="cb39-501"><a href="#cb39-501" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-502"><a href="#cb39-502" aria-hidden="true" tabindex="-1"></a>The data implies that as individuals grow older, they are more likely to develop heart disease. This inference aligns with the widely recognized understanding that age is a significant risk factor for heart disease. The progressive increase in the ratio of individuals with heart disease across the age groups highlights the importance of preventive measures and regular cardiovascular health monitoring, especially as individuals approach and surpass middle age. These findings underscore the need for early detection, lifestyle modifications, and appropriate medical interventions to mitigate the risk and impact of heart disease, particularly in older populations.</span>
<span id="cb39-503"><a href="#cb39-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-504"><a href="#cb39-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-505"><a href="#cb39-505" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Veterans Vs Non Veterans</span></span>
<span id="cb39-506"><a href="#cb39-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-507"><a href="#cb39-507" aria-hidden="true" tabindex="-1"></a>We now study the probability of heart disease on veterans and non veterans by using a similar bar plot.</span>
<span id="cb39-510"><a href="#cb39-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-511"><a href="#cb39-511" aria-hidden="true" tabindex="-1"></a>VeteranHeartDisease <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-512"><a href="#cb39-512" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(Veteran, HeartDisease)</span>
<span id="cb39-513"><a href="#cb39-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-514"><a href="#cb39-514" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> VeteranHeartDisease <span class="sc">%&gt;%</span></span>
<span id="cb39-515"><a href="#cb39-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Veteran, HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb39-516"><a href="#cb39-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-517"><a href="#cb39-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Veteran) <span class="sc">%&gt;%</span></span>
<span id="cb39-518"><a href="#cb39-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count))</span>
<span id="cb39-519"><a href="#cb39-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-520"><a href="#cb39-520" aria-hidden="true" tabindex="-1"></a>proportions</span>
<span id="cb39-521"><a href="#cb39-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-522"><a href="#cb39-522" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb39-523"><a href="#cb39-523" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proportions, <span class="fu">aes</span>(<span class="at">x =</span> Veteran, <span class="at">y =</span> proportion, <span class="at">fill =</span> HeartDisease)) <span class="sc">+</span></span>
<span id="cb39-524"><a href="#cb39-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb39-525"><a href="#cb39-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(proportion, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb39-526"><a href="#cb39-526" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb39-527"><a href="#cb39-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Veteran"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>, <span class="at">fill =</span> <span class="st">"Heart Disease"</span>) <span class="sc">+</span></span>
<span id="cb39-528"><a href="#cb39-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"NA"</span> <span class="ot">=</span> <span class="st">"gray"</span>), <span class="at">na.value =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb39-529"><a href="#cb39-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb39-530"><a href="#cb39-530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-531"><a href="#cb39-531" aria-hidden="true" tabindex="-1"></a>These statistics suggest that there is a notable difference in the prevalence of heart disease between veterans and non-veterans. Veterans appear to have a higher percentage of individuals with heart disease compared to non-veterans. This finding may indicate that veteran status is associated with a higher risk or susceptibility to heart disease.</span>
<span id="cb39-532"><a href="#cb39-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-533"><a href="#cb39-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-534"><a href="#cb39-534" aria-hidden="true" tabindex="-1"></a><span class="fu">#### How is heart disease related to Smoking status?</span></span>
<span id="cb39-537"><a href="#cb39-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-538"><a href="#cb39-538" aria-hidden="true" tabindex="-1"></a>SmokingHeartDisease <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-539"><a href="#cb39-539" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(Smoke, HeartDisease)</span>
<span id="cb39-540"><a href="#cb39-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-541"><a href="#cb39-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-542"><a href="#cb39-542" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> SmokingHeartDisease <span class="sc">%&gt;%</span></span>
<span id="cb39-543"><a href="#cb39-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Smoke, HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb39-544"><a href="#cb39-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-545"><a href="#cb39-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Smoke) <span class="sc">%&gt;%</span></span>
<span id="cb39-546"><a href="#cb39-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count))</span>
<span id="cb39-547"><a href="#cb39-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-548"><a href="#cb39-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot</span></span>
<span id="cb39-549"><a href="#cb39-549" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(proportions, <span class="fu">aes</span>(<span class="at">x =</span> Smoke, <span class="at">y =</span> proportion, <span class="at">fill =</span> HeartDisease)) <span class="sc">+</span></span>
<span id="cb39-550"><a href="#cb39-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb39-551"><a href="#cb39-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(proportion, <span class="at">accuracy =</span> <span class="fl">0.1</span>)),</span>
<span id="cb39-552"><a href="#cb39-552" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb39-553"><a href="#cb39-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Smoke"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>, <span class="at">fill =</span> <span class="st">"Heart Disease"</span>) <span class="sc">+</span></span>
<span id="cb39-554"><a href="#cb39-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"No"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"Yes"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"NA"</span> <span class="ot">=</span> <span class="st">"gray"</span>), <span class="at">na.value =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb39-555"><a href="#cb39-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb39-556"><a href="#cb39-556" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-557"><a href="#cb39-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-558"><a href="#cb39-558" aria-hidden="true" tabindex="-1"></a>The data presented sheds light on the prevalence of heart disease among smokers and non-smokers, providing valuable insights into the impact of smoking on cardiovascular health. Among smokers, 12.3% are affected by heart disease, while the vast majority, accounting for 87.7%, remain free from this condition. This stark contrast between the two groups underscores the profound influence of smoking on heart health. The statistics reveal that smoking significantly increases the risk of developing heart disease.</span>
<span id="cb39-559"><a href="#cb39-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-560"><a href="#cb39-560" aria-hidden="true" tabindex="-1"></a>On the other hand, among non-smokers, the prevalence of heart disease is considerably lower, with only 6.1% of individuals being affected. This finding emphasizes the importance of maintaining a smoke-free lifestyle in mitigating the risk of heart disease. It highlights the fact that non-smokers have a significantly reduced likelihood of developing heart issues, further emphasizing the bad impact of smoking on heart health.</span>
<span id="cb39-561"><a href="#cb39-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-562"><a href="#cb39-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-563"><a href="#cb39-563" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> How is weight of the individuals affecting the heart disease? --&gt;</span></span>
<span id="cb39-564"><a href="#cb39-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-565"><a href="#cb39-565" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r} --&gt;</span></span>
<span id="cb39-566"><a href="#cb39-566" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- WeightHeartDisease &lt;- data %&gt;% --&gt;</span></span>
<span id="cb39-567"><a href="#cb39-567" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   select(Weight, HeartDisease) %&gt;% --&gt;</span></span>
<span id="cb39-568"><a href="#cb39-568" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   filter(!is.na(Weight) &amp; !is.na(HeartDisease)) --&gt;</span></span>
<span id="cb39-569"><a href="#cb39-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-570"><a href="#cb39-570" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- # Create the scatter plot --&gt;</span></span>
<span id="cb39-571"><a href="#cb39-571" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ggplot(WeightHeartDisease, aes(x = Weight, y = HeartDisease)) + --&gt;</span></span>
<span id="cb39-572"><a href="#cb39-572" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   geom_point(size = 3, shape = 16, color = "blue") + --&gt;</span></span>
<span id="cb39-573"><a href="#cb39-573" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   labs(x = "Weight (kg)", y = "Heart Disease") + --&gt;</span></span>
<span id="cb39-574"><a href="#cb39-574" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   ggtitle("Weight vs. Heart Disease") + --&gt;</span></span>
<span id="cb39-575"><a href="#cb39-575" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   theme_minimal() --&gt;</span></span>
<span id="cb39-576"><a href="#cb39-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-577"><a href="#cb39-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-578"><a href="#cb39-578" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- # Create the box plot --&gt;</span></span>
<span id="cb39-579"><a href="#cb39-579" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ggplot(WeightHeartDisease , aes(x = HeartDisease, y = Weight, fill = HeartDisease)) + --&gt;</span></span>
<span id="cb39-580"><a href="#cb39-580" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   geom_boxplot() + --&gt;</span></span>
<span id="cb39-581"><a href="#cb39-581" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   labs(x = "Heart Disease", y = "Weight (kg)") + --&gt;</span></span>
<span id="cb39-582"><a href="#cb39-582" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   ggtitle("Weight Distribution by Heart Disease") + --&gt;</span></span>
<span id="cb39-583"><a href="#cb39-583" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   theme_minimal() --&gt;</span></span>
<span id="cb39-584"><a href="#cb39-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-585"><a href="#cb39-585" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb39-586"><a href="#cb39-586" aria-hidden="true" tabindex="-1"></a><span class="fu">#### How is heart disease releated to whether a person exercises?</span></span>
<span id="cb39-587"><a href="#cb39-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-590"><a href="#cb39-590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-591"><a href="#cb39-591" aria-hidden="true" tabindex="-1"></a>proportions <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-592"><a href="#cb39-592" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(Exercise, HeartDisease)<span class="sc">%&gt;%</span></span>
<span id="cb39-593"><a href="#cb39-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Exercise) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(HeartDisease))<span class="sc">%&gt;%</span></span>
<span id="cb39-594"><a href="#cb39-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Exercise, HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb39-595"><a href="#cb39-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-596"><a href="#cb39-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Exercise) <span class="sc">%&gt;%</span></span>
<span id="cb39-597"><a href="#cb39-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count))</span>
<span id="cb39-598"><a href="#cb39-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-599"><a href="#cb39-599" aria-hidden="true" tabindex="-1"></a>proportions</span>
<span id="cb39-600"><a href="#cb39-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-601"><a href="#cb39-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-602"><a href="#cb39-602" aria-hidden="true" tabindex="-1"></a>It can be clearly seen that people who exercise are less likely to have the heart disease.</span>
<span id="cb39-603"><a href="#cb39-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-604"><a href="#cb39-604" aria-hidden="true" tabindex="-1"></a><span class="fu">#### How is BMI of the individuals affecting the heart disease?</span></span>
<span id="cb39-605"><a href="#cb39-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-606"><a href="#cb39-606" aria-hidden="true" tabindex="-1"></a>We compute the BMI of the individuals from the height and weight information available and segregate them into five standard BMI categories and plot the percentage of people having the heart diseases in the respective categories.</span>
<span id="cb39-607"><a href="#cb39-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-610"><a href="#cb39-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-611"><a href="#cb39-611" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>BMI <span class="ot">&lt;-</span> <span class="fu">round</span>(data<span class="sc">$</span>Weight <span class="sc">/</span> ((data<span class="sc">$</span>Height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>))</span>
<span id="cb39-612"><a href="#cb39-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-613"><a href="#cb39-613" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column for BMI categories</span></span>
<span id="cb39-614"><a href="#cb39-614" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>BMICategory <span class="ot">&lt;-</span> <span class="fu">cut</span>(data<span class="sc">$</span>BMI, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">18.5</span>, <span class="fl">24.9</span>, <span class="fl">29.9</span>, <span class="fl">34.9</span>, <span class="fl">39.9</span>, <span class="cn">Inf</span>),</span>
<span id="cb39-615"><a href="#cb39-615" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Underweight"</span>, <span class="st">"Normal weight"</span>, <span class="st">"Overweight"</span>, <span class="st">"Obesity (Class I)"</span>,</span>
<span id="cb39-616"><a href="#cb39-616" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Obesity (Class II)"</span>, <span class="st">"Obesity (Class III)"</span>))</span>
<span id="cb39-617"><a href="#cb39-617" aria-hidden="true" tabindex="-1"></a>BMICategoryHeartDisease <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(BMICategory,HeartDisease)</span>
<span id="cb39-618"><a href="#cb39-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-619"><a href="#cb39-619" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of people with heart disease for each BMI category</span></span>
<span id="cb39-620"><a href="#cb39-620" aria-hidden="true" tabindex="-1"></a>percent <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(HeartDisease <span class="sc">~</span> BMICategory, BMICategoryHeartDisease, <span class="cf">function</span>(x) <span class="fu">mean</span>(x <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb39-621"><a href="#cb39-621" aria-hidden="true" tabindex="-1"></a>percent</span>
<span id="cb39-622"><a href="#cb39-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-623"><a href="#cb39-623" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot using ggplot2</span></span>
<span id="cb39-624"><a href="#cb39-624" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(percent, <span class="fu">aes</span>(<span class="at">x =</span> BMICategory, <span class="at">y =</span> HeartDisease)) <span class="sc">+</span></span>
<span id="cb39-625"><a href="#cb39-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb39-626"><a href="#cb39-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"BMI Category"</span>) <span class="sc">+</span></span>
<span id="cb39-627"><a href="#cb39-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Percentage of People with Heart Disease"</span>) <span class="sc">+</span></span>
<span id="cb39-628"><a href="#cb39-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"lightgray"</span>)) <span class="sc">+</span></span>
<span id="cb39-629"><a href="#cb39-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb39-630"><a href="#cb39-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-631"><a href="#cb39-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-632"><a href="#cb39-632" aria-hidden="true" tabindex="-1"></a>Analyzing the data, it can be observed that the heart disease percentage varies across different BMI categories. The lowest heart disease percentage is associated with the "Normal weight" category, which stands at 6.661403. The "Underweight" category follows closely with a slightly higher heart disease percentage of 8.388409. Moving towards higher BMI categories, the heart disease percentages gradually increase. The "Overweight" category has a percentage of 8.742972, while "Obesity (Class I)" records a higher percentage of 10.245310.</span>
<span id="cb39-633"><a href="#cb39-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-634"><a href="#cb39-634" aria-hidden="true" tabindex="-1"></a>As the BMI categories progress to higher levels of obesity, the heart disease percentages continue to rise. "Obesity (Class II)" displays a percentage of 10.934172, and the highest heart disease percentage is observed in the "Obesity (Class III)" category, standing at 11.441625.</span>
<span id="cb39-635"><a href="#cb39-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-636"><a href="#cb39-636" aria-hidden="true" tabindex="-1"></a>These findings suggest a positive correlation between BMI categories and the likelihood of heart disease. Individuals with higher BMI categories, especially those classified as obese, have a higher risk of developing heart disease. These observations emphasize the importance of maintaining a healthy weight and highlight the potential health risks associated with obesity.</span>
<span id="cb39-637"><a href="#cb39-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-638"><a href="#cb39-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-639"><a href="#cb39-639" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Heart Disease relation with sleep time:</span></span>
<span id="cb39-642"><a href="#cb39-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-643"><a href="#cb39-643" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">select</span>(SleepTime,HeartDisease)</span>
<span id="cb39-644"><a href="#cb39-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-645"><a href="#cb39-645" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate frequency</span></span>
<span id="cb39-646"><a href="#cb39-646" aria-hidden="true" tabindex="-1"></a>frequency <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>SleepTime)</span>
<span id="cb39-647"><a href="#cb39-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-648"><a href="#cb39-648" aria-hidden="true" tabindex="-1"></a><span class="co"># Pie chart</span></span>
<span id="cb39-649"><a href="#cb39-649" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="fu">as.factor</span>(SleepTime))) <span class="sc">+</span></span>
<span id="cb39-650"><a href="#cb39-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb39-651"><a href="#cb39-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb39-652"><a href="#cb39-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Sleep Time"</span>, <span class="at">title =</span> <span class="st">"Pie Chart of Sleep Time"</span>) <span class="sc">+</span></span>
<span id="cb39-653"><a href="#cb39-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">"Sleep Time"</span>) <span class="sc">+</span></span>
<span id="cb39-654"><a href="#cb39-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb39-655"><a href="#cb39-655" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a)</span>
<span id="cb39-656"><a href="#cb39-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-657"><a href="#cb39-657" aria-hidden="true" tabindex="-1"></a>filtered <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-658"><a href="#cb39-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SleepTime,HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb39-659"><a href="#cb39-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SleepTime<span class="sc">&gt;</span><span class="dv">2</span> <span class="sc">&amp;</span> SleepTime<span class="sc">&lt;</span><span class="dv">13</span>) </span>
<span id="cb39-660"><a href="#cb39-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-661"><a href="#cb39-661" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of people with heart disease for each sleep time</span></span>
<span id="cb39-662"><a href="#cb39-662" aria-hidden="true" tabindex="-1"></a>percentage <span class="ot">&lt;-</span> filtered <span class="sc">%&gt;%</span></span>
<span id="cb39-663"><a href="#cb39-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SleepTime) <span class="sc">%&gt;%</span></span>
<span id="cb39-664"><a href="#cb39-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">HeartDiseasePercentage =</span> <span class="fu">sum</span>(HeartDisease <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">/</span> <span class="fu">n</span>() <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb39-665"><a href="#cb39-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-666"><a href="#cb39-666" aria-hidden="true" tabindex="-1"></a>percentage</span>
<span id="cb39-667"><a href="#cb39-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-668"><a href="#cb39-668" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb39-669"><a href="#cb39-669" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(percentage, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(SleepTime), <span class="at">y =</span> HeartDiseasePercentage)) <span class="sc">+</span></span>
<span id="cb39-670"><a href="#cb39-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb39-671"><a href="#cb39-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sleep Time"</span>, <span class="at">y =</span> <span class="st">"Percentage of People with Heart Disease"</span>,</span>
<span id="cb39-672"><a href="#cb39-672" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Percentage of People with Heart Disease by Sleep Time"</span>) <span class="sc">+</span></span>
<span id="cb39-673"><a href="#cb39-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-674"><a href="#cb39-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">drop =</span> <span class="cn">FALSE</span>)  <span class="co"># To include all sleep times on the x-axis</span></span>
<span id="cb39-675"><a href="#cb39-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-676"><a href="#cb39-676" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb39-677"><a href="#cb39-677" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot)</span>
<span id="cb39-678"><a href="#cb39-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-679"><a href="#cb39-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-680"><a href="#cb39-680" aria-hidden="true" tabindex="-1"></a>Upon analyzing the data, it can be observed that individuals who sleep for shorter durations tend to have higher percentages of heart disease. For instance, those who sleep for 3 or 4 hours have a relatively higher percentage of heart disease at 17.07% and 15.36%, respectively. As sleep duration increases to 5, 6, and 7 hours, the percentage of heart disease decreases to 10.52%, 8.11%, and 6.41%, respectively. The trend continues, with the lowest percentage of heart disease observed at 7 hours of sleep. However, as sleep time increases beyond 7 hours, the percentage of heart disease starts to rise again, reaching its peak at 12 hours with 18.38%. This dataset suggests a potential association between sleep duration and the prevalence of heart disease, with an optimal sleep duration of around 7 hours for maintaining heart health.</span>
<span id="cb39-681"><a href="#cb39-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-682"><a href="#cb39-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-683"><a href="#cb39-683" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analyzing the most vulnerable population</span></span>
<span id="cb39-684"><a href="#cb39-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-685"><a href="#cb39-685" aria-hidden="true" tabindex="-1"></a>From the above analysis we can suspect that the most vulnerable population has the following characteristics:</span>
<span id="cb39-686"><a href="#cb39-686" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Male</span>
<span id="cb39-687"><a href="#cb39-687" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Older</span>
<span id="cb39-688"><a href="#cb39-688" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Smoke</span>
<span id="cb39-689"><a href="#cb39-689" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Bad sleeping habits</span>
<span id="cb39-690"><a href="#cb39-690" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>High BMI</span>
<span id="cb39-691"><a href="#cb39-691" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>No Exercise</span>
<span id="cb39-692"><a href="#cb39-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-693"><a href="#cb39-693" aria-hidden="true" tabindex="-1"></a>Let us see what percentage of people with these characteristics have heart disease.</span>
<span id="cb39-694"><a href="#cb39-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-697"><a href="#cb39-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-698"><a href="#cb39-698" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-699"><a href="#cb39-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex<span class="sc">==</span><span class="st">"Male"</span> <span class="sc">&amp;</span> Veteran <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> (SleepTime<span class="sc">&gt;</span><span class="dv">9</span> <span class="sc">|</span> SleepTime<span class="sc">&lt;</span><span class="dv">6</span>) <span class="sc">&amp;</span> Smoke <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> BMI<span class="sc">&gt;</span><span class="dv">30</span> <span class="sc">&amp;</span> Age<span class="sc">&gt;</span><span class="dv">60</span> <span class="sc">&amp;</span> Exercise <span class="sc">==</span> <span class="st">"No"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-700"><a href="#cb39-700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(HeartDisease)</span>
<span id="cb39-701"><a href="#cb39-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-702"><a href="#cb39-702" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of heart disease</span></span>
<span id="cb39-703"><a href="#cb39-703" aria-hidden="true" tabindex="-1"></a>original_percentage <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb39-704"><a href="#cb39-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb39-705"><a href="#cb39-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">HeartDiseasePercentage =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(filtered_data) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb39-706"><a href="#cb39-706" aria-hidden="true" tabindex="-1"></a>original_percentage</span>
<span id="cb39-707"><a href="#cb39-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-708"><a href="#cb39-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-709"><a href="#cb39-709" aria-hidden="true" tabindex="-1"></a>A whopping 38 % of the people with above characteristics have the disease.</span>
<span id="cb39-710"><a href="#cb39-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-711"><a href="#cb39-711" aria-hidden="true" tabindex="-1"></a>Let us now analyze the benefit of giving up bad habits for these population:</span>
<span id="cb39-712"><a href="#cb39-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-713"><a href="#cb39-713" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 1. Exercise and Reduce the BMI below the Obesity levels</span></span>
<span id="cb39-716"><a href="#cb39-716" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-717"><a href="#cb39-717" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-718"><a href="#cb39-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex<span class="sc">==</span><span class="st">"Male"</span> <span class="sc">&amp;</span> Veteran <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> (SleepTime<span class="sc">&gt;</span><span class="dv">9</span> <span class="sc">|</span> SleepTime<span class="sc">&lt;</span><span class="dv">6</span>) <span class="sc">&amp;</span> Smoke <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> BMI<span class="sc">&lt;</span><span class="dv">30</span> <span class="sc">&amp;</span> Age<span class="sc">&gt;</span><span class="dv">60</span> <span class="sc">&amp;</span> Exercise <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-719"><a href="#cb39-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(HeartDisease)</span>
<span id="cb39-720"><a href="#cb39-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-721"><a href="#cb39-721" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(filtered_data)</span>
<span id="cb39-722"><a href="#cb39-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-723"><a href="#cb39-723" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of heart disease</span></span>
<span id="cb39-724"><a href="#cb39-724" aria-hidden="true" tabindex="-1"></a>percentage <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb39-725"><a href="#cb39-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb39-726"><a href="#cb39-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">HeartDiseasePercentage =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(filtered_data) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb39-727"><a href="#cb39-727" aria-hidden="true" tabindex="-1"></a>percentage</span>
<span id="cb39-728"><a href="#cb39-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-729"><a href="#cb39-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-730"><a href="#cb39-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-731"><a href="#cb39-731" aria-hidden="true" tabindex="-1"></a>Exercising and getting the BMI below 30 has reduced the probability of having the heart disease by over 10%.</span>
<span id="cb39-732"><a href="#cb39-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-733"><a href="#cb39-733" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2. Having the right amount of sleep</span></span>
<span id="cb39-734"><a href="#cb39-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-737"><a href="#cb39-737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-738"><a href="#cb39-738" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-739"><a href="#cb39-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex<span class="sc">==</span><span class="st">"Male"</span> <span class="sc">&amp;</span> Veteran <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> (SleepTime<span class="sc">&gt;=</span><span class="dv">6</span> <span class="sc">&amp;</span> SleepTime<span class="sc">&lt;=</span><span class="dv">9</span>) <span class="sc">&amp;</span> Smoke <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> BMI<span class="sc">&lt;</span><span class="dv">30</span> <span class="sc">&amp;</span> Age<span class="sc">&gt;</span><span class="dv">60</span> <span class="sc">&amp;</span> Exercise <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-740"><a href="#cb39-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(HeartDisease)</span>
<span id="cb39-741"><a href="#cb39-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-742"><a href="#cb39-742" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(filtered_data)</span>
<span id="cb39-743"><a href="#cb39-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-744"><a href="#cb39-744" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of heart disease</span></span>
<span id="cb39-745"><a href="#cb39-745" aria-hidden="true" tabindex="-1"></a>percentage <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb39-746"><a href="#cb39-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb39-747"><a href="#cb39-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">HeartDiseasePercentage =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(filtered_data) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb39-748"><a href="#cb39-748" aria-hidden="true" tabindex="-1"></a>percentage</span>
<span id="cb39-749"><a href="#cb39-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-750"><a href="#cb39-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-751"><a href="#cb39-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-752"><a href="#cb39-752" aria-hidden="true" tabindex="-1"></a>Sleeping for 6-9 hours a day reduces the heart disease probability of the vulnerable population further by around 4 percent.</span>
<span id="cb39-753"><a href="#cb39-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-754"><a href="#cb39-754" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2. No Smoking</span></span>
<span id="cb39-755"><a href="#cb39-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-758"><a href="#cb39-758" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-759"><a href="#cb39-759" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb39-760"><a href="#cb39-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex<span class="sc">==</span><span class="st">"Male"</span> <span class="sc">&amp;</span> Veteran <span class="sc">==</span> <span class="st">"Yes"</span> <span class="sc">&amp;</span> (SleepTime<span class="sc">&gt;=</span><span class="dv">6</span> <span class="sc">&amp;</span> SleepTime<span class="sc">&lt;=</span><span class="dv">9</span>) <span class="sc">&amp;</span> Smoke <span class="sc">==</span> <span class="st">"No"</span> <span class="sc">&amp;</span> BMI<span class="sc">&lt;</span><span class="dv">30</span> <span class="sc">&amp;</span> Age<span class="sc">&gt;</span><span class="dv">60</span> <span class="sc">&amp;</span> Exercise <span class="sc">==</span> <span class="st">"Yes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-761"><a href="#cb39-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(HeartDisease)</span>
<span id="cb39-762"><a href="#cb39-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-763"><a href="#cb39-763" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(filtered_data)</span>
<span id="cb39-764"><a href="#cb39-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-765"><a href="#cb39-765" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the percentage of heart disease</span></span>
<span id="cb39-766"><a href="#cb39-766" aria-hidden="true" tabindex="-1"></a>percentage <span class="ot">&lt;-</span> filtered_data <span class="sc">%&gt;%</span></span>
<span id="cb39-767"><a href="#cb39-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(HeartDisease) <span class="sc">%&gt;%</span></span>
<span id="cb39-768"><a href="#cb39-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">HeartDiseasePercentage =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(filtered_data) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb39-769"><a href="#cb39-769" aria-hidden="true" tabindex="-1"></a>percentage</span>
<span id="cb39-770"><a href="#cb39-770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-771"><a href="#cb39-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-772"><a href="#cb39-772" aria-hidden="true" tabindex="-1"></a>The people who do not smoke in these population have over 6 percent less chance of heart disease.</span>
<span id="cb39-773"><a href="#cb39-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-774"><a href="#cb39-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-775"><a href="#cb39-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-778"><a href="#cb39-778" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-779"><a href="#cb39-779" aria-hidden="true" tabindex="-1"></a>plot_heart_disease_percent <span class="ot">&lt;-</span> <span class="cf">function</span>(percentage, title_str){</span>
<span id="cb39-780"><a href="#cb39-780" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(percentage, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> HeartDiseasePercentage, <span class="at">fill =</span> HeartDisease)) <span class="sc">+</span></span>
<span id="cb39-781"><a href="#cb39-781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb39-782"><a href="#cb39-782" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb39-783"><a href="#cb39-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Heart Disease"</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">title =</span> title_str) <span class="sc">+</span></span>
<span id="cb39-784"><a href="#cb39-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb39-785"><a href="#cb39-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb39-786"><a href="#cb39-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(HeartDiseasePercentage,<span class="dv">2</span>), <span class="st">"%"</span>)), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb39-787"><a href="#cb39-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plot)</span>
<span id="cb39-788"><a href="#cb39-788" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-789"><a href="#cb39-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-790"><a href="#cb39-790" aria-hidden="true" tabindex="-1"></a>orig <span class="ot">=</span> <span class="fu">plot_heart_disease_percent</span>(original_percentage,<span class="st">"Probability of heart disease"</span>)</span>
<span id="cb39-791"><a href="#cb39-791" aria-hidden="true" tabindex="-1"></a>new  <span class="ot">=</span> <span class="fu">plot_heart_disease_percent</span>(percentage, <span class="st">"Probability with suggestions"</span>)</span>
<span id="cb39-792"><a href="#cb39-792" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(orig, new)</span>
<span id="cb39-793"><a href="#cb39-793" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb39-794"><a href="#cb39-794" aria-hidden="true" tabindex="-1"></a>Overall with the above three changes in the lifestyle, our vulnerable population can actually reduce the risk of heart disease by more than 20%.</span>
<span id="cb39-795"><a href="#cb39-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-796"><a href="#cb39-796" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 4 : Conclusion</span></span>
<span id="cb39-797"><a href="#cb39-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-798"><a href="#cb39-798" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>When it comes to the heart disease, males are more susceptible than females. Males are 57% more likely to get effected as compare to females.</span>
<span id="cb39-799"><a href="#cb39-799" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>The age of a person is also a very important factor of being affected by the heart disease. Older people(&gt;65 years) are more than 10 times prone to the heart disease as compared to young people(25 years)</span>
<span id="cb39-800"><a href="#cb39-800" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>We can also conclude that people with High BMI(higher than Obese category) are also more likely to get  heart disease than people with low BMI.</span>
<span id="cb39-801"><a href="#cb39-801" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Veterans are affected by the heart disease twice as compare to the non-veterans, there could be multiple reasons for this such as stress.</span>
<span id="cb39-802"><a href="#cb39-802" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Similarly people who smoke are twice as likely to get affected by heart disease.</span>
<span id="cb39-803"><a href="#cb39-803" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>People who exercise and have the right amount of sleep are also less likely to get a heart disease.</span>
<span id="cb39-804"><a href="#cb39-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-805"><a href="#cb39-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-806"><a href="#cb39-806" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>Therefore the old male veterans who smoke, do not exercise and do not get a proper sleep are the most at risk population. Our analysis showed that around 40% of the people belonging to this category has the heart disease.</span>
<span id="cb39-807"><a href="#cb39-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-808"><a href="#cb39-808" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>We have also shown that by following lifestyle changes such as exercising, appropriate sleep, reducing the BMI can drastically reduce the risk for this population.</span>
<span id="cb39-809"><a href="#cb39-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-810"><a href="#cb39-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-811"><a href="#cb39-811" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 5 : Bibliography</span></span>
<span id="cb39-812"><a href="#cb39-812" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>R: A language and environment for statistical computing. - https://www.R-project.org/</span>
<span id="cb39-813"><a href="#cb39-813" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>R Studio IDE. - https://posit.co/products/open-source/rstudio/</span>
<span id="cb39-814"><a href="#cb39-814" aria-hidden="true" tabindex="-1"></a><span class="ss">*   </span>CDC - BRFSS - https://www.cdc.gov/brfss/index.html</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>