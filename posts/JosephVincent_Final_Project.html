<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.427">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Joseph Vincent">
<meta name="dcterms.date" content="2023-05-18">
<meta name="description" content="Comparing Air Quality to Death Trends in California, 2000-2010">

<title>Final Project - Air Quality and Deaths</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="Final Project - Air Quality and Deaths">
<meta name="twitter:description" content="Comparing Air Quality to Death Trends in California, 2000-2010">
<meta name="twitter:image" content="https://dacss.github.io/601_Spring_2023/posts/JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/DACSS" rel="" target="">
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#part-1.-introduction" id="toc-part-1.-introduction" class="nav-link active" data-scroll-target="#part-1.-introduction">Part 1. Introduction</a>
  <ul class="collapse">
  <li><a href="#abstract" id="toc-abstract" class="nav-link" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#data-introduction" id="toc-data-introduction" class="nav-link" data-scroll-target="#data-introduction">Data Introduction</a></li>
  </ul></li>
  <li><a href="#part-2.-data-description" id="toc-part-2.-data-description" class="nav-link" data-scroll-target="#part-2.-data-description">Part 2. Data Description</a>
  <ul class="collapse">
  <li><a href="#reading-mutating-and-combining-data" id="toc-reading-mutating-and-combining-data" class="nav-link" data-scroll-target="#reading-mutating-and-combining-data">Reading, mutating, and combining data</a></li>
  <li><a href="#mutation-and-na-replacement" id="toc-mutation-and-na-replacement" class="nav-link" data-scroll-target="#mutation-and-na-replacement">Mutation and NA replacement</a></li>
  </ul></li>
  <li><a href="#analysis-plan" id="toc-analysis-plan" class="nav-link" data-scroll-target="#analysis-plan">Analysis Plan</a>
  <ul class="collapse">
  <li><a href="#summary-and-descriptive-visualizations" id="toc-summary-and-descriptive-visualizations" class="nav-link" data-scroll-target="#summary-and-descriptive-visualizations">Summary and Descriptive Visualizations</a></li>
  <li><a href="#analysis-of-air-qualitys-affect-on-deaths" id="toc-analysis-of-air-qualitys-affect-on-deaths" class="nav-link" data-scroll-target="#analysis-of-air-qualitys-affect-on-deaths">Analysis of Air Quality’s Affect on Deaths</a></li>
  <li><a href="#intra-county-exploration" id="toc-intra-county-exploration" class="nav-link" data-scroll-target="#intra-county-exploration">Intra-county Exploration</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography">Bibliography</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project - Air Quality and Deaths</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">final_project</div>
    <div class="quarto-category">Joseph Vincent</div>
  </div>
  </div>

<div>
  <div class="description">
    Comparing Air Quality to Death Trends in California, 2000-2010
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Joseph Vincent </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 18, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtable)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapproj)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(egg)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="part-1.-introduction" class="level2">
<h2 class="anchored" data-anchor-id="part-1.-introduction">Part 1. Introduction</h2>
<section id="abstract" class="level3">
<h3 class="anchored" data-anchor-id="abstract">Abstract</h3>
<p>Poor air quality has been shown to have a massively negative impact on human health. In particular, air pollution is known to worsen pulmonary and cardiovascular diseases [1]. Just In the past few weeks, researchers out of Boston University showed that air pollution caused by oil and gas production in the US resulted in over <strong>7500 excess deaths and $77 billion in total health impacts in a <em>single year</em> [2].</strong></p>
<p><strong>The goal of my project is to assess whether there is a visual relationship between air quality trends and related causes of death in California for the decade of 2000-2010.</strong> My analysis does not attempt to make statistically significant claims about excess deaths or economic impacts, but rather looks at visual trends on a high level to see if the impact is noticeable. <strong>My findings are that, at both state-wide and intra-county levels, changes in air quality (particularly PM2.5 levels) and deaths per 100,000 seem to follow similar trends.</strong></p>
</section>
<section id="data-introduction" class="level3">
<h3 class="anchored" data-anchor-id="data-introduction">Data Introduction</h3>
<p>My data comes from three primary sources:</p>
<ol type="1">
<li><strong>Air quality</strong></li>
</ol>
<p><a href="https://data.cdc.gov/Environmental-Health-Toxicology/Air-Quality-Measures-on-the-National-Environmental/cjae-szjv">SOURCE</a> [3]</p>
<p>I’m using the CDC’s database for Air Quality Measures on the National Environmental Health Tracking Network. The most recent and complete historic data available contains per-county data on air quality between the years of 1999 and 2013, inclusive.</p>
<p>This data is collected by the Environmental Protection Agency’s network of more than 4,000 outdoor ambient air monitoring systems around the US, called the Air Quality System (AQS).</p>
<p>These systems collect two main types of data:</p>
<ul>
<li><strong>Ozone Concentrations</strong></li>
</ul>
<p>High concentrations of Ozone near the ground level can be harmful, causing irritation to the respiratory system and aggravating a variety of chronic lung diseases. This is often referred to as “smog” and is produced by things like car emissions and power plants.</p>
<ul>
<li><strong>Fine Particulate Matter (PM2.5) Concentrations</strong></li>
</ul>
<p>This refers to tiny particulate matter in the air measuring two and a half microns or less in width that originates from a variety of pollutants. Exposure to PM2.5 particles can cause both short and long term health effects. PM2.5 sources include wildfires and fossil fuel combustion.</p>
<p>While this data is of high quality, it is lacking in rural areas where monitors are not present. To account for this, the CDC and EPA developed statistical models to fill in gaps in data across regions and time. This allows for granular analysis of county air quality data.</p>
<p><strong>Two important concepts used in my analysis are Ozone Days and PM2.5 Days.</strong></p>
<p><em>A measure of “Ozone Days” for a particular county-year represents the number of days with the maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard (NAAQS).</em></p>
<p><em>A measure of “PM2.5 Days” for a particular county-year represents the number of days with PM2.5 levels over the NAAQS.</em></p>
<p>In both cases, information about true severity of concentrations is not available, only the number of days above the standard.</p>
<ol start="2" type="1">
<li><strong>Deaths by Cause</strong></li>
</ol>
<p><a href="https://data.chhs.ca.gov/dataset/death-profiles-by-county/resource/e692e6a1-bddd-48ab-a0c8-fa0f1f43e9f4?i%20nner_span=True">SOURCE</a> [4]</p>
<p>In order to draw conclusions about air quality’s immediate impact on public health, I’m combining my air quality data with a dataset from the state of California’s Department of Health and Human Services (HHS) on annual number of deaths by county, including primary cause of death. This data also spans the years 1999-2013, but I will be using 2000-2010.</p>
<p>While the data includes a wide variety of causes, for my analysis I will be focusing on <strong>total deaths (ALL), chronic lower respiratory disease (CLD), and diseases of the heart (HTD)</strong>, as these are the main relevant categories for air quality health impacts.</p>
<ol start="3" type="1">
<li><strong>Population</strong></li>
</ol>
<p><a href="https://www.census.gov/data/tables/time-series/demo/popest/intercensal-2000-2010-counties.html">SOURCE</a> [5]</p>
<p>Finally, I’m also using per-county population data from the United States Census Bureau. While there are census packages out there for easy use within R, I required annual data by county, which only exists from 2005 onwards in most datasets. I’m instead using the County Intercensal Tables 2000-2010 for the state of California.</p>
</section>
</section>
<section id="part-2.-data-description" class="level2">
<h2 class="anchored" data-anchor-id="part-2.-data-description">Part 2. Data Description</h2>
<section id="reading-mutating-and-combining-data" class="level3">
<h3 class="anchored" data-anchor-id="reading-mutating-and-combining-data">Reading, mutating, and combining data</h3>
<p>Below I have provided a head sample of the three data sets.</p>
<p>The air quality data consists of measures of both ozone and PM2.5. Ozone levels are measured by number of days with higher than average Ozone levels, and also person-days by county by multiplying by the population for that year. PM2.5 levels are lacking raw number of days, but are recorded in percent of days, person days, and the annual average level for that county-year. I will be converting this to PM2.5 days (count) for my analysis.</p>
<p><strong>Each row of the air quality data represents a specific air quality measure for a county-year.</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reading in air quality data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>airquality <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"JosephVincent_FinalProjectData/Air_Quality_Measures_on_the_National_Environmental_Health_Tracking_Network.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["MeasureId"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["MeasureName"],"name":[2],"type":["chr"],"align":["left"]},{"label":["MeasureType"],"name":[3],"type":["chr"],"align":["left"]},{"label":["StratificationLevel"],"name":[4],"type":["chr"],"align":["left"]},{"label":["StateFips"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["StateName"],"name":[6],"type":["chr"],"align":["left"]},{"label":["CountyFips"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["CountyName"],"name":[8],"type":["chr"],"align":["left"]},{"label":["ReportYear"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Value"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Unit"],"name":[11],"type":["chr"],"align":["left"]},{"label":["UnitName"],"name":[12],"type":["chr"],"align":["left"]},{"label":["DataOrigin"],"name":[13],"type":["chr"],"align":["left"]},{"label":["MonitorOnly"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"83","2":"Number of days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard","3":"Counts","4":"State x County","5":"1","6":"Alabama","7":"1027","8":"Clay","9":"1999","10":"33","11":"No Units","12":"No Units","13":"Monitor Only","14":"1"},{"1":"83","2":"Number of days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard","3":"Counts","4":"State x County","5":"1","6":"Alabama","7":"1051","8":"Elmore","9":"1999","10":"5","11":"No Units","12":"No Units","13":"Monitor Only","14":"1"},{"1":"83","2":"Number of days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard","3":"Counts","4":"State x County","5":"1","6":"Alabama","7":"1073","8":"Jefferson","9":"1999","10":"39","11":"No Units","12":"No Units","13":"Monitor Only","14":"1"},{"1":"83","2":"Number of days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard","3":"Counts","4":"State x County","5":"1","6":"Alabama","7":"1079","8":"Lawrence","9":"1999","10":"28","11":"No Units","12":"No Units","13":"Monitor Only","14":"1"},{"1":"83","2":"Number of days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard","3":"Counts","4":"State x County","5":"1","6":"Alabama","7":"1089","8":"Madison","9":"1999","10":"31","11":"No Units","12":"No Units","13":"Monitor Only","14":"1"},{"1":"83","2":"Number of days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard","3":"Counts","4":"State x County","5":"1","6":"Alabama","7":"1097","8":"Mobile","9":"1999","10":"32","11":"No Units","12":"No Units","13":"Monitor Only","14":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 218635     14</code></pre>
</div>
</div>
<p><strong>As for the death data, each row contains a count of deaths in the “value” column for a county, year, stratification (demographically) and cause of death.</strong> This results in many rows for a given county-year.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reading in deaths dataset</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>calideaths <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"JosephVincent_FinalProjectData/2021-05-14_deaths_final_1999_2013_county_year_sup.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filtering for occurrence deaths (i.e. all deaths that occurred, disregarding residence)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Geography_Type <span class="sc">==</span> <span class="st">"Occurrence"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#de-selecting geography type as they are now all occurrence</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Geography_Type)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(calideaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Year"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["County"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Strata"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Strata_Name"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Cause"],"name":[5],"type":["chr"],"align":["left"]},{"label":["Cause_Desc"],"name":[6],"type":["chr"],"align":["left"]},{"label":["Count"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Annotation_Code"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Annotation_Desc"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"1999","2":"Alameda","3":"Total Population","4":"Total Population","5":"ALL","6":"All causes (total)","7":"9738","8":"NA","9":"NA"},{"1":"1999","2":"Alameda","3":"Age","4":"Under 1 year","5":"ALL","6":"All causes (total)","7":"136","8":"NA","9":"NA"},{"1":"1999","2":"Alameda","3":"Age","4":"1-4 years","5":"ALL","6":"All causes (total)","7":"29","8":"NA","9":"NA"},{"1":"1999","2":"Alameda","3":"Age","4":"5-14 years","5":"ALL","6":"All causes (total)","7":"38","8":"NA","9":"NA"},{"1":"1999","2":"Alameda","3":"Age","4":"15-24 years","5":"ALL","6":"All causes (total)","7":"114","8":"NA","9":"NA"},{"1":"1999","2":"Alameda","3":"Age","4":"25-34 years","5":"ALL","6":"All causes (total)","7":"183","8":"NA","9":"NA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(calideaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 146160      9</code></pre>
</div>
</div>
<p><strong>The population data consists of rows that each represent a US county.</strong> The population estimates by year are listed in separate columns in a wide format.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reading in population data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>populations <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"JosephVincent_FinalProjectData/co-est00int-tot.csv"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(populations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["SUMLEV"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["REGION"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["DIVISION"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["STATE"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["COUNTY"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["STNAME"],"name":[6],"type":["chr"],"align":["left"]},{"label":["CTYNAME"],"name":[7],"type":["chr"],"align":["left"]},{"label":["ESTIMATESBASE2000"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["POPESTIMATE2000"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["POPESTIMATE2001"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["POPESTIMATE2002"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["POPESTIMATE2003"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["POPESTIMATE2004"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["POPESTIMATE2005"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["POPESTIMATE2006"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["POPESTIMATE2007"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["POPESTIMATE2008"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["POPESTIMATE2009"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["CENSUS2010POP"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["POPESTIMATE2010"],"name":[20],"type":["dbl"],"align":["right"]}],"data":[{"1":"40","2":"3","3":"6","4":"1","5":"0","6":"Alabama","7":"Alabama","8":"4447207","9":"4452173","10":"4467634","11":"4480089","12":"4503491","13":"4530729","14":"4569805","15":"4628981","16":"4672840","17":"4718206","18":"4757938","19":"4779736","20":"4785298"},{"1":"50","2":"3","3":"6","4":"1","5":"1","6":"Alabama","7":"Autauga County","8":"43751","9":"44021","10":"44889","11":"45909","12":"46800","13":"48366","14":"49676","15":"51328","16":"52405","17":"53277","18":"54135","19":"54571","20":"54632"},{"1":"50","2":"3","3":"6","4":"1","5":"3","6":"Alabama","7":"Baldwin County","8":"140416","9":"141342","10":"144875","11":"147957","12":"151509","13":"156266","14":"162183","15":"168121","16":"172404","17":"175827","18":"179406","19":"182265","20":"183195"},{"1":"50","2":"3","3":"6","4":"1","5":"5","6":"Alabama","7":"Barbour County","8":"29042","9":"29015","10":"28863","11":"28653","12":"28594","13":"28287","14":"28027","15":"27861","16":"27757","17":"27808","18":"27657","19":"27457","20":"27411"},{"1":"50","2":"3","3":"6","4":"1","5":"7","6":"Alabama","7":"Bibb County","8":"19856","9":"19913","10":"21028","11":"21199","12":"21399","13":"21721","14":"22042","15":"22099","16":"22438","17":"22705","18":"22941","19":"22915","20":"22867"},{"1":"50","2":"3","3":"6","4":"1","5":"9","6":"Alabama","7":"Blount County","8":"50982","9":"51107","10":"51845","11":"52551","12":"53457","13":"54124","14":"54624","15":"55485","16":"56240","17":"57055","18":"57341","19":"57322","20":"57338"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(populations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3194   20</code></pre>
</div>
</div>
<p>My goal is to combine these data sets into the “deaths data” format, having each case represent a county, year, stratification and cause. I will combine the air quality measures as individual columns onto this data.</p>
<p>These can be pivoted longer as needed for visualization, but are easier kept seperately for visualizing the data set. Below, I’ve filtered the air quality data for California, then pivoted wider so that the air quality measures each are represented in a column.</p>
<p>One thing worth mentioning is that the air quality data consists of both “monitored” values and “modeled” values. As described on the CDC’s website, the CDC and EPA collaborated to develop statistical models for filling in missing data in regions without data. For my analysis, I will be using the modeled data to allow me to look at counties that would otherwise be missing data. You can see these mutations below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>airqualitycali <span class="ot">&lt;-</span> airquality <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#arranging by year</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="st">`</span><span class="at">ReportYear</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filtering for california only and 2000-2010</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(StateName <span class="sc">==</span> <span class="st">"California"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">ReportYear</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#selecting only relevant columns</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CountyName, ReportYear, MeasureName, Value) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#renaming county and year to be consistent with deaths dataset</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"County"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">CountyName</span><span class="st">`</span>, <span class="st">"Year"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">ReportYear</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pivoting so that each row is a year-county for merging data</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> MeasureName, <span class="at">values_from =</span> Value) <span class="sc">%&gt;%</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#renaming Air Quality columns</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Ozone Days Delete"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Number of days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard</span><span class="st">`</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Ozone Person Days Delete"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Number of person-days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard</span><span class="st">`</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Percent of Days Delete"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent of days with PM2.5 levels over the National Ambient Air Quality Standard (NAAQS)</span><span class="st">`</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Person Days Delete"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Person-days with PM2.5 over the National Ambient Air Quality Standard</span><span class="st">`</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Annual Average Delete"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Annual average ambient concentrations of PM2.5 in micrograms per cubic meter (based on seasonal averages and daily measurement)</span><span class="st">`</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Ozone Days"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Number of days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard (monitor and modeled data)</span><span class="st">`</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Ozone Person Days"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Number of person-days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard (monitor and modeled data)</span><span class="st">`</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Percent of Days"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent of days with PM2.5 levels over the National Ambient Air Quality Standard (monitor and modeled data)</span><span class="st">`</span>,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Person Days"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Number of person-days with PM2.5 over the National Ambient Air Quality Standard (monitor and modeled data)</span><span class="st">`</span>,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Annual Average"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Annual average ambient concentrations of PM 2.5 in micrograms per cubic meter, based on seasonal averages and daily measurement (monitor and modeled data)</span><span class="st">`</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">#filling in modeled data for first year, where there is no modeled data</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>airqualitycali <span class="ot">&lt;-</span> airqualitycali <span class="sc">%&gt;%</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Ozone Days Delete</span><span class="st">`</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Ozone Person Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Ozone Person Days Delete</span><span class="st">`</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="st">`</span><span class="at">Ozone Person Days</span><span class="st">`</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">2000</span>  <span class="sc">~</span> <span class="st">`</span><span class="at">PM2.5 Percent of Days Delete</span><span class="st">`</span>,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PM2.5 Person Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="st">`</span><span class="at">PM2.5 Person Days Delete</span><span class="st">`</span>,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="st">`</span><span class="at">PM2.5 Person Days</span><span class="st">`</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PM2.5 Annual Average</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="st">`</span><span class="at">PM2.5 Annual Average Delete</span><span class="st">`</span>,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="st">`</span><span class="at">PM2.5 Annual Average</span><span class="st">`</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">"Delete"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For prepping the deaths data, I’ve filtered for only the causes of death I believe may be relevant to air quality (ALL, CLD, and HTD).</p>
<p>Also, I’ve filled in some NA cells as 0 which were coded as “suppressed for small numbers”. These only apply when a specific stratification variable (i.e.&nbsp;race) has extremely low values for a county, and will likely not have any affect on my analysis, which I plan to mostly use the Total Population stratification.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>calideathsclean <span class="ot">&lt;-</span> calideaths <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filtering for 2000-2010</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filling in suppressed data</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Count =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    Annotation_Code <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Count)))) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#de-selecting some unused columns</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Cause_Desc, <span class="sc">-</span>Annotation_Code, <span class="sc">-</span>Annotation_Desc) <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#focusing on relevant conditions</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cause <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ALL"</span>, <span class="st">"CLD"</span>, <span class="st">"HTD"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Deaths"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Count</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Strata Name"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Strata_Name</span><span class="st">`</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(calideathsclean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28072     6</code></pre>
</div>
</div>
<p>The population data needed a small bit of cleaning to pivot the estimates by year into a single column.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>populationstidy <span class="ot">&lt;-</span> populations <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(STNAME <span class="sc">==</span> <span class="st">"California"</span> <span class="sc">&amp;</span> CTYNAME <span class="sc">!=</span> <span class="st">"California"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(CTYNAME, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"County"</span>, <span class="st">"Delete"</span>), <span class="at">sep =</span> <span class="st">" County"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(County, POPESTIMATE2000<span class="sc">:</span>POPESTIMATE2010, <span class="sc">-</span>CENSUS2010POP) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"2000"</span> <span class="ot">=</span> POPESTIMATE2000,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2001"</span> <span class="ot">=</span> POPESTIMATE2001,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2002"</span> <span class="ot">=</span> POPESTIMATE2002,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2003"</span> <span class="ot">=</span> POPESTIMATE2003,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2004"</span> <span class="ot">=</span> POPESTIMATE2004,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2005"</span> <span class="ot">=</span> POPESTIMATE2005,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2006"</span> <span class="ot">=</span> POPESTIMATE2006,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2007"</span> <span class="ot">=</span> POPESTIMATE2007,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2008"</span> <span class="ot">=</span> POPESTIMATE2008,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2009"</span> <span class="ot">=</span> POPESTIMATE2009,</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2010"</span> <span class="ot">=</span> POPESTIMATE2010) <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">col =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">2000</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2010</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(Year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Finally, with the cleaning mostly complete, I’ll combine my data sets. Each time I’ll merge into the deaths data. I’ll expect my final data set to consist of 28,072 rows, which is the size of the original deaths dataset after filtering for 2000-2010. There are a total of 58 unique counties in CA. The populations of these</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#merging data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="ot">&lt;-</span> <span class="fu">left_join</span>(calideathsclean, airqualitycali, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"County"</span>, <span class="st">"Year"</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#merging data</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="ot">&lt;-</span> <span class="fu">left_join</span>(airqualityanddeaths, populationstidy, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"County"</span>, <span class="st">"Year"</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(airqualityanddeaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28072    12</code></pre>
</div>
</div>
</section>
<section id="mutation-and-na-replacement" class="level3">
<h3 class="anchored" data-anchor-id="mutation-and-na-replacement">Mutation and NA replacement</h3>
<p>It’s important to note that for some air quality data in 2000, NA were used for small counties where neither modeled nor monitored data was available. In these cases, I’ve replaced the NAs with 0 days. If not, the smaller, rural counties (with generally great air quality) would skew my averages later on. In checking the data for later years with available monitors, this seems to be a good approach, as days are (or are near to) 0.</p>
<p>I’ve also created a column for Deaths per 100,000 by using the population data I’ve collected. This will allow me to better compare deaths between counties with wildly varying populations. As we’ll see later, this isn’t a perfect fix as counties with small populations have a large varience in deaths per 100,000, but it’s still preferable to the raw counts.</p>
<p>I also have created a “raw” PM2.5 Days column that counts the number of days, instead of a percent.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For the remaining missing air quality data not filled in by models in 2000, replacing NAs with zero, as they are all small rural counties that will skew means higher for 2000</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Ozone Person Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">Ozone Person Days</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">PM2.5 Person Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">PM2.5 Person Days</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">PM2.5 Annual Average</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">PM2.5 Annual Average</span><span class="st">`</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating standardized deaths per 100,000 column</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Deaths per 100,000"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Deaths</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Population</span><span class="st">`</span><span class="sc">*</span><span class="dv">100000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a raw PM2.5 Days column</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"PM2.5 Days"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span><span class="sc">/</span><span class="dv">100</span><span class="sc">*</span><span class="dv">365</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-arranging</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, Population, Strata, <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span>, Cause, Deaths, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Person Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Person Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Annual Average</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Turning Year into a date for ease of plotting time series'</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">make_date</span>(<span class="at">year=</span>Year))</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airqualityanddeaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Year"],"name":[1],"type":["date"],"align":["right"]},{"label":["County"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Population"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Strata"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Strata Name"],"name":[5],"type":["chr"],"align":["left"]},{"label":["Cause"],"name":[6],"type":["chr"],"align":["left"]},{"label":["Deaths"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Deaths per 100,000"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Ozone Days"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Ozone Person Days"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["PM2.5 Days"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["PM2.5 Person Days"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["PM2.5 Percent of Days"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["PM2.5 Annual Average"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"2000-01-01","2":"Alameda","3":"1449840","4":"Total Population","5":"Total Population","6":"ALL","7":"9809","8":"676.557413","9":"4","10":"5799360","11":"26.61458","12":"38586887","13":"7.291667","14":"11.21064"},{"1":"2000-01-01","2":"Alameda","3":"1449840","4":"Age","5":"Under 1 year","6":"ALL","7":"131","8":"9.035480","9":"4","10":"5799360","11":"26.61458","12":"38586887","13":"7.291667","14":"11.21064"},{"1":"2000-01-01","2":"Alameda","3":"1449840","4":"Age","5":"1-4 years","6":"ALL","7":"27","8":"1.862274","9":"4","10":"5799360","11":"26.61458","12":"38586887","13":"7.291667","14":"11.21064"},{"1":"2000-01-01","2":"Alameda","3":"1449840","4":"Age","5":"5-14 years","6":"ALL","7":"32","8":"2.207140","9":"4","10":"5799360","11":"26.61458","12":"38586887","13":"7.291667","14":"11.21064"},{"1":"2000-01-01","2":"Alameda","3":"1449840","4":"Age","5":"15-24 years","6":"ALL","7":"99","8":"6.828340","9":"4","10":"5799360","11":"26.61458","12":"38586887","13":"7.291667","14":"11.21064"},{"1":"2000-01-01","2":"Alameda","3":"1449840","4":"Age","5":"25-34 years","6":"ALL","7":"189","8":"13.035921","9":"4","10":"5799360","11":"26.61458","12":"38586887","13":"7.291667","14":"11.21064"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
<section id="analysis-plan" class="level2">
<h2 class="anchored" data-anchor-id="analysis-plan">Analysis Plan</h2>
<p><strong>The goal of my project is to assess whether there is a visual relationship between air quality trends and related causes of death in California for the decade of 2000-2010.</strong></p>
<p>My plan is as follows:</p>
<p><strong>1) Descriptive Visualizations</strong></p>
<ul>
<li>Describe and summarize both the air quality and death trends data so that we can gain a baseline understanding of each before comparison.</li>
</ul>
<p><strong>2) Statewide Trend Comparison</strong></p>
<ul>
<li><p>Compare overall trends in air quality to deaths per 100,000 by type by taking the means of all counties over the years.</p></li>
<li><p>Plot deaths per 100,000 by type against each air quality measure to see if they correlate.</p></li>
</ul>
<p><strong>3) Intra-county Trend Comparison</strong></p>
<ul>
<li>Compare trends in air quality measures to trends in deaths per 100,000 by type for individual counties of either high or low air quality. This will allow me to reduce variance coming from county differences in hidden variables that could be influencing death rates (i.e.&nbsp;socio-economic variables).</li>
</ul>
<p><em>A quick note that when I refer to the “decade”, I’ve actually included 11 years (2000-2010 inclusive) in my analysis.</em></p>
<section id="summary-and-descriptive-visualizations" class="level3">
<h3 class="anchored" data-anchor-id="summary-and-descriptive-visualizations">Summary and Descriptive Visualizations</h3>
<p>There are 58 counties in California. I’ll begin by describing air quality by county.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(airqualityanddeaths<span class="sc">$</span>County)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Alameda"         "Alpine"          "Amador"          "Butte"          
 [5] "Calaveras"       "Colusa"          "Contra Costa"    "Del Norte"      
 [9] "El Dorado"       "Fresno"          "Glenn"           "Humboldt"       
[13] "Imperial"        "Inyo"            "Kern"            "Kings"          
[17] "Lake"            "Lassen"          "Los Angeles"     "Madera"         
[21] "Marin"           "Mariposa"        "Mendocino"       "Merced"         
[25] "Modoc"           "Mono"            "Monterey"        "Napa"           
[29] "Nevada"          "Orange"          "Placer"          "Plumas"         
[33] "Riverside"       "Sacramento"      "San Benito"      "San Bernardino" 
[37] "San Diego"       "San Francisco"   "San Joaquin"     "San Luis Obispo"
[41] "San Mateo"       "Santa Barbara"   "Santa Clara"     "Santa Cruz"     
[45] "Shasta"          "Sierra"          "Siskiyou"        "Solano"         
[49] "Sonoma"          "Stanislaus"      "Sutter"          "Tehama"         
[53] "Trinity"         "Tulare"          "Tuolumne"        "Ventura"        
[57] "Yolo"            "Yuba"           </code></pre>
</div>
</div>
<p>First, I will map each air quality measure by year, showing the trends across time.</p>
<p>Below, I’ve done some preparation by creating state and county maps using the “maps” package, which includes per county data with longitude and latitude coordinates.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting state data from map data</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"state"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting state data for California only for base map</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>california <span class="ot">&lt;-</span> <span class="fu">subset</span>(states, region <span class="sc">==</span> <span class="st">"california"</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting map data for California County data</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>ca_counties <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">map_data</span>(<span class="st">"county"</span>), region <span class="sc">==</span> <span class="st">"california"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Changing county names to match my existing data</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"County"</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"alameda"</span> <span class="sc">~</span> <span class="st">"Alameda"</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"alpine"</span> <span class="sc">~</span> <span class="st">"Alpine"</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"amador"</span> <span class="sc">~</span> <span class="st">"Amador"</span>,</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"butte"</span> <span class="sc">~</span> <span class="st">"Butte"</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"calaveras"</span> <span class="sc">~</span> <span class="st">"Calaveras"</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"colusa"</span> <span class="sc">~</span> <span class="st">"Colusa"</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"contra costa"</span> <span class="sc">~</span> <span class="st">"Contra Costa"</span>,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"del norte"</span> <span class="sc">~</span> <span class="st">"Del Norte"</span>,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"el dorado"</span> <span class="sc">~</span> <span class="st">"El Dorado"</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"fresno"</span> <span class="sc">~</span> <span class="st">"Fresno"</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"glenn"</span> <span class="sc">~</span> <span class="st">"Glenn"</span>,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"humboldt"</span> <span class="sc">~</span> <span class="st">"Humboldt"</span>,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"imperial"</span> <span class="sc">~</span> <span class="st">"Imperial"</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"inyo"</span> <span class="sc">~</span> <span class="st">"Inyo"</span>,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"kern"</span> <span class="sc">~</span> <span class="st">"Kern"</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"kings"</span> <span class="sc">~</span> <span class="st">"Kings"</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"lake"</span> <span class="sc">~</span> <span class="st">"Lake"</span>,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"lassen"</span> <span class="sc">~</span> <span class="st">"Lassen"</span>,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"los angeles"</span> <span class="sc">~</span> <span class="st">"Los Angeles"</span>,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"madera"</span> <span class="sc">~</span> <span class="st">"Madera"</span>,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"marin"</span> <span class="sc">~</span> <span class="st">"Marin"</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"mariposa"</span> <span class="sc">~</span> <span class="st">"Mariposa"</span>,</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"mendocino"</span> <span class="sc">~</span> <span class="st">"Mendocino"</span>,</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"merced"</span> <span class="sc">~</span> <span class="st">"Merced"</span>,</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"modoc"</span> <span class="sc">~</span> <span class="st">"Modoc"</span>,</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"mono"</span> <span class="sc">~</span> <span class="st">"Mono"</span>,</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"monterey"</span> <span class="sc">~</span> <span class="st">"Monterey"</span>,</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"napa"</span> <span class="sc">~</span> <span class="st">"Napa"</span>,</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"nevada"</span> <span class="sc">~</span> <span class="st">"Nevada"</span>,</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"orange"</span> <span class="sc">~</span> <span class="st">"Orange"</span>,</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"placer"</span> <span class="sc">~</span> <span class="st">"Placer"</span>,</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"plumas"</span> <span class="sc">~</span> <span class="st">"Plumas"</span>,</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"riverside"</span> <span class="sc">~</span> <span class="st">"Riverside"</span>,</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"sacramento"</span> <span class="sc">~</span> <span class="st">"Sacramento"</span>,</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san benito"</span> <span class="sc">~</span> <span class="st">"San Benito"</span>,</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san bernardino"</span> <span class="sc">~</span> <span class="st">"San Bernardino"</span>,</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san diego"</span> <span class="sc">~</span> <span class="st">"San Diego"</span>,</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san francisco"</span> <span class="sc">~</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san joaquin"</span> <span class="sc">~</span> <span class="st">"San Joaquin"</span>,</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san luis obispo"</span> <span class="sc">~</span> <span class="st">"San Luis Obispo"</span>,</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san mateo"</span> <span class="sc">~</span> <span class="st">"San Mateo"</span>,</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"santa barbara"</span> <span class="sc">~</span> <span class="st">"Santa Barbara"</span>,</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"santa clara"</span> <span class="sc">~</span> <span class="st">"Santa Clara"</span>,</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"santa cruz"</span> <span class="sc">~</span> <span class="st">"Santa Cruz"</span>,</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"shasta"</span> <span class="sc">~</span> <span class="st">"Shasta"</span>,</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"sierra"</span> <span class="sc">~</span> <span class="st">"Sierra"</span>,</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"siskiyou"</span> <span class="sc">~</span> <span class="st">"Siskiyou"</span>,</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"solano"</span> <span class="sc">~</span> <span class="st">"Solano"</span>,</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"sonoma"</span> <span class="sc">~</span> <span class="st">"Sonoma"</span>,</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"stanislaus"</span> <span class="sc">~</span> <span class="st">"Stanislaus"</span>,</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"sutter"</span> <span class="sc">~</span> <span class="st">"Sutter"</span>,</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"tehama"</span> <span class="sc">~</span> <span class="st">"Tehama"</span>,</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"trinity"</span> <span class="sc">~</span> <span class="st">"Trinity"</span>,</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"tulare"</span> <span class="sc">~</span> <span class="st">"Tulare"</span>,</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"tuolumne"</span> <span class="sc">~</span> <span class="st">"Tuolumne"</span>,</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"ventura"</span> <span class="sc">~</span> <span class="st">"Ventura"</span>,</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"yolo"</span> <span class="sc">~</span> <span class="st">"Yolo"</span>,</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"yuba"</span> <span class="sc">~</span> <span class="st">"Yuba"</span>))</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a base california map</span></span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>ca_base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> california, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group)) <span class="sc">+</span> </span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>) <span class="sc">+</span> </span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Using this for quickly removing axes later on when plotting maps</span></span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>ditch_the_axes <span class="ot">&lt;-</span> <span class="fu">theme</span>(</span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="ozone-days-maps" class="level4">
<h4 class="anchored" data-anchor-id="ozone-days-maps">Ozone Days Maps</h4>
<p>Below, I’ve plotted a map of Ozone Days over time (2000-2010) by county. An Ozone Day is a day in which ozone levels were greater than the national air quality standards.</p>
<p><strong>It’s clear that Ozone-related air quality was worse during the early parts of the decade, particularly 2001-2003, and improved towards the end of the decade.</strong></p>
<p>Another thing that is clear from these maps is that there is not a huge variance in Ozone days within counties. In other words, counties with high ozone days tend to stay counties with high ozone days. This is perhaps not surprising, as Ozone levels will tend to be higher in areas with big cities, where smog and air pollution originate.</p>
<p>A notable exception to this, is that the Bay Area (San Francisco) has low Ozone days throughout the decade. This is strange to me, and makes me question whether the data is accurately reported for that region.</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating function to filter data by year and combining it with map data for creating maps</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mapdatafunction <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {airqualityanddeaths <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">year</span>(Year) <span class="sc">==</span> x <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ca_counties, ., <span class="at">by =</span> <span class="st">"County"</span>)}</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating function to plot a map ozone days by county by year</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>mapozonefunction <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  ca_base <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">mapdatafunction</span>(x), <span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    ditch_the_axes <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>), <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(x, <span class="st">" Ozone Days"</span>))</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) {<span class="fu">print</span>(<span class="fu">mapozonefunction</span>(i))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-10.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-12-11.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="pm2.5-days-maps" class="level4">
<h4 class="anchored" data-anchor-id="pm2.5-days-maps">PM2.5 Days Maps</h4>
<p>Next, I’ve plotted a map of PM2.5 Days over time by county. A PM2.5 Day is a day in which PM2.5 levels were greater than the national air quality standards.</p>
<p><strong>It’s again clear that PM2.5-related air quality was worse during the early parts of the decade.</strong></p>
<p>It’s also notable that overall, there are far fewer PM2.5 Days. I’ve color gradient accordingly, now maxing out at 120 instead of 150 in order to detect changes more easily.</p>
<p><strong>There seems to be a greater intra-county change over time than with Ozone Days.</strong> I believe this is because PM2.5 levels can be caused by more acute events than, such as wildfires. For future research, I’d really like to look at more recent years, where wildfires have been quite bad in California.</p>
<p>Based on these maps, I would say that comparing cause of death to PM2.5 Days is probably going to be more interesting than Ozone for intra-county comparison over time, as the levels vary more by year.</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a function to map pm2.5 days by county and year maps</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>mapPM2<span class="fl">.5</span>function <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  ca_base <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">mapdatafunction</span>(x), <span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>      ditch_the_axes <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">120</span>), <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(x, <span class="st">" PM2.5 Days"</span>))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) {<span class="fu">print</span>(<span class="fu">mapPM2.5function</span>(i))}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-13-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-13-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-13-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-13-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-13-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-13-10.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-13-11.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="air-quality-summary-and-descriptive-visualizations" class="level4">
<h4 class="anchored" data-anchor-id="air-quality-summary-and-descriptive-visualizations">Air Quality Summary and Descriptive Visualizations</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting a custom color palette for air quality measures</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>airqualitycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Ozone Days"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Mean Ozone Days"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"PM2.5 Days"</span> <span class="ot">=</span> <span class="st">"plum"</span>, <span class="st">"Mean PM2.5 Days"</span> <span class="ot">=</span> <span class="st">"plum"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating labels for boxplot values (fivenum summarizes median, quartiles and min/max)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>AQfivenum <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Measure"</span>, <span class="at">values_to =</span> <span class="st">"Days"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Measure) <span class="sc">%&gt;%</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">five =</span> <span class="fu">list</span>(<span class="fu">fivenum</span>(Days))) <span class="sc">%&gt;%</span> </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> five) <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round) <span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(five <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below, I’ve plotted the distribution of air quality days by type (Ozone and PM2.5 Days). This includes all county-years, so 11 years x 58 counties for a total of 638 observations of each type.</p>
<p>Boxplot values are labeled below. Again, it’s clear that there are a lot more Ozone Days than PM2.5 Days, with a higher max (144 vs 117) and a greater interquartile range.</p>
<p>The violin plot - for PM2.5 Days especially - has a big clump of 0 day county-years, which we saw earlier in the map as dark blue counties.</p>
<p>What’s clear from both violin plots is that there are many high-extreme values, meaning that there are clearly several county-years with much worse air quality than average.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a violin + box plot combination for comparing distributions of air quality days by measure</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtering data and selecting columns</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Pivoting to have air quality measures in a single column for grouping</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Measure"</span>, <span class="at">values_to =</span> <span class="st">"Days"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Measure, <span class="at">y =</span> Days, <span class="at">fill =</span> Measure)) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> .<span class="dv">7</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding text labels</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> AQfivenum, </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Measure), <span class="at">y =</span> five, <span class="at">label =</span> five), </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> .<span class="dv">09</span>) <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Setting theme, etc.</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>,<span class="dv">125</span>,<span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> airqualitycolors) <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Distribution of Ozone and PM2.5 Days"</span>,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"California, 2000-2010"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Next, I will plot these distributions by individual years using a ridgeplot.</p>
<p>While both air quality types have noticeable clumps around 0-10 days, these are more pronounced for the PM2.5 Day plot.</p>
<p>Not surprisingly, the Ozone Days plot has more high county-years than PM2.5.</p>
<p>PM2.5 Days are mostly distributed around 0, with the exceptions of 2001, 2002, and 2008 where the peaks are closer to 10 days. This is interesting, as while we expected the higher years of 2001 and 2002, 2008 is a bit of a surprise based on the previous maps. This suggests that 2008 had many counties with slightly higher PM2.5 Days, but few high peaks.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting distribution of ozone days by year in a ridgeplot</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtering and selecting data</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">group =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plottin gridges with a gradient scale for air quality levels</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Theme, etc.</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">'Ozone Days'</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of Ozone Days by Year"</span>,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across All California Counties"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Performing same steps for PM2.5 Days</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">group =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>, ) <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">'Distribution of PM2.5 Days'</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of PM2.5 Days by Year"</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across All California Counties"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finally, to cap off describing the air quality data, I’ll create trend lines of mean Ozone and PM2.5 Days over the years. It’s again clear that there was a general downward trend in poor air quality (in other words, air quality improved throughout the decade). You can again see the peak in both measures in 2002.</p>
<p><em>For the rest of my analysis, I’ve labeled the maximum and minimum values for line plots, both occuring here in 2002 and 2010 respectively.</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting lines for each air quality type showing mean days by year</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>Airqualitybyyearline <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtering data</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Cause</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summarizing means by year</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivoting to have air quality in a single column for grouping</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Measure"</span>, <span class="at">values_to =</span> <span class="st">"Mean Days"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding column for labeling max and min values</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Measure) <span class="sc">%&gt;%</span> </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Mean Days</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">Mean Days</span><span class="st">`</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">Mean Days</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting lines and points</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean Days</span><span class="st">`</span>, <span class="at">col =</span> Measure, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding labels for min and max of each group</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Theme, etc</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> airqualitycolors)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>Airqualitybyyearline <span class="sc">+</span> </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean Ozone and PM2.5 Days"</span>,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"All County-Years, California, 2000-2010"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="death-data-summary-and-descriptive-visualizations" class="level4">
<h4 class="anchored" data-anchor-id="death-data-summary-and-descriptive-visualizations">Death Data Summary and Descriptive Visualizations</h4>
<p>Next, I will create similar descriptive visualizations for the death data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting color palette for causes of death</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>deathcolors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"ALL"</span> <span class="ot">=</span> <span class="st">"navy"</span>,<span class="st">"CLD"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>,<span class="st">"HTD"</span> <span class="ot">=</span> <span class="st">"maroon"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating labels for box plot</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>Deathsfivenum <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span> </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">five =</span> <span class="fu">list</span>(<span class="fu">fivenum</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> five) <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round) <span class="sc">%&gt;%</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(five <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below I’ve plotted the distribution of deaths per 100,000 by cause using data from all county-years. Note that the Y axis varies in each violin plot to allow for the figures to be more interpret-able.</p>
<p>Interquartile, median and max values are also labeled. The median deaths per 100,000 of all types for all county-years is 686, with a max of 1276.</p>
<p>You’ll notice that deaths by heart disease are much more prevalent than deaths by chronic lower respiratory diseases, with median deaths per 100,000 being 181 and 38 respectively.</p>
<p>This fact about CLD deaths may mean that the impact air quality has on CLD deaths per 100,000 will be harder to visualize, as the values are quite low.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creaating a violin plot for distribution of deaths per 100,000</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filtering and grouping data</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting plot asthetics</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Cause, <span class="at">y =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">fill =</span> Cause)) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating violin plot, and box plot on top</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> .<span class="dv">7</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span>.<span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding text labels of box plot values created previously</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(Deathsfivenum, Cause <span class="sc">!=</span> <span class="st">"HTD"</span>), </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Cause), <span class="at">y =</span> five, <span class="at">label =</span> five), </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(Deathsfivenum, Cause <span class="sc">==</span> <span class="st">"HTD"</span>), </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Cause), <span class="at">y =</span> five, <span class="at">label =</span> five), </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> <span class="sc">-</span>.<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># grouping facets by cause of death</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Cause <span class="sc">~</span>., <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># themes, titles, etc.</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Deaths per 100,000 by Cause"</span>,</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"California, 2000-2010"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I’ve also plotted the yearly ridge line plots for deaths per 100,000 of all, chronic lower respiratory disease and heart disease types.</p>
<p>The distribution of all types is quite consistent across years, with a slight decrease in the peak value as the decade progresses.</p>
<p>The CLD plot has some more noticable clumps around 0 deaths per 100,000 for each year. This will mostly be caused by counties with very small populations. Since CLD is in general a much rarer cause of death, there may be county-years with almost or 0 deaths per 100,000 of that type.</p>
<p>This may also raise the question of whether CLD deaths are being properly reported in small counties. This question might need more attention if I were to perform a more serious statistical analysis of the data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filtering and mutating data</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting asthetics for plot, fill of ..x.. allows for gradient</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">group =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding ridgeplot with gradients</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># themes etc.</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">'Deaths per 100,000'</span>,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of ALL Deaths per 100,000 by Year"</span>,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across All California Counties"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perfoming same as above for CLD deaths</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"CLD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">group =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">'Deaths per 100,000'</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of CLD Deaths per 100,000 by Year"</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across All California Counties"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perfoming same as above for HTD deaths</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"HTD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">group =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">'Deaths per 100,000'</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of HTD Deaths per 100,000 by Year"</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across All California Counties"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finally, I’ll look at the trend lines for mean deaths per 100,000 for all county-years as a time series. Again, note the varied Y axes.</p>
<p>There is a general downward trend for all 3 cause types.</p>
<p>ALL and HTD deaths both peak early in the decade and have a clear decline for the rest of the decade.</p>
<p>While it is decreasing, CLD has the least smooth decent in deaths per 100,000. This again could largely be caused by the small values for deaths per 100,000, as the Y axis only ranges by 5 deaths per 100,000. So in general, the CLD trend is fairly inconclusive.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filtering, grouping and creating summary means for yearly trends</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Cause) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding labels column for max and min values</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting asthetics</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>, <span class="at">label =</span> label, <span class="at">col =</span> Cause)) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding labels for min and max of each group</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Cause <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean Deaths per 100,000 Trend"</span>,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"All California Counties, 2000-2010"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Before moving onto comparisons, I will create a function that plots the trends previously seen in their own plots for later use.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perfoming similar steps to previous code, but adding to function deathstrend, where x is the cause of death</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>deathstrend <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="st">`</span><span class="at">overalldeathsper100,000</span><span class="st">`</span> <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> x) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Cause) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Mean "</span>,x,<span class="st">" Deaths vs. Air Quality Trends"</span>),</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"All County-Years, California, 2000-2010"</span>) <span class="sc">+</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean Deaths per 100,000"</span>)}</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>ALLdeathstrend <span class="ot">&lt;-</span> <span class="fu">deathstrend</span>(<span class="st">"ALL"</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>CLDdeathstrend <span class="ot">&lt;-</span> <span class="fu">deathstrend</span>(<span class="st">"CLD"</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>HTDdeathstrend <span class="ot">&lt;-</span> <span class="fu">deathstrend</span>(<span class="st">"HTD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="analysis-of-air-qualitys-affect-on-deaths" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-air-qualitys-affect-on-deaths">Analysis of Air Quality’s Affect on Deaths</h3>
<section id="time-series-trends-of-mean-air-quality-and-mean-deaths-per-100000" class="level4">
<h4 class="anchored" data-anchor-id="time-series-trends-of-mean-air-quality-and-mean-deaths-per-100000">Time Series Trends of Mean Air Quality and Mean Deaths per 100,000</h4>
<p>I will begin my analysis by comparing overall trends in air quality to trends in deaths.</p>
<p>Below you’ll see a line graph combining two plots I have shown previously, a time series of Mean Deaths per 100,000 for all causes of death, verses a time series of mean Days of both air quality types.</p>
<p>The trends are reasonably similar to each other.</p>
<p>There is a notable peak in 2002 for both types of air quality. The peak for deaths occurs one year later in 2003.</p>
<p>Then, there is a drop all three measures in 2004.</p>
<p>The next notable year is 2008, where all three measures again have a similar uptick, followed by a noticable drop to finish the decade.</p>
<p>It’s maybe even a bit surprising how close the trends are to each other, as there should be a LOT of other factors causing deaths of any type.</p>
<p>Of course, we can’t make any causal, or even meaningful correlative conclusions from this, but it warrants further exploration.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(ALLdeathstrend, Airqualitybyyearline, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below, I’ve produced the same plot except for swapping ALL Causes for Chronic Lower Respiratory Caused deaths.</p>
<p>As we saw before, mean CLD deaths per 100,000 are hard to make any reasonable conclusions about, largely due to the Y axis being so small.</p>
<p>Even so, there is still a decline in CLD deaths when comparing the beginning and end of the decade.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(CLDdeathstrend, Airqualitybyyearline, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finally, I’ve produced the plot for Heart Disease related deaths. The decline is quite consistent and pronounced from the beginning of the decade through to the end.</p>
<p>Despite the technical peak being in 2000, there is a clear second peak in 2002 when air quality of both types was at its worse.</p>
<p>Then the sharp decline in the last few years is apparent for all three measures.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(HTDdeathstrend, Airqualitybyyearline, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="direct-comparison-of-air-quality-to-deaths" class="level4">
<h4 class="anchored" data-anchor-id="direct-comparison-of-air-quality-to-deaths">Direct Comparison of Air Quality to Deaths</h4>
<p>To test whether air quality and deaths per 100,000 are related in a maybe more reliable way than time-series trends alone, I’ve plotted two scatter plots below where air quality (on the X axis) is directly compared to Deaths per 100,000 (on the Y axis) of each type. I’ve also added a linear trend line to each plot.</p>
<p>Each point in this plot represents a county, where the air quality and deaths per 100,000 are calculated as the mean for that county over the 11 years.</p>
<p>The results here are quite inconclusive, with the trend lines being practically flat for all air quality-cause of death combinations.</p>
<p>In fact, there is even a slight decline in deaths per 100,000 as air quality gets worse in the ALL Causes plots.</p>
<p>While not great for my hypothesis, clearly there is more to this story that needs to be addressed.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filtering, grouping, and summarizing means for each county</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County, Cause) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Mean Deaths per 100,000</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating labels column for top air quality day counties</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">90</span>, County, <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting aesthetics</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating scatterplot</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding labels</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">nudge_y =</span> <span class="dv">60</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding linear trend line</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># themes, etc.</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Cause <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean Deaths per 100,000 vs Mean Ozone Days"</span>,</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Trends are inconclusive for all three causes of death"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same code as above, but for PM2.5 days instead of Ozone</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County, Cause) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Mean Deaths per 100,000</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">40</span>, County, <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">nudge_y =</span> <span class="dv">25</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Cause <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean Deaths per 100,000 vs Mean PM2.5 Days"</span>,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Trends are inconclusive for all three causes of death"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="the-issue-with-small-counties" class="level4">
<h4 class="anchored" data-anchor-id="the-issue-with-small-counties">The Issue with Small Counties</h4>
<p>I believe there is an issue with sparsely populated counties that is skewing the previous graphs (and all of the death trends we’ve seen so far).</p>
<p>As many small counties are rural, they will not suffer many of the same causes of poor air quality that more urban counties face. We saw this in the first maps, where the rural counties were relatively “blue-er” than their large counterparts.</p>
<p>At the same time, small, rural counties will tend to have highly varied or even <em>higher</em> deaths per 100,000. This is confirmed by the plots below, where there is clearly a very large overall variance in deaths per 100,000 for small counties.</p>
<p>In fact the linear trend line for all causes of deaths has a downward slope, suggesting that larger counties have lower death rates.</p>
<p>This could be do to a variety of factors, like less access to healthcare or lower income levels.</p>
<p>Another issue is that as the population gets smaller for a county, the deaths per 100,000 becomes less reliable due to a smaller sample size. This is very evident from the plots below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filtering data for pop &lt; 250k for better visibility of small counties</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Population <span class="sc">&lt;</span> <span class="dv">2500000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Population</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause)) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding scatter plot</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding linear trend line</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span> </span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Population vs Deaths per 100,000"</span>,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"SMALL Counties Cause a BIG Variance in Deaths"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same code as above but for other causes of death</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">!=</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Population <span class="sc">&lt;</span> <span class="dv">2500000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Population</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause)) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Cause <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span> </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Population vs Deaths per 100,000 by Heart and Lung Types"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"SMALL Counties Cause a BIG Variance in Deaths"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="intra-county-exploration" class="level3">
<h3 class="anchored" data-anchor-id="intra-county-exploration">Intra-county Exploration</h3>
<p>In addition to the issue with small counties identified above, comparing deaths per 100,000 across all counties is probably not a good approach without a statistical process for controlling for other determinants of death.</p>
<p>In order to draw more meaningful conclusions about the correlation between air quality and death, I will next look at the time-series trends within some of the worst and best counties by mean air quality.</p>
<section id="top-3-worst-counties-for-pm2.5-days" class="level4">
<h4 class="anchored" data-anchor-id="top-3-worst-counties-for-pm2.5-days">Top 3 Worst Counties for PM2.5 Days</h4>
<p>First, I’ve identified the top 10 worst counties by PM2.5 days in the map below.</p>
<p>I’ve also labeled the 3 worst counties, which I will be exploring further.</p>
<p>These are Fresno, Riverside and Kern.</p>
<p>The mean population for all 3 counties is quite large as expected, all being over 750,000.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating data frame for use in plots, summarizing mean air quality</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>ozoneandpmdaysbycounty <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Cause</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># creating data frame that takes the top 10 counties for poor ozone days and combining it with county map data</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>top10data <span class="ot">&lt;-</span> ozoneandpmdaysbycounty <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">County =</span> <span class="fu">fct_reorder</span>(County, <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ca_counties, ., <span class="at">by =</span> <span class="st">"County"</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co"># creating data frame for top 3 worse counties to be used as labels</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>top3labeldata <span class="ot">&lt;-</span> <span class="fu">filter</span>(ca_counties, County <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Riverside"</span>, <span class="st">"Fresno"</span>, <span class="st">"Kern"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">long =</span> <span class="fu">median</span>(long),</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">lat =</span> <span class="fu">median</span>(lat))</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co"># adding map to base california map</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>ca_base <span class="sc">+</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> top10data, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting gradient to orange to represent high ozone days</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"#ffe8c9"</span>, <span class="at">high =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data=</span>top3labeldata, <span class="fu">aes</span>(<span class="at">label =</span> County, <span class="at">x =</span> long, <span class="at">y =</span> lat), <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 California Counties by Mean PM2.5 Days"</span>,</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Riverside, Fresno and Kern are Top 3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># showing some county mean populations</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(County <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fresno"</span>, <span class="st">"Riverside"</span>, <span class="st">"Kern"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Mean Population</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(Population), <span class="at">digits =</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["County"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Mean Population"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Fresno","2":"869902"},{"1":"Kern","2":"756745"},{"1":"Riverside","2":"1906370"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Next, I’ve written a couple of functions in the code chunk below that will filter and mutate the data, and create the line plots we’ve seen previously for individual counties.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#creating functions to look at trend lines for individual counties</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>countydays <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># selecting, filtering and pivoting air quality data in order to make grouped lines</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(County, Year, <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span>, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, Cause, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(County <span class="sc">==</span> x <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Measure"</span>, <span class="at">values_to =</span> <span class="st">"Days"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating data for labels of mins and maxes</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Measure) <span class="sc">%&gt;%</span> </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Days</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">Days</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">Days</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating plot, line, point, and labels</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Days, <span class="at">col =</span> Measure, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> airqualitycolors) <span class="sc">+</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>)}</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co"># similar as above but for deaths instead of air quality</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>deathstrendcounty <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> x <span class="sc">&amp;</span> County <span class="sc">==</span> y) <span class="sc">%&gt;%</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span> </span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(x, <span class="st">" Deaths per 100,000 and Air Quality Trends"</span>),</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="fu">paste0</span>(y, <span class="st">" 2000-2010"</span>)) <span class="sc">+</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Deaths per 100,000"</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below, I’ve created a function that will print out trends for each selected county for all death cause groups.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>countytrendarrange <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">ggarrange</span>(<span class="fu">deathstrendcounty</span>(<span class="st">"ALL"</span>, x), <span class="fu">countydays</span>(x), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="fu">deathstrendcounty</span>(<span class="st">"CLD"</span>, x), <span class="fu">countydays</span>(x), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="fu">deathstrendcounty</span>(<span class="st">"HTD"</span>, x), <span class="fu">countydays</span>(x), <span class="at">ncol =</span> <span class="dv">1</span>)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="riverside" class="level5">
<h5 class="anchored" data-anchor-id="riverside">Riverside</h5>
<p>First I’ll look at Riverside.</p>
<p>There is a distinct decline in deaths per 100,000 for ALL, CLD, and HTD causes.</p>
<p>Ozone days is consistently high throughout the decade; However, PM2.5 Days follows almost an identical trend to all three causes of death.</p>
<p>This is a compelling instance to suggest that PM2.5 days may have an impact on deaths per 100,000, as Ozone days remaining relatively constant almost acts as a control variable.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">countytrendarrange</span>(<span class="st">"Riverside"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fresno" class="level5">
<h5 class="anchored" data-anchor-id="fresno">Fresno</h5>
<p>For Fresno, the story changes, as ALL Causes of death seems to track closely with Ozone Days more closely than PM2.5 Days. The distinct drop from 2003 to 2004, and subsequent rise before falling again after 2006 is present for all causes of death and Ozone Days.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">countytrendarrange</span>(<span class="st">"Fresno"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="kern" class="level5">
<h5 class="anchored" data-anchor-id="kern">Kern</h5>
<p>The trends for Kern are the lest convincing either way. However, there is still a distinct decline in ALL and HTD Causes of death that tracks with both air quality measures. CLD on the other hand is quite erratic and inconclusive.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">countytrendarrange</span>(<span class="st">"Kern"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-33-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="bottom-2-worst-top-2-best-counties-for-pm2.5-days" class="level4">
<h4 class="anchored" data-anchor-id="bottom-2-worst-top-2-best-counties-for-pm2.5-days">Bottom 2 Worst (Top 2 Best) Counties for PM2.5 Days</h4>
<p>Below I’ve created a similar map to before, except I’ve highlighted the bottom 10 worst (or top 10 best depending on how you look at it) counties for mean PM2.5 Days.</p>
<p>However, instead of simply taking the bottom 3 counties for analysis, I’ve handpicked 2 counties, Santa Barbara and Lake, as these had decently high populations. Many of the bottom counties were extremely small and would be hard to reliably draw conclusions from in terms of deaths per 100,000.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating data frame that takes the bottom 10 counties for poor ozone days and combining it with county map data</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>bottom10data <span class="ot">&lt;-</span> ozoneandpmdaysbycounty <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(<span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">County =</span> <span class="fu">fct_reorder</span>(County, <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ca_counties, ., <span class="at">by =</span> <span class="st">"County"</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># creating data frame for bottom 2 counties to be used as labels</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>bottom2labeldata <span class="ot">&lt;-</span> <span class="fu">filter</span>(ca_counties, County <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Santa Barbara"</span>, <span class="st">"Lake"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">long =</span> <span class="fu">median</span>(long),</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">lat =</span> <span class="fu">median</span>(lat))</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># adding map to base california map</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>ca_base <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> bottom10data, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting gradient to green to represent good air quality</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"darkgreen"</span>, <span class="at">high =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding text labels for chosen counties</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data=</span>bottom2labeldata, <span class="fu">aes</span>(<span class="at">label =</span> County, <span class="at">x =</span> long, <span class="at">y =</span> lat), <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bottom 10 California Counties by Mean PM2.5 Days"</span>,</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Santa Barbara and Lake chosen for large relative populations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># printing some mean populations</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(County <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Santa Barbara"</span>, <span class="st">"Lake"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Mean Population</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(Population), <span class="at">digits =</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["County"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Mean Population"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Lake","2":"62868"},{"1":"Santa Barbara","2":"410069"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<section id="santa-barbara" class="level5">
<h5 class="anchored" data-anchor-id="santa-barbara">Santa Barbara</h5>
<p>Looking at the trends for Santa Barbara, you can see that the days for both types of air quality were low, but there was a distinct peak in Ozone Days in the beginning fo the decade, declining sharply after 2003.</p>
<p>There is a general downward trend in deaths per 100,000 of all types, but it’s really not a convincing match to the air quality trends.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">countytrendarrange</span>(<span class="st">"Santa Barbara"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-35-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="lake" class="level5">
<h5 class="anchored" data-anchor-id="lake">Lake</h5>
<p><em>For Lake, I had to make some changes to my function, as the labels would not work with many 0 PM2.5 days.</em></p>
<p>As you can see below, there is pretty much no correlation between air quality and deaths per 100,000 for any cause of death in Lake County.</p>
<p>This might be a case of the county being too small (~60,000 people), causing too much variance in the deaths data.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># had to create a new function that excluded labels, due to consistently 0 pm2.5 days, everything else is the same as previous functions</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>lakedays <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(County, Year, <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span>, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, Cause, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(County <span class="sc">==</span> <span class="st">"Lake"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Measure"</span>, <span class="at">values_to =</span> <span class="st">"Days"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Days, <span class="at">col =</span> Measure)) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> airqualitycolors) <span class="sc">+</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>deathttrendlake <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> x <span class="sc">&amp;</span> County <span class="sc">==</span> y) <span class="sc">%&gt;%</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span> </span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Lake"</span>, <span class="st">" Deaths per 100,000 and Air Quality Trends"</span>),</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="fu">paste0</span>(y, <span class="st">" 2000-2010"</span>)) <span class="sc">+</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Deaths per 100,000"</span>)}</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>laketrendarrange <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">ggarrange</span>(<span class="fu">deathttrendlake</span>(<span class="st">"ALL"</span>, x), lakedays, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="fu">deathttrendlake</span>(<span class="st">"CLD"</span>, x), lakedays, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="fu">deathttrendlake</span>(<span class="st">"HTD"</span>, x), lakedays, <span class="at">ncol =</span> <span class="dv">1</span>)}</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="fu">laketrendarrange</span>(<span class="st">"Lake"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="JosephVincent_Final_Project_files/figure-html/unnamed-chunk-36-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>To reiterate, <strong>the goal of my project was to assess whether there is a visual relationship between air quality trends and related causes of death in California for the decade of 2000-2010.</strong> We attempted to answer this question in a couple of ways.</p>
<p><strong>In my analysis of means across all counties, there is a strong visual suggestion that there is a relationship between the trends of air quality (both Ozone and PM2.5) and deaths per 100,000.</strong> This relationship is clearer for all causes of death and deaths by heart disease, and is less clear for chronic lower respiratory disease deaths.</p>
<p>I also identified some issues with comparing deaths per 100,000 across counties; Therefore, I looked at intra-county trends as well.</p>
<p><strong>Within counties that had high air quality days (poor air quality), the trend between air quality and deaths per 100,000 was evident, but the more potent air quality type seemed to vary between counties.</strong> Within counties that had low air quality days (good air quality) there was seemingly very little correlation. I believe this is overall a positive finding for my hypothesis.</p>
<p><strong>Much more work needs to be done to prove statistical correlation or causation between annual air quality and annual related deaths.</strong> For future analysis, I would hope to determine a way to calculate <em>excess</em> deaths per 100,000 that might be attributable to air quality. This will allow me to control for many of the “hidden” variables that are skewing the data.</p>
</section>
<section id="bibliography" class="level3">
<h3 class="anchored" data-anchor-id="bibliography">Bibliography</h3>
<p>[1] Kurt, O. K., Zhang, J., &amp; Pinkerton, K. E. (2016). Pulmonary health effects of air pollution. <em>Current opinion in pulmonary medicine</em>, <em>22</em>(2), 138–143. https://doi.org/10.1097/MCP.0000000000000248</p>
<p>[2] Jonathan J Buonocore <em>et al</em> (2023) Air pollution and health impacts of oil &amp; gas production in the United States <em>Environ. Res.: Health</em> <strong>1</strong> 021006. https://iopscience.iop.org/article/10.1088/2752-5309/acc886</p>
<p>[3] Centers for Disease Control and Prevention (2018). <em>Air Quality Measures on the National Environmental Health Tracking Network, 1999 - 2013,</em> [https://data.cdc.gov/Environmental-Health-Toxicology/Air-Quality-Measures-on-the-National-Environmental/cjae-szjv].</p>
<p>[4] California Health and Human Services (2021). <em>1999-2013 Final Deaths by Year by County</em>,[https://data.chhs.ca.gov/dataset/death-profiles-by-county/resource/e692e6a1-bddd-48ab-a0c8-fa0f1f43e9f4?i %20nner_span=True].</p>
<p>[5] United States Census Bureau (2021). <em>County Intercensal Tables: 2000-2010</em>,[https://www.census.gov/data/tables/time-series/demo/popest/intercensal-2000-2010-counties.html].</p>
<p>[6] R Core Team (2022). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.</p>
<p>[7] Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). “Welcome to the tidyverse.” _Journal of Open Source Software_, *4*(43), 1686. doi:10.21105/joss.01686 &lt;https://doi.org/10.21105/joss.01686&gt;.</p>
<p>[8] Becker OScbRA, Minka ARWRvbRBEbTP, Deckmyn. A (2022). _maps: Draw Geographical Maps_. R package version 3.4.1, &lt;https://CRAN.R-project.org/package=maps&gt;.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/601_Spring_2023" data-repo-id="R_kgDOI4JcJA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb53" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project - Air Quality and Deaths"</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Joseph Vincent"</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Comparing Air Quality to Death Trends in California, 2000-2010"</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "05/18/2023"</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - final_project</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - Joseph Vincent</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: inline</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: sentence</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtable)</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapproj)</span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(egg)</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 1. Introduction</span></span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a><span class="fu">### Abstract</span></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>Poor air quality has been shown to have a massively negative impact on human health.</span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>In particular, air pollution is known to worsen pulmonary and cardiovascular diseases <span class="sc">\[</span>1<span class="sc">\]</span>.</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>Just In the past few weeks, researchers out of Boston University showed that air pollution caused by oil and gas production in the US resulted in over **7500 excess deaths and \$77 billion in total health impacts in a *single year* \[2\].**</span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a>**The goal of my project is to assess whether there is a visual relationship between air quality trends and related causes of death in California for the decade of 2000-2010.** My analysis does not attempt to make statistically significant claims about excess deaths or economic impacts, but rather looks at visual trends on a high level to see if the impact is noticeable.</span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a>**My findings are that, at both state-wide and intra-county levels, changes in air quality (particularly PM2.5 levels) and deaths per 100,000 seem to follow similar trends.**</span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Introduction</span></span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a>My data comes from three primary sources:</span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Air quality**</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">SOURCE</span><span class="co">](https://data.cdc.gov/Environmental-Health-Toxicology/Air-Quality-Measures-on-the-National-Environmental/cjae-szjv)</span> <span class="sc">\[</span>3<span class="sc">\]</span></span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a>I'm using the CDC's database for Air Quality Measures on the National Environmental Health Tracking Network.</span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a>The most recent and complete historic data available contains per-county data on air quality between the years of 1999 and 2013, inclusive.</span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>This data is collected by the Environmental Protection Agency's network of more than 4,000 outdoor ambient air monitoring systems around the US, called the Air Quality System (AQS).</span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a>These systems collect two main types of data:</span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Ozone Concentrations**</span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a>High concentrations of Ozone near the ground level can be harmful, causing irritation to the respiratory system and aggravating a variety of chronic lung diseases.</span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a>This is often referred to as "smog" and is produced by things like car emissions and power plants.</span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Fine Particulate Matter (PM2.5) Concentrations**</span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a>This refers to tiny particulate matter in the air measuring two and a half microns or less in width that originates from a variety of pollutants.</span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a>Exposure to PM2.5 particles can cause both short and long term health effects.</span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a>PM2.5 sources include wildfires and fossil fuel combustion.</span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a>While this data is of high quality, it is lacking in rural areas where monitors are not present.</span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a>To account for this, the CDC and EPA developed statistical models to fill in gaps in data across regions and time.</span>
<span id="cb53-87"><a href="#cb53-87" aria-hidden="true" tabindex="-1"></a>This allows for granular analysis of county air quality data.</span>
<span id="cb53-88"><a href="#cb53-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a>**Two important concepts used in my analysis are Ozone Days and PM2.5 Days.**</span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a>*A measure of "Ozone Days" for a particular county-year represents the number of days with the maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard (NAAQS).*</span>
<span id="cb53-92"><a href="#cb53-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-93"><a href="#cb53-93" aria-hidden="true" tabindex="-1"></a>*A measure of "PM2.5 Days" for a particular county-year represents the number of days with PM2.5 levels over the NAAQS.*</span>
<span id="cb53-94"><a href="#cb53-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-95"><a href="#cb53-95" aria-hidden="true" tabindex="-1"></a>In both cases, information about true severity of concentrations is not available, only the number of days above the standard.</span>
<span id="cb53-96"><a href="#cb53-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-97"><a href="#cb53-97" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Deaths by Cause**</span>
<span id="cb53-98"><a href="#cb53-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-99"><a href="#cb53-99" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">SOURCE</span><span class="co">](https://data.chhs.ca.gov/dataset/death-profiles-by-county/resource/e692e6a1-bddd-48ab-a0c8-fa0f1f43e9f4?i%20nner_span=True)</span> <span class="sc">\[</span>4<span class="sc">\]</span></span>
<span id="cb53-100"><a href="#cb53-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-101"><a href="#cb53-101" aria-hidden="true" tabindex="-1"></a>In order to draw conclusions about air quality's immediate impact on public health, I'm combining my air quality data with a dataset from the state of California's Department of Health and Human Services (HHS) on annual number of deaths by county, including primary cause of death.</span>
<span id="cb53-102"><a href="#cb53-102" aria-hidden="true" tabindex="-1"></a>This data also spans the years 1999-2013, but I will be using 2000-2010.</span>
<span id="cb53-103"><a href="#cb53-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-104"><a href="#cb53-104" aria-hidden="true" tabindex="-1"></a>While the data includes a wide variety of causes, for my analysis I will be focusing on **total deaths (ALL), chronic lower respiratory disease (CLD), and diseases of the heart (HTD)**, as these are the main relevant categories for air quality health impacts.</span>
<span id="cb53-105"><a href="#cb53-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-106"><a href="#cb53-106" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Population**</span>
<span id="cb53-107"><a href="#cb53-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-108"><a href="#cb53-108" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">SOURCE</span><span class="co">](https://www.census.gov/data/tables/time-series/demo/popest/intercensal-2000-2010-counties.html)</span> <span class="sc">\[</span>5<span class="sc">\]</span></span>
<span id="cb53-109"><a href="#cb53-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-110"><a href="#cb53-110" aria-hidden="true" tabindex="-1"></a>Finally, I'm also using per-county population data from the United States Census Bureau.</span>
<span id="cb53-111"><a href="#cb53-111" aria-hidden="true" tabindex="-1"></a>While there are census packages out there for easy use within R, I required annual data by county, which only exists from 2005 onwards in most datasets.</span>
<span id="cb53-112"><a href="#cb53-112" aria-hidden="true" tabindex="-1"></a>I'm instead using the County Intercensal Tables 2000-2010 for the state of California.</span>
<span id="cb53-113"><a href="#cb53-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-114"><a href="#cb53-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## Part 2. Data Description</span></span>
<span id="cb53-115"><a href="#cb53-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-116"><a href="#cb53-116" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reading, mutating, and combining data</span></span>
<span id="cb53-117"><a href="#cb53-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-118"><a href="#cb53-118" aria-hidden="true" tabindex="-1"></a>Below I have provided a head sample of the three data sets.</span>
<span id="cb53-119"><a href="#cb53-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-120"><a href="#cb53-120" aria-hidden="true" tabindex="-1"></a>The air quality data consists of measures of both ozone and PM2.5.</span>
<span id="cb53-121"><a href="#cb53-121" aria-hidden="true" tabindex="-1"></a>Ozone levels are measured by number of days with higher than average Ozone levels, and also person-days by county by multiplying by the population for that year.</span>
<span id="cb53-122"><a href="#cb53-122" aria-hidden="true" tabindex="-1"></a>PM2.5 levels are lacking raw number of days, but are recorded in percent of days, person days, and the annual average level for that county-year.</span>
<span id="cb53-123"><a href="#cb53-123" aria-hidden="true" tabindex="-1"></a>I will be converting this to PM2.5 days (count) for my analysis.</span>
<span id="cb53-124"><a href="#cb53-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-125"><a href="#cb53-125" aria-hidden="true" tabindex="-1"></a>**Each row of the air quality data represents a specific air quality measure for a county-year.**</span>
<span id="cb53-126"><a href="#cb53-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-129"><a href="#cb53-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-130"><a href="#cb53-130" aria-hidden="true" tabindex="-1"></a><span class="co">#reading in air quality data</span></span>
<span id="cb53-131"><a href="#cb53-131" aria-hidden="true" tabindex="-1"></a>airquality <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"JosephVincent_FinalProjectData/Air_Quality_Measures_on_the_National_Environmental_Health_Tracking_Network.csv"</span>)</span>
<span id="cb53-132"><a href="#cb53-132" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airquality)</span>
<span id="cb53-133"><a href="#cb53-133" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(airquality)</span>
<span id="cb53-134"><a href="#cb53-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-135"><a href="#cb53-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-136"><a href="#cb53-136" aria-hidden="true" tabindex="-1"></a>**As for the death data, each row contains a count of deaths in the "value" column for a county, year, stratification (demographically) and cause of death.** This results in many rows for a given county-year.</span>
<span id="cb53-137"><a href="#cb53-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-140"><a href="#cb53-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-141"><a href="#cb53-141" aria-hidden="true" tabindex="-1"></a><span class="co">#reading in deaths dataset</span></span>
<span id="cb53-142"><a href="#cb53-142" aria-hidden="true" tabindex="-1"></a>calideaths <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"JosephVincent_FinalProjectData/2021-05-14_deaths_final_1999_2013_county_year_sup.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-143"><a href="#cb53-143" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filtering for occurrence deaths (i.e. all deaths that occurred, disregarding residence)</span></span>
<span id="cb53-144"><a href="#cb53-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Geography_Type <span class="sc">==</span> <span class="st">"Occurrence"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-145"><a href="#cb53-145" aria-hidden="true" tabindex="-1"></a>  <span class="co">#de-selecting geography type as they are now all occurrence</span></span>
<span id="cb53-146"><a href="#cb53-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Geography_Type)</span>
<span id="cb53-147"><a href="#cb53-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-148"><a href="#cb53-148" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(calideaths)</span>
<span id="cb53-149"><a href="#cb53-149" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(calideaths)</span>
<span id="cb53-150"><a href="#cb53-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-151"><a href="#cb53-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-152"><a href="#cb53-152" aria-hidden="true" tabindex="-1"></a>**The population data consists of rows that each represent a US county.** The population estimates by year are listed in separate columns in a wide format.</span>
<span id="cb53-153"><a href="#cb53-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-156"><a href="#cb53-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-157"><a href="#cb53-157" aria-hidden="true" tabindex="-1"></a><span class="co">#reading in population data</span></span>
<span id="cb53-158"><a href="#cb53-158" aria-hidden="true" tabindex="-1"></a>populations <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"JosephVincent_FinalProjectData/co-est00int-tot.csv"</span>)</span>
<span id="cb53-159"><a href="#cb53-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-160"><a href="#cb53-160" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(populations)</span>
<span id="cb53-161"><a href="#cb53-161" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(populations)</span>
<span id="cb53-162"><a href="#cb53-162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-163"><a href="#cb53-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-164"><a href="#cb53-164" aria-hidden="true" tabindex="-1"></a>My goal is to combine these data sets into the "deaths data" format, having each case represent a county, year, stratification and cause.</span>
<span id="cb53-165"><a href="#cb53-165" aria-hidden="true" tabindex="-1"></a>I will combine the air quality measures as individual columns onto this data.</span>
<span id="cb53-166"><a href="#cb53-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-167"><a href="#cb53-167" aria-hidden="true" tabindex="-1"></a>These can be pivoted longer as needed for visualization, but are easier kept seperately for visualizing the data set.</span>
<span id="cb53-168"><a href="#cb53-168" aria-hidden="true" tabindex="-1"></a>Below, I've filtered the air quality data for California, then pivoted wider so that the air quality measures each are represented in a column.</span>
<span id="cb53-169"><a href="#cb53-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-170"><a href="#cb53-170" aria-hidden="true" tabindex="-1"></a>One thing worth mentioning is that the air quality data consists of both "monitored" values and "modeled" values.</span>
<span id="cb53-171"><a href="#cb53-171" aria-hidden="true" tabindex="-1"></a>As described on the CDC's website, the CDC and EPA collaborated to develop statistical models for filling in missing data in regions without data.</span>
<span id="cb53-172"><a href="#cb53-172" aria-hidden="true" tabindex="-1"></a>For my analysis, I will be using the modeled data to allow me to look at counties that would otherwise be missing data.</span>
<span id="cb53-173"><a href="#cb53-173" aria-hidden="true" tabindex="-1"></a>You can see these mutations below.</span>
<span id="cb53-174"><a href="#cb53-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-177"><a href="#cb53-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-178"><a href="#cb53-178" aria-hidden="true" tabindex="-1"></a>airqualitycali <span class="ot">&lt;-</span> airquality <span class="sc">%&gt;%</span></span>
<span id="cb53-179"><a href="#cb53-179" aria-hidden="true" tabindex="-1"></a>  <span class="co">#arranging by year</span></span>
<span id="cb53-180"><a href="#cb53-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="st">`</span><span class="at">ReportYear</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-181"><a href="#cb53-181" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filtering for california only and 2000-2010</span></span>
<span id="cb53-182"><a href="#cb53-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(StateName <span class="sc">==</span> <span class="st">"California"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">ReportYear</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-183"><a href="#cb53-183" aria-hidden="true" tabindex="-1"></a>  <span class="co">#selecting only relevant columns</span></span>
<span id="cb53-184"><a href="#cb53-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CountyName, ReportYear, MeasureName, Value) <span class="sc">%&gt;%</span></span>
<span id="cb53-185"><a href="#cb53-185" aria-hidden="true" tabindex="-1"></a>  <span class="co">#renaming county and year to be consistent with deaths dataset</span></span>
<span id="cb53-186"><a href="#cb53-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"County"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">CountyName</span><span class="st">`</span>, <span class="st">"Year"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">ReportYear</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-187"><a href="#cb53-187" aria-hidden="true" tabindex="-1"></a>  <span class="co">#pivoting so that each row is a year-county for merging data</span></span>
<span id="cb53-188"><a href="#cb53-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> MeasureName, <span class="at">values_from =</span> Value) <span class="sc">%&gt;%</span></span>
<span id="cb53-189"><a href="#cb53-189" aria-hidden="true" tabindex="-1"></a>  <span class="co">#renaming Air Quality columns</span></span>
<span id="cb53-190"><a href="#cb53-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Ozone Days Delete"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Number of days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard</span><span class="st">`</span>,</span>
<span id="cb53-191"><a href="#cb53-191" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Ozone Person Days Delete"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Number of person-days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard</span><span class="st">`</span>,</span>
<span id="cb53-192"><a href="#cb53-192" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Percent of Days Delete"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent of days with PM2.5 levels over the National Ambient Air Quality Standard (NAAQS)</span><span class="st">`</span>,</span>
<span id="cb53-193"><a href="#cb53-193" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Person Days Delete"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Person-days with PM2.5 over the National Ambient Air Quality Standard</span><span class="st">`</span>,</span>
<span id="cb53-194"><a href="#cb53-194" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Annual Average Delete"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Annual average ambient concentrations of PM2.5 in micrograms per cubic meter (based on seasonal averages and daily measurement)</span><span class="st">`</span>,</span>
<span id="cb53-195"><a href="#cb53-195" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Ozone Days"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Number of days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard (monitor and modeled data)</span><span class="st">`</span>,</span>
<span id="cb53-196"><a href="#cb53-196" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Ozone Person Days"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Number of person-days with maximum 8-hour average ozone concentration over the National Ambient Air Quality Standard (monitor and modeled data)</span><span class="st">`</span>,</span>
<span id="cb53-197"><a href="#cb53-197" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Percent of Days"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Percent of days with PM2.5 levels over the National Ambient Air Quality Standard (monitor and modeled data)</span><span class="st">`</span>,</span>
<span id="cb53-198"><a href="#cb53-198" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Person Days"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Number of person-days with PM2.5 over the National Ambient Air Quality Standard (monitor and modeled data)</span><span class="st">`</span>,</span>
<span id="cb53-199"><a href="#cb53-199" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PM2.5 Annual Average"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Annual average ambient concentrations of PM 2.5 in micrograms per cubic meter, based on seasonal averages and daily measurement (monitor and modeled data)</span><span class="st">`</span>)</span>
<span id="cb53-200"><a href="#cb53-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-201"><a href="#cb53-201" aria-hidden="true" tabindex="-1"></a><span class="co">#filling in modeled data for first year, where there is no modeled data</span></span>
<span id="cb53-202"><a href="#cb53-202" aria-hidden="true" tabindex="-1"></a>airqualitycali <span class="ot">&lt;-</span> airqualitycali <span class="sc">%&gt;%</span></span>
<span id="cb53-203"><a href="#cb53-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb53-204"><a href="#cb53-204" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Ozone Days Delete</span><span class="st">`</span>,</span>
<span id="cb53-205"><a href="#cb53-205" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb53-206"><a href="#cb53-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Ozone Person Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb53-207"><a href="#cb53-207" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="st">`</span><span class="at">Ozone Person Days Delete</span><span class="st">`</span>,</span>
<span id="cb53-208"><a href="#cb53-208" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="st">`</span><span class="at">Ozone Person Days</span><span class="st">`</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb53-209"><a href="#cb53-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb53-210"><a href="#cb53-210" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">2000</span>  <span class="sc">~</span> <span class="st">`</span><span class="at">PM2.5 Percent of Days Delete</span><span class="st">`</span>,</span>
<span id="cb53-211"><a href="#cb53-211" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb53-212"><a href="#cb53-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PM2.5 Person Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb53-213"><a href="#cb53-213" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="st">`</span><span class="at">PM2.5 Person Days Delete</span><span class="st">`</span>,</span>
<span id="cb53-214"><a href="#cb53-214" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="st">`</span><span class="at">PM2.5 Person Days</span><span class="st">`</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb53-215"><a href="#cb53-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">PM2.5 Annual Average</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb53-216"><a href="#cb53-216" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">2000</span> <span class="sc">~</span> <span class="st">`</span><span class="at">PM2.5 Annual Average Delete</span><span class="st">`</span>,</span>
<span id="cb53-217"><a href="#cb53-217" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(<span class="st">`</span><span class="at">PM2.5 Annual Average</span><span class="st">`</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb53-218"><a href="#cb53-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">"Delete"</span>))</span>
<span id="cb53-219"><a href="#cb53-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-220"><a href="#cb53-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-221"><a href="#cb53-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-222"><a href="#cb53-222" aria-hidden="true" tabindex="-1"></a>For prepping the deaths data, I've filtered for only the causes of death I believe may be relevant to air quality (ALL, CLD, and HTD).</span>
<span id="cb53-223"><a href="#cb53-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-224"><a href="#cb53-224" aria-hidden="true" tabindex="-1"></a>Also, I've filled in some NA cells as 0 which were coded as "suppressed for small numbers".</span>
<span id="cb53-225"><a href="#cb53-225" aria-hidden="true" tabindex="-1"></a>These only apply when a specific stratification variable (i.e. race) has extremely low values for a county, and will likely not have any affect on my analysis, which I plan to mostly use the Total Population stratification.</span>
<span id="cb53-226"><a href="#cb53-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-229"><a href="#cb53-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-230"><a href="#cb53-230" aria-hidden="true" tabindex="-1"></a>calideathsclean <span class="ot">&lt;-</span> calideaths <span class="sc">%&gt;%</span></span>
<span id="cb53-231"><a href="#cb53-231" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filtering for 2000-2010</span></span>
<span id="cb53-232"><a href="#cb53-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-233"><a href="#cb53-233" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filling in suppressed data</span></span>
<span id="cb53-234"><a href="#cb53-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Count =</span> <span class="fu">case_when</span>(</span>
<span id="cb53-235"><a href="#cb53-235" aria-hidden="true" tabindex="-1"></a>    Annotation_Code <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb53-236"><a href="#cb53-236" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Count)))) <span class="sc">%&gt;%</span></span>
<span id="cb53-237"><a href="#cb53-237" aria-hidden="true" tabindex="-1"></a>  <span class="co">#de-selecting some unused columns</span></span>
<span id="cb53-238"><a href="#cb53-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Cause_Desc, <span class="sc">-</span>Annotation_Code, <span class="sc">-</span>Annotation_Desc) <span class="sc">%&gt;%</span></span>
<span id="cb53-239"><a href="#cb53-239" aria-hidden="true" tabindex="-1"></a>  <span class="co">#focusing on relevant conditions</span></span>
<span id="cb53-240"><a href="#cb53-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cause <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ALL"</span>, <span class="st">"CLD"</span>, <span class="st">"HTD"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-241"><a href="#cb53-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Deaths"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Count</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-242"><a href="#cb53-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Strata Name"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Strata_Name</span><span class="st">`</span>)</span>
<span id="cb53-243"><a href="#cb53-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-244"><a href="#cb53-244" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(calideathsclean)</span>
<span id="cb53-245"><a href="#cb53-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-246"><a href="#cb53-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-247"><a href="#cb53-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-248"><a href="#cb53-248" aria-hidden="true" tabindex="-1"></a>The population data needed a small bit of cleaning to pivot the estimates by year into a single column.</span>
<span id="cb53-249"><a href="#cb53-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-252"><a href="#cb53-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-253"><a href="#cb53-253" aria-hidden="true" tabindex="-1"></a>populationstidy <span class="ot">&lt;-</span> populations <span class="sc">%&gt;%</span></span>
<span id="cb53-254"><a href="#cb53-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(STNAME <span class="sc">==</span> <span class="st">"California"</span> <span class="sc">&amp;</span> CTYNAME <span class="sc">!=</span> <span class="st">"California"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-255"><a href="#cb53-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(CTYNAME, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"County"</span>, <span class="st">"Delete"</span>), <span class="at">sep =</span> <span class="st">" County"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-256"><a href="#cb53-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(County, POPESTIMATE2000<span class="sc">:</span>POPESTIMATE2010, <span class="sc">-</span>CENSUS2010POP) <span class="sc">%&gt;%</span></span>
<span id="cb53-257"><a href="#cb53-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"2000"</span> <span class="ot">=</span> POPESTIMATE2000,</span>
<span id="cb53-258"><a href="#cb53-258" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2001"</span> <span class="ot">=</span> POPESTIMATE2001,</span>
<span id="cb53-259"><a href="#cb53-259" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2002"</span> <span class="ot">=</span> POPESTIMATE2002,</span>
<span id="cb53-260"><a href="#cb53-260" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2003"</span> <span class="ot">=</span> POPESTIMATE2003,</span>
<span id="cb53-261"><a href="#cb53-261" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2004"</span> <span class="ot">=</span> POPESTIMATE2004,</span>
<span id="cb53-262"><a href="#cb53-262" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2005"</span> <span class="ot">=</span> POPESTIMATE2005,</span>
<span id="cb53-263"><a href="#cb53-263" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2006"</span> <span class="ot">=</span> POPESTIMATE2006,</span>
<span id="cb53-264"><a href="#cb53-264" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2007"</span> <span class="ot">=</span> POPESTIMATE2007,</span>
<span id="cb53-265"><a href="#cb53-265" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2008"</span> <span class="ot">=</span> POPESTIMATE2008,</span>
<span id="cb53-266"><a href="#cb53-266" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2009"</span> <span class="ot">=</span> POPESTIMATE2009,</span>
<span id="cb53-267"><a href="#cb53-267" aria-hidden="true" tabindex="-1"></a>         <span class="st">"2010"</span> <span class="ot">=</span> POPESTIMATE2010) <span class="sc">%&gt;%</span></span>
<span id="cb53-268"><a href="#cb53-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">col =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">2000</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2010</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Year"</span>, <span class="at">values_to =</span> <span class="st">"Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-269"><a href="#cb53-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Year</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">as.numeric</span>(Year))</span>
<span id="cb53-270"><a href="#cb53-270" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb53-271"><a href="#cb53-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-272"><a href="#cb53-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-273"><a href="#cb53-273" aria-hidden="true" tabindex="-1"></a>Finally, with the cleaning mostly complete, I'll combine my data sets.</span>
<span id="cb53-274"><a href="#cb53-274" aria-hidden="true" tabindex="-1"></a>Each time I'll merge into the deaths data.</span>
<span id="cb53-275"><a href="#cb53-275" aria-hidden="true" tabindex="-1"></a>I'll expect my final data set to consist of 28,072 rows, which is the size of the original deaths dataset after filtering for 2000-2010.</span>
<span id="cb53-276"><a href="#cb53-276" aria-hidden="true" tabindex="-1"></a>There are a total of 58 unique counties in CA.</span>
<span id="cb53-277"><a href="#cb53-277" aria-hidden="true" tabindex="-1"></a>The populations of these</span>
<span id="cb53-278"><a href="#cb53-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-281"><a href="#cb53-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-282"><a href="#cb53-282" aria-hidden="true" tabindex="-1"></a><span class="co">#merging data</span></span>
<span id="cb53-283"><a href="#cb53-283" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="ot">&lt;-</span> <span class="fu">left_join</span>(calideathsclean, airqualitycali, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"County"</span>, <span class="st">"Year"</span>))</span>
<span id="cb53-284"><a href="#cb53-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-285"><a href="#cb53-285" aria-hidden="true" tabindex="-1"></a><span class="co">#merging data</span></span>
<span id="cb53-286"><a href="#cb53-286" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="ot">&lt;-</span> <span class="fu">left_join</span>(airqualityanddeaths, populationstidy, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"County"</span>, <span class="st">"Year"</span>))</span>
<span id="cb53-287"><a href="#cb53-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-288"><a href="#cb53-288" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(airqualityanddeaths)</span>
<span id="cb53-289"><a href="#cb53-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-290"><a href="#cb53-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-291"><a href="#cb53-291" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mutation and NA replacement</span></span>
<span id="cb53-292"><a href="#cb53-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-293"><a href="#cb53-293" aria-hidden="true" tabindex="-1"></a>It's important to note that for some air quality data in 2000, NA were used for small counties where neither modeled nor monitored data was available.</span>
<span id="cb53-294"><a href="#cb53-294" aria-hidden="true" tabindex="-1"></a>In these cases, I've replaced the NAs with 0 days.</span>
<span id="cb53-295"><a href="#cb53-295" aria-hidden="true" tabindex="-1"></a>If not, the smaller, rural counties (with generally great air quality) would skew my averages later on.</span>
<span id="cb53-296"><a href="#cb53-296" aria-hidden="true" tabindex="-1"></a>In checking the data for later years with available monitors, this seems to be a good approach, as days are (or are near to) 0.</span>
<span id="cb53-297"><a href="#cb53-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-298"><a href="#cb53-298" aria-hidden="true" tabindex="-1"></a>I've also created a column for Deaths per 100,000 by using the population data I've collected.</span>
<span id="cb53-299"><a href="#cb53-299" aria-hidden="true" tabindex="-1"></a>This will allow me to better compare deaths between counties with wildly varying populations.</span>
<span id="cb53-300"><a href="#cb53-300" aria-hidden="true" tabindex="-1"></a>As we'll see later, this isn't a perfect fix as counties with small populations have a large varience in deaths per 100,000, but it's still preferable to the raw counts.</span>
<span id="cb53-301"><a href="#cb53-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-302"><a href="#cb53-302" aria-hidden="true" tabindex="-1"></a>I also have created a "raw" PM2.5 Days column that counts the number of days, instead of a percent.</span>
<span id="cb53-303"><a href="#cb53-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-306"><a href="#cb53-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-307"><a href="#cb53-307" aria-hidden="true" tabindex="-1"></a><span class="co">#For the remaining missing air quality data not filled in by models in 2000, replacing NAs with zero, as they are all small rural counties that will skew means higher for 2000</span></span>
<span id="cb53-308"><a href="#cb53-308" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-309"><a href="#cb53-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb53-310"><a href="#cb53-310" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Ozone Person Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">Ozone Person Days</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb53-311"><a href="#cb53-311" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb53-312"><a href="#cb53-312" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">PM2.5 Person Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">PM2.5 Person Days</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb53-313"><a href="#cb53-313" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">PM2.5 Annual Average</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replace_na</span>(<span class="st">`</span><span class="at">PM2.5 Annual Average</span><span class="st">`</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-314"><a href="#cb53-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating standardized deaths per 100,000 column</span></span>
<span id="cb53-315"><a href="#cb53-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"Deaths per 100,000"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Deaths</span><span class="st">`</span><span class="sc">/</span><span class="st">`</span><span class="at">Population</span><span class="st">`</span><span class="sc">*</span><span class="dv">100000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-316"><a href="#cb53-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a raw PM2.5 Days column</span></span>
<span id="cb53-317"><a href="#cb53-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"PM2.5 Days"</span> <span class="ot">=</span> <span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span><span class="sc">/</span><span class="dv">100</span><span class="sc">*</span><span class="dv">365</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-318"><a href="#cb53-318" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-arranging</span></span>
<span id="cb53-319"><a href="#cb53-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, Population, Strata, <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span>, Cause, Deaths, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Person Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Person Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Percent of Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Annual Average</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-320"><a href="#cb53-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Turning Year into a date for ease of plotting time series'</span></span>
<span id="cb53-321"><a href="#cb53-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">make_date</span>(<span class="at">year=</span>Year))</span>
<span id="cb53-322"><a href="#cb53-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-323"><a href="#cb53-323" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airqualityanddeaths)</span>
<span id="cb53-324"><a href="#cb53-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-325"><a href="#cb53-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-326"><a href="#cb53-326" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analysis Plan</span></span>
<span id="cb53-327"><a href="#cb53-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-328"><a href="#cb53-328" aria-hidden="true" tabindex="-1"></a>**The goal of my project is to assess whether there is a visual relationship between air quality trends and related causes of death in California for the decade of 2000-2010.**</span>
<span id="cb53-329"><a href="#cb53-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-330"><a href="#cb53-330" aria-hidden="true" tabindex="-1"></a>My plan is as follows:</span>
<span id="cb53-331"><a href="#cb53-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-332"><a href="#cb53-332" aria-hidden="true" tabindex="-1"></a>**1) Descriptive Visualizations**</span>
<span id="cb53-333"><a href="#cb53-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-334"><a href="#cb53-334" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Describe and summarize both the air quality and death trends data so that we can gain a baseline understanding of each before comparison.</span>
<span id="cb53-335"><a href="#cb53-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-336"><a href="#cb53-336" aria-hidden="true" tabindex="-1"></a>**2) Statewide Trend Comparison**</span>
<span id="cb53-337"><a href="#cb53-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-338"><a href="#cb53-338" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Compare overall trends in air quality to deaths per 100,000 by type by taking the means of all counties over the years.</span>
<span id="cb53-339"><a href="#cb53-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-340"><a href="#cb53-340" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Plot deaths per 100,000 by type against each air quality measure to see if they correlate.</span>
<span id="cb53-341"><a href="#cb53-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-342"><a href="#cb53-342" aria-hidden="true" tabindex="-1"></a>**3) Intra-county Trend Comparison**</span>
<span id="cb53-343"><a href="#cb53-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-344"><a href="#cb53-344" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Compare trends in air quality measures to trends in deaths per 100,000 by type for individual counties of either high or low air quality. This will allow me to reduce variance coming from county differences in hidden variables that could be influencing death rates (i.e. socio-economic variables).</span>
<span id="cb53-345"><a href="#cb53-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-346"><a href="#cb53-346" aria-hidden="true" tabindex="-1"></a>*A quick note that when I refer to the "decade", I've actually included 11 years (2000-2010 inclusive) in my analysis.*</span>
<span id="cb53-347"><a href="#cb53-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-348"><a href="#cb53-348" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary and Descriptive Visualizations</span></span>
<span id="cb53-349"><a href="#cb53-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-350"><a href="#cb53-350" aria-hidden="true" tabindex="-1"></a>There are 58 counties in California.</span>
<span id="cb53-351"><a href="#cb53-351" aria-hidden="true" tabindex="-1"></a>I'll begin by describing air quality by county.</span>
<span id="cb53-352"><a href="#cb53-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-355"><a href="#cb53-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-356"><a href="#cb53-356" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(airqualityanddeaths<span class="sc">$</span>County)</span>
<span id="cb53-357"><a href="#cb53-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-358"><a href="#cb53-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-359"><a href="#cb53-359" aria-hidden="true" tabindex="-1"></a>First, I will map each air quality measure by year, showing the trends across time.</span>
<span id="cb53-360"><a href="#cb53-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-361"><a href="#cb53-361" aria-hidden="true" tabindex="-1"></a>Below, I've done some preparation by creating state and county maps using the "maps" package, which includes per county data with longitude and latitude coordinates.</span>
<span id="cb53-362"><a href="#cb53-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-365"><a href="#cb53-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-366"><a href="#cb53-366" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting state data from map data</span></span>
<span id="cb53-367"><a href="#cb53-367" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"state"</span>)</span>
<span id="cb53-368"><a href="#cb53-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-369"><a href="#cb53-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting state data for California only for base map</span></span>
<span id="cb53-370"><a href="#cb53-370" aria-hidden="true" tabindex="-1"></a>california <span class="ot">&lt;-</span> <span class="fu">subset</span>(states, region <span class="sc">==</span> <span class="st">"california"</span>)</span>
<span id="cb53-371"><a href="#cb53-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-372"><a href="#cb53-372" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting map data for California County data</span></span>
<span id="cb53-373"><a href="#cb53-373" aria-hidden="true" tabindex="-1"></a>ca_counties <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">map_data</span>(<span class="st">"county"</span>), region <span class="sc">==</span> <span class="st">"california"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-374"><a href="#cb53-374" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-375"><a href="#cb53-375" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Changing county names to match my existing data</span></span>
<span id="cb53-376"><a href="#cb53-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"County"</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb53-377"><a href="#cb53-377" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"alameda"</span> <span class="sc">~</span> <span class="st">"Alameda"</span>,</span>
<span id="cb53-378"><a href="#cb53-378" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"alpine"</span> <span class="sc">~</span> <span class="st">"Alpine"</span>,</span>
<span id="cb53-379"><a href="#cb53-379" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"amador"</span> <span class="sc">~</span> <span class="st">"Amador"</span>,</span>
<span id="cb53-380"><a href="#cb53-380" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"butte"</span> <span class="sc">~</span> <span class="st">"Butte"</span>,</span>
<span id="cb53-381"><a href="#cb53-381" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"calaveras"</span> <span class="sc">~</span> <span class="st">"Calaveras"</span>,</span>
<span id="cb53-382"><a href="#cb53-382" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"colusa"</span> <span class="sc">~</span> <span class="st">"Colusa"</span>,</span>
<span id="cb53-383"><a href="#cb53-383" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"contra costa"</span> <span class="sc">~</span> <span class="st">"Contra Costa"</span>,</span>
<span id="cb53-384"><a href="#cb53-384" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"del norte"</span> <span class="sc">~</span> <span class="st">"Del Norte"</span>,</span>
<span id="cb53-385"><a href="#cb53-385" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"el dorado"</span> <span class="sc">~</span> <span class="st">"El Dorado"</span>,</span>
<span id="cb53-386"><a href="#cb53-386" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"fresno"</span> <span class="sc">~</span> <span class="st">"Fresno"</span>,</span>
<span id="cb53-387"><a href="#cb53-387" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"glenn"</span> <span class="sc">~</span> <span class="st">"Glenn"</span>,</span>
<span id="cb53-388"><a href="#cb53-388" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"humboldt"</span> <span class="sc">~</span> <span class="st">"Humboldt"</span>,</span>
<span id="cb53-389"><a href="#cb53-389" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"imperial"</span> <span class="sc">~</span> <span class="st">"Imperial"</span>,</span>
<span id="cb53-390"><a href="#cb53-390" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"inyo"</span> <span class="sc">~</span> <span class="st">"Inyo"</span>,</span>
<span id="cb53-391"><a href="#cb53-391" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"kern"</span> <span class="sc">~</span> <span class="st">"Kern"</span>,</span>
<span id="cb53-392"><a href="#cb53-392" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"kings"</span> <span class="sc">~</span> <span class="st">"Kings"</span>,</span>
<span id="cb53-393"><a href="#cb53-393" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"lake"</span> <span class="sc">~</span> <span class="st">"Lake"</span>,</span>
<span id="cb53-394"><a href="#cb53-394" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"lassen"</span> <span class="sc">~</span> <span class="st">"Lassen"</span>,</span>
<span id="cb53-395"><a href="#cb53-395" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"los angeles"</span> <span class="sc">~</span> <span class="st">"Los Angeles"</span>,</span>
<span id="cb53-396"><a href="#cb53-396" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"madera"</span> <span class="sc">~</span> <span class="st">"Madera"</span>,</span>
<span id="cb53-397"><a href="#cb53-397" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"marin"</span> <span class="sc">~</span> <span class="st">"Marin"</span>,</span>
<span id="cb53-398"><a href="#cb53-398" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"mariposa"</span> <span class="sc">~</span> <span class="st">"Mariposa"</span>,</span>
<span id="cb53-399"><a href="#cb53-399" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"mendocino"</span> <span class="sc">~</span> <span class="st">"Mendocino"</span>,</span>
<span id="cb53-400"><a href="#cb53-400" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"merced"</span> <span class="sc">~</span> <span class="st">"Merced"</span>,</span>
<span id="cb53-401"><a href="#cb53-401" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"modoc"</span> <span class="sc">~</span> <span class="st">"Modoc"</span>,</span>
<span id="cb53-402"><a href="#cb53-402" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"mono"</span> <span class="sc">~</span> <span class="st">"Mono"</span>,</span>
<span id="cb53-403"><a href="#cb53-403" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"monterey"</span> <span class="sc">~</span> <span class="st">"Monterey"</span>,</span>
<span id="cb53-404"><a href="#cb53-404" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"napa"</span> <span class="sc">~</span> <span class="st">"Napa"</span>,</span>
<span id="cb53-405"><a href="#cb53-405" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"nevada"</span> <span class="sc">~</span> <span class="st">"Nevada"</span>,</span>
<span id="cb53-406"><a href="#cb53-406" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"orange"</span> <span class="sc">~</span> <span class="st">"Orange"</span>,</span>
<span id="cb53-407"><a href="#cb53-407" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"placer"</span> <span class="sc">~</span> <span class="st">"Placer"</span>,</span>
<span id="cb53-408"><a href="#cb53-408" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"plumas"</span> <span class="sc">~</span> <span class="st">"Plumas"</span>,</span>
<span id="cb53-409"><a href="#cb53-409" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"riverside"</span> <span class="sc">~</span> <span class="st">"Riverside"</span>,</span>
<span id="cb53-410"><a href="#cb53-410" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"sacramento"</span> <span class="sc">~</span> <span class="st">"Sacramento"</span>,</span>
<span id="cb53-411"><a href="#cb53-411" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san benito"</span> <span class="sc">~</span> <span class="st">"San Benito"</span>,</span>
<span id="cb53-412"><a href="#cb53-412" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san bernardino"</span> <span class="sc">~</span> <span class="st">"San Bernardino"</span>,</span>
<span id="cb53-413"><a href="#cb53-413" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san diego"</span> <span class="sc">~</span> <span class="st">"San Diego"</span>,</span>
<span id="cb53-414"><a href="#cb53-414" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san francisco"</span> <span class="sc">~</span> <span class="st">"San Francisco"</span>,</span>
<span id="cb53-415"><a href="#cb53-415" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san joaquin"</span> <span class="sc">~</span> <span class="st">"San Joaquin"</span>,</span>
<span id="cb53-416"><a href="#cb53-416" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san luis obispo"</span> <span class="sc">~</span> <span class="st">"San Luis Obispo"</span>,</span>
<span id="cb53-417"><a href="#cb53-417" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"san mateo"</span> <span class="sc">~</span> <span class="st">"San Mateo"</span>,</span>
<span id="cb53-418"><a href="#cb53-418" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"santa barbara"</span> <span class="sc">~</span> <span class="st">"Santa Barbara"</span>,</span>
<span id="cb53-419"><a href="#cb53-419" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"santa clara"</span> <span class="sc">~</span> <span class="st">"Santa Clara"</span>,</span>
<span id="cb53-420"><a href="#cb53-420" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"santa cruz"</span> <span class="sc">~</span> <span class="st">"Santa Cruz"</span>,</span>
<span id="cb53-421"><a href="#cb53-421" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"shasta"</span> <span class="sc">~</span> <span class="st">"Shasta"</span>,</span>
<span id="cb53-422"><a href="#cb53-422" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"sierra"</span> <span class="sc">~</span> <span class="st">"Sierra"</span>,</span>
<span id="cb53-423"><a href="#cb53-423" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"siskiyou"</span> <span class="sc">~</span> <span class="st">"Siskiyou"</span>,</span>
<span id="cb53-424"><a href="#cb53-424" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"solano"</span> <span class="sc">~</span> <span class="st">"Solano"</span>,</span>
<span id="cb53-425"><a href="#cb53-425" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"sonoma"</span> <span class="sc">~</span> <span class="st">"Sonoma"</span>,</span>
<span id="cb53-426"><a href="#cb53-426" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"stanislaus"</span> <span class="sc">~</span> <span class="st">"Stanislaus"</span>,</span>
<span id="cb53-427"><a href="#cb53-427" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"sutter"</span> <span class="sc">~</span> <span class="st">"Sutter"</span>,</span>
<span id="cb53-428"><a href="#cb53-428" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"tehama"</span> <span class="sc">~</span> <span class="st">"Tehama"</span>,</span>
<span id="cb53-429"><a href="#cb53-429" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"trinity"</span> <span class="sc">~</span> <span class="st">"Trinity"</span>,</span>
<span id="cb53-430"><a href="#cb53-430" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"tulare"</span> <span class="sc">~</span> <span class="st">"Tulare"</span>,</span>
<span id="cb53-431"><a href="#cb53-431" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"tuolumne"</span> <span class="sc">~</span> <span class="st">"Tuolumne"</span>,</span>
<span id="cb53-432"><a href="#cb53-432" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"ventura"</span> <span class="sc">~</span> <span class="st">"Ventura"</span>,</span>
<span id="cb53-433"><a href="#cb53-433" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"yolo"</span> <span class="sc">~</span> <span class="st">"Yolo"</span>,</span>
<span id="cb53-434"><a href="#cb53-434" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">subregion</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"yuba"</span> <span class="sc">~</span> <span class="st">"Yuba"</span>))</span>
<span id="cb53-435"><a href="#cb53-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-436"><a href="#cb53-436" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a base california map</span></span>
<span id="cb53-437"><a href="#cb53-437" aria-hidden="true" tabindex="-1"></a>ca_base <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> california, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group)) <span class="sc">+</span> </span>
<span id="cb53-438"><a href="#cb53-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>) <span class="sc">+</span> </span>
<span id="cb53-439"><a href="#cb53-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb53-440"><a href="#cb53-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-441"><a href="#cb53-441" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb53-442"><a href="#cb53-442" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb53-443"><a href="#cb53-443" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb53-444"><a href="#cb53-444" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb53-445"><a href="#cb53-445" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb53-446"><a href="#cb53-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-447"><a href="#cb53-447" aria-hidden="true" tabindex="-1"></a><span class="co"># Using this for quickly removing axes later on when plotting maps</span></span>
<span id="cb53-448"><a href="#cb53-448" aria-hidden="true" tabindex="-1"></a>ditch_the_axes <span class="ot">&lt;-</span> <span class="fu">theme</span>(</span>
<span id="cb53-449"><a href="#cb53-449" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-450"><a href="#cb53-450" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-451"><a href="#cb53-451" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-452"><a href="#cb53-452" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-453"><a href="#cb53-453" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb53-454"><a href="#cb53-454" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb53-455"><a href="#cb53-455" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-456"><a href="#cb53-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-457"><a href="#cb53-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-458"><a href="#cb53-458" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ozone Days Maps</span></span>
<span id="cb53-459"><a href="#cb53-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-460"><a href="#cb53-460" aria-hidden="true" tabindex="-1"></a>Below, I've plotted a map of Ozone Days over time (2000-2010) by county.</span>
<span id="cb53-461"><a href="#cb53-461" aria-hidden="true" tabindex="-1"></a>An Ozone Day is a day in which ozone levels were greater than the national air quality standards.</span>
<span id="cb53-462"><a href="#cb53-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-463"><a href="#cb53-463" aria-hidden="true" tabindex="-1"></a>**It's clear that Ozone-related air quality was worse during the early parts of the decade, particularly 2001-2003, and improved towards the end of the decade.**</span>
<span id="cb53-464"><a href="#cb53-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-465"><a href="#cb53-465" aria-hidden="true" tabindex="-1"></a>Another thing that is clear from these maps is that there is not a huge variance in Ozone days within counties.</span>
<span id="cb53-466"><a href="#cb53-466" aria-hidden="true" tabindex="-1"></a>In other words, counties with high ozone days tend to stay counties with high ozone days.</span>
<span id="cb53-467"><a href="#cb53-467" aria-hidden="true" tabindex="-1"></a>This is perhaps not surprising, as Ozone levels will tend to be higher in areas with big cities, where smog and air pollution originate.</span>
<span id="cb53-468"><a href="#cb53-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-469"><a href="#cb53-469" aria-hidden="true" tabindex="-1"></a>A notable exception to this, is that the Bay Area (San Francisco) has low Ozone days throughout the decade.</span>
<span id="cb53-470"><a href="#cb53-470" aria-hidden="true" tabindex="-1"></a>This is strange to me, and makes me question whether the data is accurately reported for that region.</span>
<span id="cb53-471"><a href="#cb53-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-474"><a href="#cb53-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-475"><a href="#cb53-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb53-476"><a href="#cb53-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-477"><a href="#cb53-477" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating function to filter data by year and combining it with map data for creating maps</span></span>
<span id="cb53-478"><a href="#cb53-478" aria-hidden="true" tabindex="-1"></a>mapdatafunction <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {airqualityanddeaths <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">year</span>(Year) <span class="sc">==</span> x <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-479"><a href="#cb53-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ca_counties, ., <span class="at">by =</span> <span class="st">"County"</span>)}</span>
<span id="cb53-480"><a href="#cb53-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-481"><a href="#cb53-481" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating function to plot a map ozone days by county by year</span></span>
<span id="cb53-482"><a href="#cb53-482" aria-hidden="true" tabindex="-1"></a>mapozonefunction <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb53-483"><a href="#cb53-483" aria-hidden="true" tabindex="-1"></a>  ca_base <span class="sc">+</span></span>
<span id="cb53-484"><a href="#cb53-484" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">mapdatafunction</span>(x), <span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb53-485"><a href="#cb53-485" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb53-486"><a href="#cb53-486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb53-487"><a href="#cb53-487" aria-hidden="true" tabindex="-1"></a>    ditch_the_axes <span class="sc">+</span></span>
<span id="cb53-488"><a href="#cb53-488" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>), <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb53-489"><a href="#cb53-489" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(x, <span class="st">" Ozone Days"</span>))</span>
<span id="cb53-490"><a href="#cb53-490" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-491"><a href="#cb53-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-492"><a href="#cb53-492" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) {<span class="fu">print</span>(<span class="fu">mapozonefunction</span>(i))}</span>
<span id="cb53-493"><a href="#cb53-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-494"><a href="#cb53-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-495"><a href="#cb53-495" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PM2.5 Days Maps</span></span>
<span id="cb53-496"><a href="#cb53-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-497"><a href="#cb53-497" aria-hidden="true" tabindex="-1"></a>Next, I've plotted a map of PM2.5 Days over time by county.</span>
<span id="cb53-498"><a href="#cb53-498" aria-hidden="true" tabindex="-1"></a>A PM2.5 Day is a day in which PM2.5 levels were greater than the national air quality standards.</span>
<span id="cb53-499"><a href="#cb53-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-500"><a href="#cb53-500" aria-hidden="true" tabindex="-1"></a>**It's again clear that PM2.5-related air quality was worse during the early parts of the decade.**</span>
<span id="cb53-501"><a href="#cb53-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-502"><a href="#cb53-502" aria-hidden="true" tabindex="-1"></a>It's also notable that overall, there are far fewer PM2.5 Days.</span>
<span id="cb53-503"><a href="#cb53-503" aria-hidden="true" tabindex="-1"></a>I've color gradient accordingly, now maxing out at 120 instead of 150 in order to detect changes more easily.</span>
<span id="cb53-504"><a href="#cb53-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-505"><a href="#cb53-505" aria-hidden="true" tabindex="-1"></a>**There seems to be a greater intra-county change over time than with Ozone Days.** I believe this is because PM2.5 levels can be caused by more acute events than, such as wildfires.</span>
<span id="cb53-506"><a href="#cb53-506" aria-hidden="true" tabindex="-1"></a>For future research, I'd really like to look at more recent years, where wildfires have been quite bad in California.</span>
<span id="cb53-507"><a href="#cb53-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-508"><a href="#cb53-508" aria-hidden="true" tabindex="-1"></a>Based on these maps, I would say that comparing cause of death to PM2.5 Days is probably going to be more interesting than Ozone for intra-county comparison over time, as the levels vary more by year.</span>
<span id="cb53-509"><a href="#cb53-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-512"><a href="#cb53-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-513"><a href="#cb53-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb53-514"><a href="#cb53-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-515"><a href="#cb53-515" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a function to map pm2.5 days by county and year maps</span></span>
<span id="cb53-516"><a href="#cb53-516" aria-hidden="true" tabindex="-1"></a>mapPM2<span class="fl">.5</span>function <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb53-517"><a href="#cb53-517" aria-hidden="true" tabindex="-1"></a>  ca_base <span class="sc">+</span> </span>
<span id="cb53-518"><a href="#cb53-518" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>(<span class="at">data =</span> <span class="fu">mapdatafunction</span>(x), <span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb53-519"><a href="#cb53-519" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb53-520"><a href="#cb53-520" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb53-521"><a href="#cb53-521" aria-hidden="true" tabindex="-1"></a>      ditch_the_axes <span class="sc">+</span></span>
<span id="cb53-522"><a href="#cb53-522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">120</span>), <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">30</span>,<span class="dv">60</span>,<span class="dv">90</span>,<span class="dv">120</span>)) <span class="sc">+</span></span>
<span id="cb53-523"><a href="#cb53-523" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(x, <span class="st">" PM2.5 Days"</span>))</span>
<span id="cb53-524"><a href="#cb53-524" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-525"><a href="#cb53-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-526"><a href="#cb53-526" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) {<span class="fu">print</span>(<span class="fu">mapPM2.5function</span>(i))}</span>
<span id="cb53-527"><a href="#cb53-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-528"><a href="#cb53-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-529"><a href="#cb53-529" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Air Quality Summary and Descriptive Visualizations</span></span>
<span id="cb53-530"><a href="#cb53-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-533"><a href="#cb53-533" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-534"><a href="#cb53-534" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting a custom color palette for air quality measures</span></span>
<span id="cb53-535"><a href="#cb53-535" aria-hidden="true" tabindex="-1"></a>airqualitycolors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Ozone Days"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Mean Ozone Days"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"PM2.5 Days"</span> <span class="ot">=</span> <span class="st">"plum"</span>, <span class="st">"Mean PM2.5 Days"</span> <span class="ot">=</span> <span class="st">"plum"</span>)</span>
<span id="cb53-536"><a href="#cb53-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-537"><a href="#cb53-537" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating labels for boxplot values (fivenum summarizes median, quartiles and min/max)</span></span>
<span id="cb53-538"><a href="#cb53-538" aria-hidden="true" tabindex="-1"></a>AQfivenum <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span> </span>
<span id="cb53-539"><a href="#cb53-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-540"><a href="#cb53-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-541"><a href="#cb53-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Measure"</span>, <span class="at">values_to =</span> <span class="st">"Days"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-542"><a href="#cb53-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Measure) <span class="sc">%&gt;%</span> </span>
<span id="cb53-543"><a href="#cb53-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">five =</span> <span class="fu">list</span>(<span class="fu">fivenum</span>(Days))) <span class="sc">%&gt;%</span> </span>
<span id="cb53-544"><a href="#cb53-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> five) <span class="sc">%&gt;%</span></span>
<span id="cb53-545"><a href="#cb53-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round) <span class="sc">%&gt;%</span></span>
<span id="cb53-546"><a href="#cb53-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(five <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb53-547"><a href="#cb53-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-548"><a href="#cb53-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-549"><a href="#cb53-549" aria-hidden="true" tabindex="-1"></a>Below, I've plotted the distribution of air quality days by type (Ozone and PM2.5 Days).</span>
<span id="cb53-550"><a href="#cb53-550" aria-hidden="true" tabindex="-1"></a>This includes all county-years, so 11 years x 58 counties for a total of 638 observations of each type.</span>
<span id="cb53-551"><a href="#cb53-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-552"><a href="#cb53-552" aria-hidden="true" tabindex="-1"></a>Boxplot values are labeled below.</span>
<span id="cb53-553"><a href="#cb53-553" aria-hidden="true" tabindex="-1"></a>Again, it's clear that there are a lot more Ozone Days than PM2.5 Days, with a higher max (144 vs 117) and a greater interquartile range.</span>
<span id="cb53-554"><a href="#cb53-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-555"><a href="#cb53-555" aria-hidden="true" tabindex="-1"></a>The violin plot - for PM2.5 Days especially - has a big clump of 0 day county-years, which we saw earlier in the map as dark blue counties.</span>
<span id="cb53-556"><a href="#cb53-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-557"><a href="#cb53-557" aria-hidden="true" tabindex="-1"></a>What's clear from both violin plots is that there are many high-extreme values, meaning that there are clearly several county-years with much worse air quality than average.</span>
<span id="cb53-558"><a href="#cb53-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-561"><a href="#cb53-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-562"><a href="#cb53-562" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a violin + box plot combination for comparing distributions of air quality days by measure</span></span>
<span id="cb53-563"><a href="#cb53-563" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-564"><a href="#cb53-564" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtering data and selecting columns</span></span>
<span id="cb53-565"><a href="#cb53-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-566"><a href="#cb53-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-567"><a href="#cb53-567" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Pivoting to have air quality measures in a single column for grouping</span></span>
<span id="cb53-568"><a href="#cb53-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Measure"</span>, <span class="at">values_to =</span> <span class="st">"Days"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-569"><a href="#cb53-569" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting</span></span>
<span id="cb53-570"><a href="#cb53-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Measure, <span class="at">y =</span> Days, <span class="at">fill =</span> Measure)) <span class="sc">+</span></span>
<span id="cb53-571"><a href="#cb53-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> .<span class="dv">7</span>, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-572"><a href="#cb53-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-573"><a href="#cb53-573" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding text labels</span></span>
<span id="cb53-574"><a href="#cb53-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> AQfivenum, </span>
<span id="cb53-575"><a href="#cb53-575" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Measure), <span class="at">y =</span> five, <span class="at">label =</span> five), </span>
<span id="cb53-576"><a href="#cb53-576" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> .<span class="dv">09</span>) <span class="sc">+</span></span>
<span id="cb53-577"><a href="#cb53-577" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Setting theme, etc.</span></span>
<span id="cb53-578"><a href="#cb53-578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-579"><a href="#cb53-579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">150</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>,<span class="dv">125</span>,<span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb53-580"><a href="#cb53-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-581"><a href="#cb53-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> airqualitycolors) <span class="sc">+</span></span>
<span id="cb53-582"><a href="#cb53-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Overall Distribution of Ozone and PM2.5 Days"</span>,</span>
<span id="cb53-583"><a href="#cb53-583" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"California, 2000-2010"</span>)</span>
<span id="cb53-584"><a href="#cb53-584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-585"><a href="#cb53-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-586"><a href="#cb53-586" aria-hidden="true" tabindex="-1"></a>Next, I will plot these distributions by individual years using a ridgeplot.</span>
<span id="cb53-587"><a href="#cb53-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-588"><a href="#cb53-588" aria-hidden="true" tabindex="-1"></a>While both air quality types have noticeable clumps around 0-10 days, these are more pronounced for the PM2.5 Day plot.</span>
<span id="cb53-589"><a href="#cb53-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-590"><a href="#cb53-590" aria-hidden="true" tabindex="-1"></a>Not surprisingly, the Ozone Days plot has more high county-years than PM2.5.</span>
<span id="cb53-591"><a href="#cb53-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-592"><a href="#cb53-592" aria-hidden="true" tabindex="-1"></a>PM2.5 Days are mostly distributed around 0, with the exceptions of 2001, 2002, and 2008 where the peaks are closer to 10 days.</span>
<span id="cb53-593"><a href="#cb53-593" aria-hidden="true" tabindex="-1"></a>This is interesting, as while we expected the higher years of 2001 and 2002, 2008 is a bit of a surprise based on the previous maps.</span>
<span id="cb53-594"><a href="#cb53-594" aria-hidden="true" tabindex="-1"></a>This suggests that 2008 had many counties with slightly higher PM2.5 Days, but few high peaks.</span>
<span id="cb53-595"><a href="#cb53-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-598"><a href="#cb53-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-599"><a href="#cb53-599" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting distribution of ozone days by year in a ridgeplot</span></span>
<span id="cb53-600"><a href="#cb53-600" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-601"><a href="#cb53-601" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtering and selecting data</span></span>
<span id="cb53-602"><a href="#cb53-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-603"><a href="#cb53-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb53-604"><a href="#cb53-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-605"><a href="#cb53-605" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting</span></span>
<span id="cb53-606"><a href="#cb53-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">group =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb53-607"><a href="#cb53-607" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plottin gridges with a gradient scale for air quality levels</span></span>
<span id="cb53-608"><a href="#cb53-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb53-609"><a href="#cb53-609" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Theme, etc.</span></span>
<span id="cb53-610"><a href="#cb53-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>) <span class="sc">+</span></span>
<span id="cb53-611"><a href="#cb53-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb53-612"><a href="#cb53-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">+</span></span>
<span id="cb53-613"><a href="#cb53-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-614"><a href="#cb53-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-615"><a href="#cb53-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">'Ozone Days'</span>,</span>
<span id="cb53-616"><a href="#cb53-616" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of Ozone Days by Year"</span>,</span>
<span id="cb53-617"><a href="#cb53-617" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across All California Counties"</span>)</span>
<span id="cb53-618"><a href="#cb53-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-619"><a href="#cb53-619" aria-hidden="true" tabindex="-1"></a><span class="co"># Performing same steps for PM2.5 Days</span></span>
<span id="cb53-620"><a href="#cb53-620" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-621"><a href="#cb53-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-622"><a href="#cb53-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb53-623"><a href="#cb53-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-624"><a href="#cb53-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">group =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb53-625"><a href="#cb53-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb53-626"><a href="#cb53-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>, ) <span class="sc">+</span></span>
<span id="cb53-627"><a href="#cb53-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">125</span>)) <span class="sc">+</span></span>
<span id="cb53-628"><a href="#cb53-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">+</span></span>
<span id="cb53-629"><a href="#cb53-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-630"><a href="#cb53-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-631"><a href="#cb53-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">'Distribution of PM2.5 Days'</span>,</span>
<span id="cb53-632"><a href="#cb53-632" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of PM2.5 Days by Year"</span>,</span>
<span id="cb53-633"><a href="#cb53-633" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across All California Counties"</span>) </span>
<span id="cb53-634"><a href="#cb53-634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-635"><a href="#cb53-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-636"><a href="#cb53-636" aria-hidden="true" tabindex="-1"></a>Finally, to cap off describing the air quality data, I'll create trend lines of mean Ozone and PM2.5 Days over the years.</span>
<span id="cb53-637"><a href="#cb53-637" aria-hidden="true" tabindex="-1"></a>It's again clear that there was a general downward trend in poor air quality (in other words, air quality improved throughout the decade).</span>
<span id="cb53-638"><a href="#cb53-638" aria-hidden="true" tabindex="-1"></a>You can again see the peak in both measures in 2002.</span>
<span id="cb53-639"><a href="#cb53-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-640"><a href="#cb53-640" aria-hidden="true" tabindex="-1"></a>*For the rest of my analysis, I've labeled the maximum and minimum values for line plots, both occuring here in 2002 and 2010 respectively.*</span>
<span id="cb53-641"><a href="#cb53-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-644"><a href="#cb53-644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-645"><a href="#cb53-645" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting lines for each air quality type showing mean days by year</span></span>
<span id="cb53-646"><a href="#cb53-646" aria-hidden="true" tabindex="-1"></a>Airqualitybyyearline <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-647"><a href="#cb53-647" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filtering data</span></span>
<span id="cb53-648"><a href="#cb53-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Cause</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-649"><a href="#cb53-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb53-650"><a href="#cb53-650" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Summarizing means by year</span></span>
<span id="cb53-651"><a href="#cb53-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb53-652"><a href="#cb53-652" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-653"><a href="#cb53-653" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivoting to have air quality in a single column for grouping</span></span>
<span id="cb53-654"><a href="#cb53-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Measure"</span>, <span class="at">values_to =</span> <span class="st">"Mean Days"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-655"><a href="#cb53-655" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding column for labeling max and min values</span></span>
<span id="cb53-656"><a href="#cb53-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Measure) <span class="sc">%&gt;%</span> </span>
<span id="cb53-657"><a href="#cb53-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Mean Days</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">Mean Days</span><span class="st">`</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">Mean Days</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-658"><a href="#cb53-658" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting lines and points</span></span>
<span id="cb53-659"><a href="#cb53-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean Days</span><span class="st">`</span>, <span class="at">col =</span> Measure, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb53-660"><a href="#cb53-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb53-661"><a href="#cb53-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-662"><a href="#cb53-662" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding labels for min and max of each group</span></span>
<span id="cb53-663"><a href="#cb53-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-664"><a href="#cb53-664" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Theme, etc</span></span>
<span id="cb53-665"><a href="#cb53-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-666"><a href="#cb53-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb53-667"><a href="#cb53-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb53-668"><a href="#cb53-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> airqualitycolors)</span>
<span id="cb53-669"><a href="#cb53-669" aria-hidden="true" tabindex="-1"></a>Airqualitybyyearline <span class="sc">+</span> </span>
<span id="cb53-670"><a href="#cb53-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean Ozone and PM2.5 Days"</span>,</span>
<span id="cb53-671"><a href="#cb53-671" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"All County-Years, California, 2000-2010"</span>)</span>
<span id="cb53-672"><a href="#cb53-672" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-673"><a href="#cb53-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-674"><a href="#cb53-674" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Death Data Summary and Descriptive Visualizations</span></span>
<span id="cb53-675"><a href="#cb53-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-676"><a href="#cb53-676" aria-hidden="true" tabindex="-1"></a>Next, I will create similar descriptive visualizations for the death data.</span>
<span id="cb53-677"><a href="#cb53-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-680"><a href="#cb53-680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-681"><a href="#cb53-681" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting color palette for causes of death</span></span>
<span id="cb53-682"><a href="#cb53-682" aria-hidden="true" tabindex="-1"></a>deathcolors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"ALL"</span> <span class="ot">=</span> <span class="st">"navy"</span>,<span class="st">"CLD"</span> <span class="ot">=</span> <span class="st">"darkgreen"</span>,<span class="st">"HTD"</span> <span class="ot">=</span> <span class="st">"maroon"</span>)</span>
<span id="cb53-683"><a href="#cb53-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-684"><a href="#cb53-684" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating labels for box plot</span></span>
<span id="cb53-685"><a href="#cb53-685" aria-hidden="true" tabindex="-1"></a>Deathsfivenum <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span> </span>
<span id="cb53-686"><a href="#cb53-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-687"><a href="#cb53-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span></span>
<span id="cb53-688"><a href="#cb53-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">five =</span> <span class="fu">list</span>(<span class="fu">fivenum</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb53-689"><a href="#cb53-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> five) <span class="sc">%&gt;%</span></span>
<span id="cb53-690"><a href="#cb53-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round) <span class="sc">%&gt;%</span></span>
<span id="cb53-691"><a href="#cb53-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(five <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb53-692"><a href="#cb53-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-693"><a href="#cb53-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-694"><a href="#cb53-694" aria-hidden="true" tabindex="-1"></a>Below I've plotted the distribution of deaths per 100,000 by cause using data from all county-years.</span>
<span id="cb53-695"><a href="#cb53-695" aria-hidden="true" tabindex="-1"></a>Note that the Y axis varies in each violin plot to allow for the figures to be more interpret-able.</span>
<span id="cb53-696"><a href="#cb53-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-697"><a href="#cb53-697" aria-hidden="true" tabindex="-1"></a>Interquartile, median and max values are also labeled.</span>
<span id="cb53-698"><a href="#cb53-698" aria-hidden="true" tabindex="-1"></a>The median deaths per 100,000 of all types for all county-years is 686, with a max of 1276.</span>
<span id="cb53-699"><a href="#cb53-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-700"><a href="#cb53-700" aria-hidden="true" tabindex="-1"></a>You'll notice that deaths by heart disease are much more prevalent than deaths by chronic lower respiratory diseases, with median deaths per 100,000 being 181 and 38 respectively.</span>
<span id="cb53-701"><a href="#cb53-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-702"><a href="#cb53-702" aria-hidden="true" tabindex="-1"></a>This fact about CLD deaths may mean that the impact air quality has on CLD deaths per 100,000 will be harder to visualize, as the values are quite low.</span>
<span id="cb53-703"><a href="#cb53-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-706"><a href="#cb53-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-707"><a href="#cb53-707" aria-hidden="true" tabindex="-1"></a><span class="co"># creaating a violin plot for distribution of deaths per 100,000</span></span>
<span id="cb53-708"><a href="#cb53-708" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-709"><a href="#cb53-709" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filtering and grouping data</span></span>
<span id="cb53-710"><a href="#cb53-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-711"><a href="#cb53-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span></span>
<span id="cb53-712"><a href="#cb53-712" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting plot asthetics</span></span>
<span id="cb53-713"><a href="#cb53-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Cause, <span class="at">y =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">fill =</span> Cause)) <span class="sc">+</span></span>
<span id="cb53-714"><a href="#cb53-714" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating violin plot, and box plot on top</span></span>
<span id="cb53-715"><a href="#cb53-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> .<span class="dv">7</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-716"><a href="#cb53-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width=</span>.<span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-717"><a href="#cb53-717" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding text labels of box plot values created previously</span></span>
<span id="cb53-718"><a href="#cb53-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(Deathsfivenum, Cause <span class="sc">!=</span> <span class="st">"HTD"</span>), </span>
<span id="cb53-719"><a href="#cb53-719" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Cause), <span class="at">y =</span> five, <span class="at">label =</span> five), </span>
<span id="cb53-720"><a href="#cb53-720" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb53-721"><a href="#cb53-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">filter</span>(Deathsfivenum, Cause <span class="sc">==</span> <span class="st">"HTD"</span>), </span>
<span id="cb53-722"><a href="#cb53-722" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(Cause), <span class="at">y =</span> five, <span class="at">label =</span> five), </span>
<span id="cb53-723"><a href="#cb53-723" aria-hidden="true" tabindex="-1"></a>            <span class="at">nudge_x =</span> <span class="sc">-</span>.<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb53-724"><a href="#cb53-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-725"><a href="#cb53-725" aria-hidden="true" tabindex="-1"></a>  <span class="co"># grouping facets by cause of death</span></span>
<span id="cb53-726"><a href="#cb53-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(Cause <span class="sc">~</span>., <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb53-727"><a href="#cb53-727" aria-hidden="true" tabindex="-1"></a>  <span class="co"># themes, titles, etc.</span></span>
<span id="cb53-728"><a href="#cb53-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-729"><a href="#cb53-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb53-730"><a href="#cb53-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Deaths per 100,000 by Cause"</span>,</span>
<span id="cb53-731"><a href="#cb53-731" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"California, 2000-2010"</span>)</span>
<span id="cb53-732"><a href="#cb53-732" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-733"><a href="#cb53-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-734"><a href="#cb53-734" aria-hidden="true" tabindex="-1"></a>I've also plotted the yearly ridge line plots for deaths per 100,000 of all, chronic lower respiratory disease and heart disease types.</span>
<span id="cb53-735"><a href="#cb53-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-736"><a href="#cb53-736" aria-hidden="true" tabindex="-1"></a>The distribution of all types is quite consistent across years, with a slight decrease in the peak value as the decade progresses.</span>
<span id="cb53-737"><a href="#cb53-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-738"><a href="#cb53-738" aria-hidden="true" tabindex="-1"></a>The CLD plot has some more noticable clumps around 0 deaths per 100,000 for each year.</span>
<span id="cb53-739"><a href="#cb53-739" aria-hidden="true" tabindex="-1"></a>This will mostly be caused by counties with very small populations.</span>
<span id="cb53-740"><a href="#cb53-740" aria-hidden="true" tabindex="-1"></a>Since CLD is in general a much rarer cause of death, there may be county-years with almost or 0 deaths per 100,000 of that type.</span>
<span id="cb53-741"><a href="#cb53-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-742"><a href="#cb53-742" aria-hidden="true" tabindex="-1"></a>This may also raise the question of whether CLD deaths are being properly reported in small counties.</span>
<span id="cb53-743"><a href="#cb53-743" aria-hidden="true" tabindex="-1"></a>This question might need more attention if I were to perform a more serious statistical analysis of the data.</span>
<span id="cb53-744"><a href="#cb53-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-747"><a href="#cb53-747" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-748"><a href="#cb53-748" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-749"><a href="#cb53-749" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filtering and mutating data</span></span>
<span id="cb53-750"><a href="#cb53-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-751"><a href="#cb53-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb53-752"><a href="#cb53-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-753"><a href="#cb53-753" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting asthetics for plot, fill of ..x.. allows for gradient</span></span>
<span id="cb53-754"><a href="#cb53-754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">group =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb53-755"><a href="#cb53-755" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding ridgeplot with gradients</span></span>
<span id="cb53-756"><a href="#cb53-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb53-757"><a href="#cb53-757" aria-hidden="true" tabindex="-1"></a>  <span class="co"># themes etc.</span></span>
<span id="cb53-758"><a href="#cb53-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>) <span class="sc">+</span></span>
<span id="cb53-759"><a href="#cb53-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">+</span></span>
<span id="cb53-760"><a href="#cb53-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-761"><a href="#cb53-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-762"><a href="#cb53-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">'Deaths per 100,000'</span>,</span>
<span id="cb53-763"><a href="#cb53-763" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of ALL Deaths per 100,000 by Year"</span>,</span>
<span id="cb53-764"><a href="#cb53-764" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across All California Counties"</span>)</span>
<span id="cb53-765"><a href="#cb53-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-766"><a href="#cb53-766" aria-hidden="true" tabindex="-1"></a><span class="co"># perfoming same as above for CLD deaths</span></span>
<span id="cb53-767"><a href="#cb53-767" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-768"><a href="#cb53-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"CLD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-769"><a href="#cb53-769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb53-770"><a href="#cb53-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-771"><a href="#cb53-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">group =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb53-772"><a href="#cb53-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb53-773"><a href="#cb53-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>) <span class="sc">+</span></span>
<span id="cb53-774"><a href="#cb53-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">+</span></span>
<span id="cb53-775"><a href="#cb53-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-776"><a href="#cb53-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-777"><a href="#cb53-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">'Deaths per 100,000'</span>,</span>
<span id="cb53-778"><a href="#cb53-778" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of CLD Deaths per 100,000 by Year"</span>,</span>
<span id="cb53-779"><a href="#cb53-779" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across All California Counties"</span>)</span>
<span id="cb53-780"><a href="#cb53-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-781"><a href="#cb53-781" aria-hidden="true" tabindex="-1"></a><span class="co"># perfoming same as above for HTD deaths</span></span>
<span id="cb53-782"><a href="#cb53-782" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-783"><a href="#cb53-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"HTD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-784"><a href="#cb53-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Year)) <span class="sc">%&gt;%</span></span>
<span id="cb53-785"><a href="#cb53-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, County, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-786"><a href="#cb53-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">group =</span> <span class="st">`</span><span class="at">Year</span><span class="st">`</span>, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb53-787"><a href="#cb53-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb53-788"><a href="#cb53-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">"turbo"</span>) <span class="sc">+</span></span>
<span id="cb53-789"><a href="#cb53-789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">position =</span> <span class="st">"right"</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)) <span class="sc">+</span></span>
<span id="cb53-790"><a href="#cb53-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-791"><a href="#cb53-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-792"><a href="#cb53-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span><span class="st">'Deaths per 100,000'</span>,</span>
<span id="cb53-793"><a href="#cb53-793" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Distribution of HTD Deaths per 100,000 by Year"</span>,</span>
<span id="cb53-794"><a href="#cb53-794" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Across All California Counties"</span>)</span>
<span id="cb53-795"><a href="#cb53-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-796"><a href="#cb53-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-797"><a href="#cb53-797" aria-hidden="true" tabindex="-1"></a>Finally, I'll look at the trend lines for mean deaths per 100,000 for all county-years as a time series.</span>
<span id="cb53-798"><a href="#cb53-798" aria-hidden="true" tabindex="-1"></a>Again, note the varied Y axes.</span>
<span id="cb53-799"><a href="#cb53-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-800"><a href="#cb53-800" aria-hidden="true" tabindex="-1"></a>There is a general downward trend for all 3 cause types.</span>
<span id="cb53-801"><a href="#cb53-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-802"><a href="#cb53-802" aria-hidden="true" tabindex="-1"></a>ALL and HTD deaths both peak early in the decade and have a clear decline for the rest of the decade.</span>
<span id="cb53-803"><a href="#cb53-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-804"><a href="#cb53-804" aria-hidden="true" tabindex="-1"></a>While it is decreasing, CLD has the least smooth decent in deaths per 100,000.</span>
<span id="cb53-805"><a href="#cb53-805" aria-hidden="true" tabindex="-1"></a>This again could largely be caused by the small values for deaths per 100,000, as the Y axis only ranges by 5 deaths per 100,000.</span>
<span id="cb53-806"><a href="#cb53-806" aria-hidden="true" tabindex="-1"></a>So in general, the CLD trend is fairly inconclusive.</span>
<span id="cb53-807"><a href="#cb53-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-810"><a href="#cb53-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-811"><a href="#cb53-811" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-812"><a href="#cb53-812" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filtering, grouping and creating summary means for yearly trends</span></span>
<span id="cb53-813"><a href="#cb53-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-814"><a href="#cb53-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Cause) <span class="sc">%&gt;%</span></span>
<span id="cb53-815"><a href="#cb53-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-816"><a href="#cb53-816" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding labels column for max and min values</span></span>
<span id="cb53-817"><a href="#cb53-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span> </span>
<span id="cb53-818"><a href="#cb53-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-819"><a href="#cb53-819" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting asthetics</span></span>
<span id="cb53-820"><a href="#cb53-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>, <span class="at">label =</span> label, <span class="at">col =</span> Cause)) <span class="sc">+</span></span>
<span id="cb53-821"><a href="#cb53-821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb53-822"><a href="#cb53-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-823"><a href="#cb53-823" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding labels for min and max of each group</span></span>
<span id="cb53-824"><a href="#cb53-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-825"><a href="#cb53-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Cause <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb53-826"><a href="#cb53-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb53-827"><a href="#cb53-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-828"><a href="#cb53-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb53-829"><a href="#cb53-829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb53-830"><a href="#cb53-830" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean Deaths per 100,000 Trend"</span>,</span>
<span id="cb53-831"><a href="#cb53-831" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"All California Counties, 2000-2010"</span>)</span>
<span id="cb53-832"><a href="#cb53-832" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-833"><a href="#cb53-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-834"><a href="#cb53-834" aria-hidden="true" tabindex="-1"></a>Before moving onto comparisons, I will create a function that plots the trends previously seen in their own plots for later use.</span>
<span id="cb53-835"><a href="#cb53-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-838"><a href="#cb53-838" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-839"><a href="#cb53-839" aria-hidden="true" tabindex="-1"></a><span class="co"># perfoming similar steps to previous code, but adding to function deathstrend, where x is the cause of death</span></span>
<span id="cb53-840"><a href="#cb53-840" aria-hidden="true" tabindex="-1"></a>deathstrend <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="st">`</span><span class="at">overalldeathsper100,000</span><span class="st">`</span> <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-841"><a href="#cb53-841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> x) <span class="sc">%&gt;%</span></span>
<span id="cb53-842"><a href="#cb53-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Cause) <span class="sc">%&gt;%</span></span>
<span id="cb53-843"><a href="#cb53-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-844"><a href="#cb53-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span></span>
<span id="cb53-845"><a href="#cb53-845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-846"><a href="#cb53-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">MeanDeathsper100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb53-847"><a href="#cb53-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb53-848"><a href="#cb53-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-849"><a href="#cb53-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-850"><a href="#cb53-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb53-851"><a href="#cb53-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-852"><a href="#cb53-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb53-853"><a href="#cb53-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Mean "</span>,x,<span class="st">" Deaths vs. Air Quality Trends"</span>),</span>
<span id="cb53-854"><a href="#cb53-854" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"All County-Years, California, 2000-2010"</span>) <span class="sc">+</span></span>
<span id="cb53-855"><a href="#cb53-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean Deaths per 100,000"</span>)}</span>
<span id="cb53-856"><a href="#cb53-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-857"><a href="#cb53-857" aria-hidden="true" tabindex="-1"></a>ALLdeathstrend <span class="ot">&lt;-</span> <span class="fu">deathstrend</span>(<span class="st">"ALL"</span>)</span>
<span id="cb53-858"><a href="#cb53-858" aria-hidden="true" tabindex="-1"></a>CLDdeathstrend <span class="ot">&lt;-</span> <span class="fu">deathstrend</span>(<span class="st">"CLD"</span>)</span>
<span id="cb53-859"><a href="#cb53-859" aria-hidden="true" tabindex="-1"></a>HTDdeathstrend <span class="ot">&lt;-</span> <span class="fu">deathstrend</span>(<span class="st">"HTD"</span>)</span>
<span id="cb53-860"><a href="#cb53-860" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-861"><a href="#cb53-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-862"><a href="#cb53-862" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of Air Quality's Affect on Deaths</span></span>
<span id="cb53-863"><a href="#cb53-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-864"><a href="#cb53-864" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Time Series Trends of Mean Air Quality and Mean Deaths per 100,000</span></span>
<span id="cb53-865"><a href="#cb53-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-866"><a href="#cb53-866" aria-hidden="true" tabindex="-1"></a>I will begin my analysis by comparing overall trends in air quality to trends in deaths.</span>
<span id="cb53-867"><a href="#cb53-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-868"><a href="#cb53-868" aria-hidden="true" tabindex="-1"></a>Below you'll see a line graph combining two plots I have shown previously, a time series of Mean Deaths per 100,000 for all causes of death, verses a time series of mean Days of both air quality types.</span>
<span id="cb53-869"><a href="#cb53-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-870"><a href="#cb53-870" aria-hidden="true" tabindex="-1"></a>The trends are reasonably similar to each other.</span>
<span id="cb53-871"><a href="#cb53-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-872"><a href="#cb53-872" aria-hidden="true" tabindex="-1"></a>There is a notable peak in 2002 for both types of air quality.</span>
<span id="cb53-873"><a href="#cb53-873" aria-hidden="true" tabindex="-1"></a>The peak for deaths occurs one year later in 2003.</span>
<span id="cb53-874"><a href="#cb53-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-875"><a href="#cb53-875" aria-hidden="true" tabindex="-1"></a>Then, there is a drop all three measures in 2004.</span>
<span id="cb53-876"><a href="#cb53-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-877"><a href="#cb53-877" aria-hidden="true" tabindex="-1"></a>The next notable year is 2008, where all three measures again have a similar uptick, followed by a noticable drop to finish the decade.</span>
<span id="cb53-878"><a href="#cb53-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-879"><a href="#cb53-879" aria-hidden="true" tabindex="-1"></a>It's maybe even a bit surprising how close the trends are to each other, as there should be a LOT of other factors causing deaths of any type.</span>
<span id="cb53-880"><a href="#cb53-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-881"><a href="#cb53-881" aria-hidden="true" tabindex="-1"></a>Of course, we can't make any causal, or even meaningful correlative conclusions from this, but it warrants further exploration.</span>
<span id="cb53-882"><a href="#cb53-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-885"><a href="#cb53-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-886"><a href="#cb53-886" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(ALLdeathstrend, Airqualitybyyearline, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb53-887"><a href="#cb53-887" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-888"><a href="#cb53-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-889"><a href="#cb53-889" aria-hidden="true" tabindex="-1"></a>Below, I've produced the same plot except for swapping ALL Causes for Chronic Lower Respiratory Caused deaths.</span>
<span id="cb53-890"><a href="#cb53-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-891"><a href="#cb53-891" aria-hidden="true" tabindex="-1"></a>As we saw before, mean CLD deaths per 100,000 are hard to make any reasonable conclusions about, largely due to the Y axis being so small.</span>
<span id="cb53-892"><a href="#cb53-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-893"><a href="#cb53-893" aria-hidden="true" tabindex="-1"></a>Even so, there is still a decline in CLD deaths when comparing the beginning and end of the decade.</span>
<span id="cb53-894"><a href="#cb53-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-897"><a href="#cb53-897" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-898"><a href="#cb53-898" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(CLDdeathstrend, Airqualitybyyearline, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb53-899"><a href="#cb53-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-900"><a href="#cb53-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-901"><a href="#cb53-901" aria-hidden="true" tabindex="-1"></a>Finally, I've produced the plot for Heart Disease related deaths.</span>
<span id="cb53-902"><a href="#cb53-902" aria-hidden="true" tabindex="-1"></a>The decline is quite consistent and pronounced from the beginning of the decade through to the end.</span>
<span id="cb53-903"><a href="#cb53-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-904"><a href="#cb53-904" aria-hidden="true" tabindex="-1"></a>Despite the technical peak being in 2000, there is a clear second peak in 2002 when air quality of both types was at its worse.</span>
<span id="cb53-905"><a href="#cb53-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-906"><a href="#cb53-906" aria-hidden="true" tabindex="-1"></a>Then the sharp decline in the last few years is apparent for all three measures.</span>
<span id="cb53-907"><a href="#cb53-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-910"><a href="#cb53-910" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-911"><a href="#cb53-911" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(HTDdeathstrend, Airqualitybyyearline, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb53-912"><a href="#cb53-912" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-913"><a href="#cb53-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-914"><a href="#cb53-914" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Direct Comparison of Air Quality to Deaths</span></span>
<span id="cb53-915"><a href="#cb53-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-916"><a href="#cb53-916" aria-hidden="true" tabindex="-1"></a>To test whether air quality and deaths per 100,000 are related in a maybe more reliable way than time-series trends alone, I've plotted two scatter plots below where air quality (on the X axis) is directly compared to Deaths per 100,000 (on the Y axis) of each type.</span>
<span id="cb53-917"><a href="#cb53-917" aria-hidden="true" tabindex="-1"></a>I've also added a linear trend line to each plot.</span>
<span id="cb53-918"><a href="#cb53-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-919"><a href="#cb53-919" aria-hidden="true" tabindex="-1"></a>Each point in this plot represents a county, where the air quality and deaths per 100,000 are calculated as the mean for that county over the 11 years.</span>
<span id="cb53-920"><a href="#cb53-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-921"><a href="#cb53-921" aria-hidden="true" tabindex="-1"></a>The results here are quite inconclusive, with the trend lines being practically flat for all air quality-cause of death combinations.</span>
<span id="cb53-922"><a href="#cb53-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-923"><a href="#cb53-923" aria-hidden="true" tabindex="-1"></a>In fact, there is even a slight decline in deaths per 100,000 as air quality gets worse in the ALL Causes plots.</span>
<span id="cb53-924"><a href="#cb53-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-925"><a href="#cb53-925" aria-hidden="true" tabindex="-1"></a>While not great for my hypothesis, clearly there is more to this story that needs to be addressed.</span>
<span id="cb53-926"><a href="#cb53-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-929"><a href="#cb53-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-930"><a href="#cb53-930" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-931"><a href="#cb53-931" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filtering, grouping, and summarizing means for each county</span></span>
<span id="cb53-932"><a href="#cb53-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-933"><a href="#cb53-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County, Cause) <span class="sc">%&gt;%</span></span>
<span id="cb53-934"><a href="#cb53-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Mean Deaths per 100,000</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>),</span>
<span id="cb53-935"><a href="#cb53-935" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-936"><a href="#cb53-936" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating labels column for top air quality day counties</span></span>
<span id="cb53-937"><a href="#cb53-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb53-938"><a href="#cb53-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">90</span>, County, <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-939"><a href="#cb53-939" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting aesthetics</span></span>
<span id="cb53-940"><a href="#cb53-940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb53-941"><a href="#cb53-941" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating scatterplot</span></span>
<span id="cb53-942"><a href="#cb53-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-943"><a href="#cb53-943" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding labels</span></span>
<span id="cb53-944"><a href="#cb53-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">nudge_y =</span> <span class="dv">60</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-945"><a href="#cb53-945" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding linear trend line</span></span>
<span id="cb53-946"><a href="#cb53-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-947"><a href="#cb53-947" aria-hidden="true" tabindex="-1"></a>  <span class="co"># themes, etc.</span></span>
<span id="cb53-948"><a href="#cb53-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-949"><a href="#cb53-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb53-950"><a href="#cb53-950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Cause <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb53-951"><a href="#cb53-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb53-952"><a href="#cb53-952" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean Deaths per 100,000 vs Mean Ozone Days"</span>,</span>
<span id="cb53-953"><a href="#cb53-953" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Trends are inconclusive for all three causes of death"</span>)</span>
<span id="cb53-954"><a href="#cb53-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-955"><a href="#cb53-955" aria-hidden="true" tabindex="-1"></a><span class="co"># same code as above, but for PM2.5 days instead of Ozone</span></span>
<span id="cb53-956"><a href="#cb53-956" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-957"><a href="#cb53-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-958"><a href="#cb53-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County, Cause) <span class="sc">%&gt;%</span></span>
<span id="cb53-959"><a href="#cb53-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Mean Deaths per 100,000</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>),</span>
<span id="cb53-960"><a href="#cb53-960" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-961"><a href="#cb53-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb53-962"><a href="#cb53-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">40</span>, County, <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-963"><a href="#cb53-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb53-964"><a href="#cb53-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-965"><a href="#cb53-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">nudge_y =</span> <span class="dv">25</span>, <span class="at">size =</span> <span class="fl">2.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-966"><a href="#cb53-966" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-967"><a href="#cb53-967" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-968"><a href="#cb53-968" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb53-969"><a href="#cb53-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Cause <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb53-970"><a href="#cb53-970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb53-971"><a href="#cb53-971" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Mean Deaths per 100,000 vs Mean PM2.5 Days"</span>,</span>
<span id="cb53-972"><a href="#cb53-972" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Trends are inconclusive for all three causes of death"</span>)</span>
<span id="cb53-973"><a href="#cb53-973" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-974"><a href="#cb53-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-975"><a href="#cb53-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-976"><a href="#cb53-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-977"><a href="#cb53-977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-978"><a href="#cb53-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-979"><a href="#cb53-979" aria-hidden="true" tabindex="-1"></a><span class="fu">#### The Issue with Small Counties</span></span>
<span id="cb53-980"><a href="#cb53-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-981"><a href="#cb53-981" aria-hidden="true" tabindex="-1"></a>I believe there is an issue with sparsely populated counties that is skewing the previous graphs (and all of the death trends we've seen so far).</span>
<span id="cb53-982"><a href="#cb53-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-983"><a href="#cb53-983" aria-hidden="true" tabindex="-1"></a>As many small counties are rural, they will not suffer many of the same causes of poor air quality that more urban counties face.</span>
<span id="cb53-984"><a href="#cb53-984" aria-hidden="true" tabindex="-1"></a>We saw this in the first maps, where the rural counties were relatively "blue-er" than their large counterparts.</span>
<span id="cb53-985"><a href="#cb53-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-986"><a href="#cb53-986" aria-hidden="true" tabindex="-1"></a>At the same time, small, rural counties will tend to have highly varied or even *higher* deaths per 100,000.</span>
<span id="cb53-987"><a href="#cb53-987" aria-hidden="true" tabindex="-1"></a>This is confirmed by the plots below, where there is clearly a very large overall variance in deaths per 100,000 for small counties.</span>
<span id="cb53-988"><a href="#cb53-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-989"><a href="#cb53-989" aria-hidden="true" tabindex="-1"></a>In fact the linear trend line for all causes of deaths has a downward slope, suggesting that larger counties have lower death rates.</span>
<span id="cb53-990"><a href="#cb53-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-991"><a href="#cb53-991" aria-hidden="true" tabindex="-1"></a>This could be do to a variety of factors, like less access to healthcare or lower income levels.</span>
<span id="cb53-992"><a href="#cb53-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-993"><a href="#cb53-993" aria-hidden="true" tabindex="-1"></a>Another issue is that as the population gets smaller for a county, the deaths per 100,000 becomes less reliable due to a smaller sample size.</span>
<span id="cb53-994"><a href="#cb53-994" aria-hidden="true" tabindex="-1"></a>This is very evident from the plots below.</span>
<span id="cb53-995"><a href="#cb53-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-998"><a href="#cb53-998" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-999"><a href="#cb53-999" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-1000"><a href="#cb53-1000" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filtering data for pop &lt; 250k for better visibility of small counties</span></span>
<span id="cb53-1001"><a href="#cb53-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1002"><a href="#cb53-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Population <span class="sc">&lt;</span> <span class="dv">2500000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1003"><a href="#cb53-1003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Population</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause)) <span class="sc">+</span></span>
<span id="cb53-1004"><a href="#cb53-1004" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding scatter plot</span></span>
<span id="cb53-1005"><a href="#cb53-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-1006"><a href="#cb53-1006" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding linear trend line</span></span>
<span id="cb53-1007"><a href="#cb53-1007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-1008"><a href="#cb53-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-1009"><a href="#cb53-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span> </span>
<span id="cb53-1010"><a href="#cb53-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb53-1011"><a href="#cb53-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Population vs Deaths per 100,000"</span>,</span>
<span id="cb53-1012"><a href="#cb53-1012" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"SMALL Counties Cause a BIG Variance in Deaths"</span>)</span>
<span id="cb53-1013"><a href="#cb53-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1014"><a href="#cb53-1014" aria-hidden="true" tabindex="-1"></a><span class="co"># same code as above but for other causes of death</span></span>
<span id="cb53-1015"><a href="#cb53-1015" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-1016"><a href="#cb53-1016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">!=</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1017"><a href="#cb53-1017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Population <span class="sc">&lt;</span> <span class="dv">2500000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1018"><a href="#cb53-1018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Population</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause)) <span class="sc">+</span></span>
<span id="cb53-1019"><a href="#cb53-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-1020"><a href="#cb53-1020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb53-1021"><a href="#cb53-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-1022"><a href="#cb53-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(Cause <span class="sc">~</span> ., <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb53-1023"><a href="#cb53-1023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span> </span>
<span id="cb53-1024"><a href="#cb53-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb53-1025"><a href="#cb53-1025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Population vs Deaths per 100,000 by Heart and Lung Types"</span>,</span>
<span id="cb53-1026"><a href="#cb53-1026" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"SMALL Counties Cause a BIG Variance in Deaths"</span>)</span>
<span id="cb53-1027"><a href="#cb53-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1028"><a href="#cb53-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1029"><a href="#cb53-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1030"><a href="#cb53-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1031"><a href="#cb53-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1032"><a href="#cb53-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">### Intra-county Exploration</span></span>
<span id="cb53-1033"><a href="#cb53-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1034"><a href="#cb53-1034" aria-hidden="true" tabindex="-1"></a>In addition to the issue with small counties identified above, comparing deaths per 100,000 across all counties is probably not a good approach without a statistical process for controlling for other determinants of death.</span>
<span id="cb53-1035"><a href="#cb53-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1036"><a href="#cb53-1036" aria-hidden="true" tabindex="-1"></a>In order to draw more meaningful conclusions about the correlation between air quality and death, I will next look at the time-series trends within some of the worst and best counties by mean air quality.</span>
<span id="cb53-1037"><a href="#cb53-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1038"><a href="#cb53-1038" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Top 3 Worst Counties for PM2.5 Days</span></span>
<span id="cb53-1039"><a href="#cb53-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1040"><a href="#cb53-1040" aria-hidden="true" tabindex="-1"></a>First, I've identified the top 10 worst counties by PM2.5 days in the map below.</span>
<span id="cb53-1041"><a href="#cb53-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1042"><a href="#cb53-1042" aria-hidden="true" tabindex="-1"></a>I've also labeled the 3 worst counties, which I will be exploring further.</span>
<span id="cb53-1043"><a href="#cb53-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1044"><a href="#cb53-1044" aria-hidden="true" tabindex="-1"></a>These are Fresno, Riverside and Kern.</span>
<span id="cb53-1045"><a href="#cb53-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1046"><a href="#cb53-1046" aria-hidden="true" tabindex="-1"></a>The mean population for all 3 counties is quite large as expected, all being over 750,000.</span>
<span id="cb53-1047"><a href="#cb53-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1050"><a href="#cb53-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1051"><a href="#cb53-1051" aria-hidden="true" tabindex="-1"></a><span class="co"># creating data frame for use in plots, summarizing mean air quality</span></span>
<span id="cb53-1052"><a href="#cb53-1052" aria-hidden="true" tabindex="-1"></a>ozoneandpmdaysbycounty <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-1053"><a href="#cb53-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Cause</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1054"><a href="#cb53-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb53-1055"><a href="#cb53-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="st">`</span><span class="at">Mean Ozone Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb53-1056"><a href="#cb53-1056" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(<span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb53-1057"><a href="#cb53-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1058"><a href="#cb53-1058" aria-hidden="true" tabindex="-1"></a><span class="co"># creating data frame that takes the top 10 counties for poor ozone days and combining it with county map data</span></span>
<span id="cb53-1059"><a href="#cb53-1059" aria-hidden="true" tabindex="-1"></a>top10data <span class="ot">&lt;-</span> ozoneandpmdaysbycounty <span class="sc">%&gt;%</span></span>
<span id="cb53-1060"><a href="#cb53-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1061"><a href="#cb53-1061" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">County =</span> <span class="fu">fct_reorder</span>(County, <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1062"><a href="#cb53-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ca_counties, ., <span class="at">by =</span> <span class="st">"County"</span>)</span>
<span id="cb53-1063"><a href="#cb53-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1064"><a href="#cb53-1064" aria-hidden="true" tabindex="-1"></a><span class="co"># creating data frame for top 3 worse counties to be used as labels</span></span>
<span id="cb53-1065"><a href="#cb53-1065" aria-hidden="true" tabindex="-1"></a>top3labeldata <span class="ot">&lt;-</span> <span class="fu">filter</span>(ca_counties, County <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Riverside"</span>, <span class="st">"Fresno"</span>, <span class="st">"Kern"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1066"><a href="#cb53-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb53-1067"><a href="#cb53-1067" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">long =</span> <span class="fu">median</span>(long),</span>
<span id="cb53-1068"><a href="#cb53-1068" aria-hidden="true" tabindex="-1"></a>            <span class="at">lat =</span> <span class="fu">median</span>(lat))</span>
<span id="cb53-1069"><a href="#cb53-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1070"><a href="#cb53-1070" aria-hidden="true" tabindex="-1"></a><span class="co"># adding map to base california map</span></span>
<span id="cb53-1071"><a href="#cb53-1071" aria-hidden="true" tabindex="-1"></a>ca_base <span class="sc">+</span></span>
<span id="cb53-1072"><a href="#cb53-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> top10data, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb53-1073"><a href="#cb53-1073" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting gradient to orange to represent high ozone days</span></span>
<span id="cb53-1074"><a href="#cb53-1074" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"#ffe8c9"</span>, <span class="at">high =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb53-1075"><a href="#cb53-1075" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data=</span>top3labeldata, <span class="fu">aes</span>(<span class="at">label =</span> County, <span class="at">x =</span> long, <span class="at">y =</span> lat), <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb53-1076"><a href="#cb53-1076" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 California Counties by Mean PM2.5 Days"</span>,</span>
<span id="cb53-1077"><a href="#cb53-1077" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Riverside, Fresno and Kern are Top 3"</span>)</span>
<span id="cb53-1078"><a href="#cb53-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1079"><a href="#cb53-1079" aria-hidden="true" tabindex="-1"></a><span class="co"># showing some county mean populations</span></span>
<span id="cb53-1080"><a href="#cb53-1080" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-1081"><a href="#cb53-1081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(County <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fresno"</span>, <span class="st">"Riverside"</span>, <span class="st">"Kern"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1082"><a href="#cb53-1082" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb53-1083"><a href="#cb53-1083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Mean Population</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(Population), <span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb53-1084"><a href="#cb53-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1085"><a href="#cb53-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1086"><a href="#cb53-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1087"><a href="#cb53-1087" aria-hidden="true" tabindex="-1"></a>Next, I've written a couple of functions in the code chunk below that will filter and mutate the data, and create the line plots we've seen previously for individual counties.</span>
<span id="cb53-1088"><a href="#cb53-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1091"><a href="#cb53-1091" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1092"><a href="#cb53-1092" aria-hidden="true" tabindex="-1"></a><span class="co">#creating functions to look at trend lines for individual counties</span></span>
<span id="cb53-1093"><a href="#cb53-1093" aria-hidden="true" tabindex="-1"></a>countydays <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-1094"><a href="#cb53-1094" aria-hidden="true" tabindex="-1"></a>  <span class="co"># selecting, filtering and pivoting air quality data in order to make grouped lines</span></span>
<span id="cb53-1095"><a href="#cb53-1095" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(County, Year, <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span>, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, Cause, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1096"><a href="#cb53-1096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(County <span class="sc">==</span> x <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1097"><a href="#cb53-1097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Measure"</span>, <span class="at">values_to =</span> <span class="st">"Days"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1098"><a href="#cb53-1098" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating data for labels of mins and maxes</span></span>
<span id="cb53-1099"><a href="#cb53-1099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Measure) <span class="sc">%&gt;%</span> </span>
<span id="cb53-1100"><a href="#cb53-1100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Days</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">Days</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">Days</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1101"><a href="#cb53-1101" aria-hidden="true" tabindex="-1"></a>  <span class="co"># creating plot, line, point, and labels</span></span>
<span id="cb53-1102"><a href="#cb53-1102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Days, <span class="at">col =</span> Measure, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb53-1103"><a href="#cb53-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb53-1104"><a href="#cb53-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-1105"><a href="#cb53-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-1106"><a href="#cb53-1106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-1107"><a href="#cb53-1107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> airqualitycolors) <span class="sc">+</span></span>
<span id="cb53-1108"><a href="#cb53-1108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>)}</span>
<span id="cb53-1109"><a href="#cb53-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1110"><a href="#cb53-1110" aria-hidden="true" tabindex="-1"></a><span class="co"># similar as above but for deaths instead of air quality</span></span>
<span id="cb53-1111"><a href="#cb53-1111" aria-hidden="true" tabindex="-1"></a>deathstrendcounty <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-1112"><a href="#cb53-1112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> x <span class="sc">&amp;</span> County <span class="sc">==</span> y) <span class="sc">%&gt;%</span></span>
<span id="cb53-1113"><a href="#cb53-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span> </span>
<span id="cb53-1114"><a href="#cb53-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1115"><a href="#cb53-1115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb53-1116"><a href="#cb53-1116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb53-1117"><a href="#cb53-1117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-1118"><a href="#cb53-1118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-1119"><a href="#cb53-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb53-1120"><a href="#cb53-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-1121"><a href="#cb53-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb53-1122"><a href="#cb53-1122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(x, <span class="st">" Deaths per 100,000 and Air Quality Trends"</span>),</span>
<span id="cb53-1123"><a href="#cb53-1123" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="fu">paste0</span>(y, <span class="st">" 2000-2010"</span>)) <span class="sc">+</span></span>
<span id="cb53-1124"><a href="#cb53-1124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Deaths per 100,000"</span>)}</span>
<span id="cb53-1125"><a href="#cb53-1125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1126"><a href="#cb53-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1127"><a href="#cb53-1127" aria-hidden="true" tabindex="-1"></a>Below, I've created a function that will print out trends for each selected county for all death cause groups.</span>
<span id="cb53-1128"><a href="#cb53-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1131"><a href="#cb53-1131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1132"><a href="#cb53-1132" aria-hidden="true" tabindex="-1"></a>countytrendarrange <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">ggarrange</span>(<span class="fu">deathstrendcounty</span>(<span class="st">"ALL"</span>, x), <span class="fu">countydays</span>(x), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb53-1133"><a href="#cb53-1133" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="fu">deathstrendcounty</span>(<span class="st">"CLD"</span>, x), <span class="fu">countydays</span>(x), <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb53-1134"><a href="#cb53-1134" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="fu">deathstrendcounty</span>(<span class="st">"HTD"</span>, x), <span class="fu">countydays</span>(x), <span class="at">ncol =</span> <span class="dv">1</span>)}</span>
<span id="cb53-1135"><a href="#cb53-1135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1136"><a href="#cb53-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1137"><a href="#cb53-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Riverside</span></span>
<span id="cb53-1138"><a href="#cb53-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1139"><a href="#cb53-1139" aria-hidden="true" tabindex="-1"></a>First I'll look at Riverside.</span>
<span id="cb53-1140"><a href="#cb53-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1141"><a href="#cb53-1141" aria-hidden="true" tabindex="-1"></a>There is a distinct decline in deaths per 100,000 for ALL, CLD, and HTD causes.</span>
<span id="cb53-1142"><a href="#cb53-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1143"><a href="#cb53-1143" aria-hidden="true" tabindex="-1"></a>Ozone days is consistently high throughout the decade; However, PM2.5 Days follows almost an identical trend to all three causes of death.</span>
<span id="cb53-1144"><a href="#cb53-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1145"><a href="#cb53-1145" aria-hidden="true" tabindex="-1"></a>This is a compelling instance to suggest that PM2.5 days may have an impact on deaths per 100,000, as Ozone days remaining relatively constant almost acts as a control variable.</span>
<span id="cb53-1146"><a href="#cb53-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1149"><a href="#cb53-1149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1150"><a href="#cb53-1150" aria-hidden="true" tabindex="-1"></a><span class="fu">countytrendarrange</span>(<span class="st">"Riverside"</span>)</span>
<span id="cb53-1151"><a href="#cb53-1151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1152"><a href="#cb53-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1153"><a href="#cb53-1153" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Fresno</span></span>
<span id="cb53-1154"><a href="#cb53-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1155"><a href="#cb53-1155" aria-hidden="true" tabindex="-1"></a>For Fresno, the story changes, as ALL Causes of death seems to track closely with Ozone Days more closely than PM2.5 Days.</span>
<span id="cb53-1156"><a href="#cb53-1156" aria-hidden="true" tabindex="-1"></a>The distinct drop from 2003 to 2004, and subsequent rise before falling again after 2006 is present for all causes of death and Ozone Days.</span>
<span id="cb53-1157"><a href="#cb53-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1160"><a href="#cb53-1160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1161"><a href="#cb53-1161" aria-hidden="true" tabindex="-1"></a><span class="fu">countytrendarrange</span>(<span class="st">"Fresno"</span>)</span>
<span id="cb53-1162"><a href="#cb53-1162" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1163"><a href="#cb53-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1164"><a href="#cb53-1164" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Kern</span></span>
<span id="cb53-1165"><a href="#cb53-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1166"><a href="#cb53-1166" aria-hidden="true" tabindex="-1"></a>The trends for Kern are the lest convincing either way.</span>
<span id="cb53-1167"><a href="#cb53-1167" aria-hidden="true" tabindex="-1"></a>However, there is still a distinct decline in ALL and HTD Causes of death that tracks with both air quality measures.</span>
<span id="cb53-1168"><a href="#cb53-1168" aria-hidden="true" tabindex="-1"></a>CLD on the other hand is quite erratic and inconclusive.</span>
<span id="cb53-1169"><a href="#cb53-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1172"><a href="#cb53-1172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1173"><a href="#cb53-1173" aria-hidden="true" tabindex="-1"></a><span class="fu">countytrendarrange</span>(<span class="st">"Kern"</span>)</span>
<span id="cb53-1174"><a href="#cb53-1174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1175"><a href="#cb53-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1176"><a href="#cb53-1176" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Bottom 2 Worst (Top 2 Best) Counties for PM2.5 Days</span></span>
<span id="cb53-1177"><a href="#cb53-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1178"><a href="#cb53-1178" aria-hidden="true" tabindex="-1"></a>Below I've created a similar map to before, except I've highlighted the bottom 10 worst (or top 10 best depending on how you look at it) counties for mean PM2.5 Days.</span>
<span id="cb53-1179"><a href="#cb53-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1180"><a href="#cb53-1180" aria-hidden="true" tabindex="-1"></a>However, instead of simply taking the bottom 3 counties for analysis, I've handpicked 2 counties, Santa Barbara and Lake, as these had decently high populations.</span>
<span id="cb53-1181"><a href="#cb53-1181" aria-hidden="true" tabindex="-1"></a>Many of the bottom counties were extremely small and would be hard to reliably draw conclusions from in terms of deaths per 100,000.</span>
<span id="cb53-1182"><a href="#cb53-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1185"><a href="#cb53-1185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1186"><a href="#cb53-1186" aria-hidden="true" tabindex="-1"></a><span class="co"># creating data frame that takes the bottom 10 counties for poor ozone days and combining it with county map data</span></span>
<span id="cb53-1187"><a href="#cb53-1187" aria-hidden="true" tabindex="-1"></a>bottom10data <span class="ot">&lt;-</span> ozoneandpmdaysbycounty <span class="sc">%&gt;%</span></span>
<span id="cb53-1188"><a href="#cb53-1188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_min</span>(<span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1189"><a href="#cb53-1189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">County =</span> <span class="fu">fct_reorder</span>(County, <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1190"><a href="#cb53-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ca_counties, ., <span class="at">by =</span> <span class="st">"County"</span>)</span>
<span id="cb53-1191"><a href="#cb53-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1192"><a href="#cb53-1192" aria-hidden="true" tabindex="-1"></a><span class="co"># creating data frame for bottom 2 counties to be used as labels</span></span>
<span id="cb53-1193"><a href="#cb53-1193" aria-hidden="true" tabindex="-1"></a>bottom2labeldata <span class="ot">&lt;-</span> <span class="fu">filter</span>(ca_counties, County <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Santa Barbara"</span>, <span class="st">"Lake"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1194"><a href="#cb53-1194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb53-1195"><a href="#cb53-1195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">long =</span> <span class="fu">median</span>(long),</span>
<span id="cb53-1196"><a href="#cb53-1196" aria-hidden="true" tabindex="-1"></a>            <span class="at">lat =</span> <span class="fu">median</span>(lat))</span>
<span id="cb53-1197"><a href="#cb53-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1198"><a href="#cb53-1198" aria-hidden="true" tabindex="-1"></a><span class="co"># adding map to base california map</span></span>
<span id="cb53-1199"><a href="#cb53-1199" aria-hidden="true" tabindex="-1"></a>ca_base <span class="sc">+</span></span>
<span id="cb53-1200"><a href="#cb53-1200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="at">data =</span> bottom10data, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Mean PM2.5 Days</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb53-1201"><a href="#cb53-1201" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setting gradient to green to represent good air quality</span></span>
<span id="cb53-1202"><a href="#cb53-1202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"darkgreen"</span>, <span class="at">high =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span></span>
<span id="cb53-1203"><a href="#cb53-1203" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adding text labels for chosen counties</span></span>
<span id="cb53-1204"><a href="#cb53-1204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data=</span>bottom2labeldata, <span class="fu">aes</span>(<span class="at">label =</span> County, <span class="at">x =</span> long, <span class="at">y =</span> lat), <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb53-1205"><a href="#cb53-1205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bottom 10 California Counties by Mean PM2.5 Days"</span>,</span>
<span id="cb53-1206"><a href="#cb53-1206" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Santa Barbara and Lake chosen for large relative populations"</span>)</span>
<span id="cb53-1207"><a href="#cb53-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1208"><a href="#cb53-1208" aria-hidden="true" tabindex="-1"></a><span class="co"># printing some mean populations</span></span>
<span id="cb53-1209"><a href="#cb53-1209" aria-hidden="true" tabindex="-1"></a>airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-1210"><a href="#cb53-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(County <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Santa Barbara"</span>, <span class="st">"Lake"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1211"><a href="#cb53-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(County) <span class="sc">%&gt;%</span></span>
<span id="cb53-1212"><a href="#cb53-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Mean Population</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(Population), <span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb53-1213"><a href="#cb53-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1214"><a href="#cb53-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1215"><a href="#cb53-1215" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Santa Barbara</span></span>
<span id="cb53-1216"><a href="#cb53-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1217"><a href="#cb53-1217" aria-hidden="true" tabindex="-1"></a>Looking at the trends for Santa Barbara, you can see that the days for both types of air quality were low, but there was a distinct peak in Ozone Days in the beginning fo the decade, declining sharply after 2003.</span>
<span id="cb53-1218"><a href="#cb53-1218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1219"><a href="#cb53-1219" aria-hidden="true" tabindex="-1"></a>There is a general downward trend in deaths per 100,000 of all types, but it's really not a convincing match to the air quality trends.</span>
<span id="cb53-1220"><a href="#cb53-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1223"><a href="#cb53-1223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1224"><a href="#cb53-1224" aria-hidden="true" tabindex="-1"></a><span class="fu">countytrendarrange</span>(<span class="st">"Santa Barbara"</span>)</span>
<span id="cb53-1225"><a href="#cb53-1225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1226"><a href="#cb53-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1227"><a href="#cb53-1227" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Lake</span></span>
<span id="cb53-1228"><a href="#cb53-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1229"><a href="#cb53-1229" aria-hidden="true" tabindex="-1"></a>*For Lake, I had to make some changes to my function, as the labels would not work with many 0 PM2.5 days.*</span>
<span id="cb53-1230"><a href="#cb53-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1231"><a href="#cb53-1231" aria-hidden="true" tabindex="-1"></a>As you can see below, there is pretty much no correlation between air quality and deaths per 100,000 for any cause of death in Lake County.</span>
<span id="cb53-1232"><a href="#cb53-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1233"><a href="#cb53-1233" aria-hidden="true" tabindex="-1"></a>This might be a case of the county being too small (\~60,000 people), causing too much variance in the deaths data.</span>
<span id="cb53-1234"><a href="#cb53-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1237"><a href="#cb53-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-1238"><a href="#cb53-1238" aria-hidden="true" tabindex="-1"></a><span class="co"># had to create a new function that excluded labels, due to consistently 0 pm2.5 days, everything else is the same as previous functions</span></span>
<span id="cb53-1239"><a href="#cb53-1239" aria-hidden="true" tabindex="-1"></a>lakedays <span class="ot">&lt;-</span> airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-1240"><a href="#cb53-1240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(County, Year, <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span>, <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, Cause, <span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1241"><a href="#cb53-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(County <span class="sc">==</span> <span class="st">"Lake"</span> <span class="sc">&amp;</span> <span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> <span class="st">"ALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1242"><a href="#cb53-1242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">PM2.5 Days</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ozone Days</span><span class="st">`</span>), <span class="at">names_to =</span> <span class="st">"Measure"</span>, <span class="at">values_to =</span> <span class="st">"Days"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-1243"><a href="#cb53-1243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Days, <span class="at">col =</span> Measure)) <span class="sc">+</span></span>
<span id="cb53-1244"><a href="#cb53-1244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb53-1245"><a href="#cb53-1245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-1246"><a href="#cb53-1246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-1247"><a href="#cb53-1247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> airqualitycolors) <span class="sc">+</span></span>
<span id="cb53-1248"><a href="#cb53-1248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>)</span>
<span id="cb53-1249"><a href="#cb53-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1250"><a href="#cb53-1250" aria-hidden="true" tabindex="-1"></a>deathttrendlake <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {airqualityanddeaths <span class="sc">%&gt;%</span></span>
<span id="cb53-1251"><a href="#cb53-1251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Strata Name</span><span class="st">`</span> <span class="sc">==</span> <span class="st">"Total Population"</span> <span class="sc">&amp;</span> Cause <span class="sc">==</span> x <span class="sc">&amp;</span> County <span class="sc">==</span> y) <span class="sc">%&gt;%</span></span>
<span id="cb53-1252"><a href="#cb53-1252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Cause) <span class="sc">%&gt;%</span> </span>
<span id="cb53-1253"><a href="#cb53-1253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">ifelse</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span> <span class="sc">%in%</span> <span class="fu">range</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">round</span>(<span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">0</span>), <span class="st">''</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-1254"><a href="#cb53-1254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Deaths per 100,000</span><span class="st">`</span>, <span class="at">col =</span> Cause, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb53-1255"><a href="#cb53-1255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb53-1256"><a href="#cb53-1256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-1257"><a href="#cb53-1257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label_repel</span>(<span class="at">show.legend  =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-1258"><a href="#cb53-1258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_labels =</span> <span class="st">"%y"</span>, <span class="at">date_breaks =</span> <span class="st">"1 year"</span>, <span class="at">name =</span> <span class="st">"Year"</span>) <span class="sc">+</span></span>
<span id="cb53-1259"><a href="#cb53-1259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-1260"><a href="#cb53-1260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> deathcolors) <span class="sc">+</span></span>
<span id="cb53-1261"><a href="#cb53-1261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Lake"</span>, <span class="st">" Deaths per 100,000 and Air Quality Trends"</span>),</span>
<span id="cb53-1262"><a href="#cb53-1262" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="fu">paste0</span>(y, <span class="st">" 2000-2010"</span>)) <span class="sc">+</span></span>
<span id="cb53-1263"><a href="#cb53-1263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Deaths per 100,000"</span>)}</span>
<span id="cb53-1264"><a href="#cb53-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1265"><a href="#cb53-1265" aria-hidden="true" tabindex="-1"></a>laketrendarrange <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">ggarrange</span>(<span class="fu">deathttrendlake</span>(<span class="st">"ALL"</span>, x), lakedays, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb53-1266"><a href="#cb53-1266" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="fu">deathttrendlake</span>(<span class="st">"CLD"</span>, x), lakedays, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb53-1267"><a href="#cb53-1267" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="fu">deathttrendlake</span>(<span class="st">"HTD"</span>, x), lakedays, <span class="at">ncol =</span> <span class="dv">1</span>)}</span>
<span id="cb53-1268"><a href="#cb53-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1269"><a href="#cb53-1269" aria-hidden="true" tabindex="-1"></a><span class="fu">laketrendarrange</span>(<span class="st">"Lake"</span>)</span>
<span id="cb53-1270"><a href="#cb53-1270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-1271"><a href="#cb53-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1272"><a href="#cb53-1272" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusion</span></span>
<span id="cb53-1273"><a href="#cb53-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1274"><a href="#cb53-1274" aria-hidden="true" tabindex="-1"></a>To reiterate, **the goal of my project was to assess whether there is a visual relationship between air quality trends and related causes of death in California for the decade of 2000-2010.** We attempted to answer this question in a couple of ways.</span>
<span id="cb53-1275"><a href="#cb53-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1276"><a href="#cb53-1276" aria-hidden="true" tabindex="-1"></a>**In my analysis of means across all counties, there is a strong visual suggestion that there is a relationship between the trends of air quality (both Ozone and PM2.5) and deaths per 100,000.** This relationship is clearer for all causes of death and deaths by heart disease, and is less clear for chronic lower respiratory disease deaths.</span>
<span id="cb53-1277"><a href="#cb53-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1278"><a href="#cb53-1278" aria-hidden="true" tabindex="-1"></a>I also identified some issues with comparing deaths per 100,000 across counties; Therefore, I looked at intra-county trends as well.</span>
<span id="cb53-1279"><a href="#cb53-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1280"><a href="#cb53-1280" aria-hidden="true" tabindex="-1"></a>**Within counties that had high air quality days (poor air quality), the trend between air quality and deaths per 100,000 was evident, but the more potent air quality type seemed to vary between counties.** Within counties that had low air quality days (good air quality) there was seemingly very little correlation.</span>
<span id="cb53-1281"><a href="#cb53-1281" aria-hidden="true" tabindex="-1"></a>I believe this is overall a positive finding for my hypothesis.</span>
<span id="cb53-1282"><a href="#cb53-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1283"><a href="#cb53-1283" aria-hidden="true" tabindex="-1"></a>**Much more work needs to be done to prove statistical correlation or causation between annual air quality and annual related deaths.** For future analysis, I would hope to determine a way to calculate *excess* deaths per 100,000 that might be attributable to air quality.</span>
<span id="cb53-1284"><a href="#cb53-1284" aria-hidden="true" tabindex="-1"></a>This will allow me to control for many of the "hidden" variables that are skewing the data.</span>
<span id="cb53-1285"><a href="#cb53-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1286"><a href="#cb53-1286" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bibliography</span></span>
<span id="cb53-1287"><a href="#cb53-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1288"><a href="#cb53-1288" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>1<span class="sc">\]</span> Kurt, O. K., Zhang, J., &amp; Pinkerton, K. E.</span>
<span id="cb53-1289"><a href="#cb53-1289" aria-hidden="true" tabindex="-1"></a>(2016).</span>
<span id="cb53-1290"><a href="#cb53-1290" aria-hidden="true" tabindex="-1"></a>Pulmonary health effects of air pollution.</span>
<span id="cb53-1291"><a href="#cb53-1291" aria-hidden="true" tabindex="-1"></a>*Current opinion in pulmonary medicine*, *22*(2), 138--143.</span>
<span id="cb53-1292"><a href="#cb53-1292" aria-hidden="true" tabindex="-1"></a>https://doi.org/10.1097/MCP.0000000000000248</span>
<span id="cb53-1293"><a href="#cb53-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1294"><a href="#cb53-1294" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>2<span class="sc">\]</span> Jonathan J Buonocore *et al* (2023) Air pollution and health impacts of oil &amp; gas production in the United States *Environ. Res.: Health* **1** 021006.</span>
<span id="cb53-1295"><a href="#cb53-1295" aria-hidden="true" tabindex="-1"></a>https://iopscience.iop.org/article/10.1088/2752-5309/acc886</span>
<span id="cb53-1296"><a href="#cb53-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1297"><a href="#cb53-1297" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>3<span class="sc">\]</span> Centers for Disease Control and Prevention (2018).</span>
<span id="cb53-1298"><a href="#cb53-1298" aria-hidden="true" tabindex="-1"></a>*Air Quality Measures on the National Environmental Health Tracking Network, 1999 - 2013,* <span class="sc">\[</span>https://data.cdc.gov/Environmental-Health-Toxicology/Air-Quality-Measures-on-the-National-Environmental/cjae-szjv<span class="sc">\]</span>.</span>
<span id="cb53-1299"><a href="#cb53-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1300"><a href="#cb53-1300" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>4<span class="sc">\]</span> California Health and Human Services (2021).</span>
<span id="cb53-1301"><a href="#cb53-1301" aria-hidden="true" tabindex="-1"></a>*1999-2013 Final Deaths by Year by County*,<span class="sc">\[</span>https://data.chhs.ca.gov/dataset/death-profiles-by-county/resource/e692e6a1-bddd-48ab-a0c8-fa0f1f43e9f4?i</span>
<span id="cb53-1302"><a href="#cb53-1302" aria-hidden="true" tabindex="-1"></a>%20nner_span=True<span class="sc">\]</span>.</span>
<span id="cb53-1303"><a href="#cb53-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1304"><a href="#cb53-1304" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>5<span class="sc">\]</span> United States Census Bureau (2021).</span>
<span id="cb53-1305"><a href="#cb53-1305" aria-hidden="true" tabindex="-1"></a>*County Intercensal Tables: 2000-2010*,<span class="sc">\[</span>https://www.census.gov/data/tables/time-series/demo/popest/intercensal-2000-2010-counties.html<span class="sc">\]</span>.</span>
<span id="cb53-1306"><a href="#cb53-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1307"><a href="#cb53-1307" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>6<span class="sc">\]</span> R Core Team (2022).</span>
<span id="cb53-1308"><a href="#cb53-1308" aria-hidden="true" tabindex="-1"></a>R: A language and environment for statistical computing.</span>
<span id="cb53-1309"><a href="#cb53-1309" aria-hidden="true" tabindex="-1"></a>R Foundation for Statistical Computing, Vienna, Austria.</span>
<span id="cb53-1310"><a href="#cb53-1310" aria-hidden="true" tabindex="-1"></a>URL</span>
<span id="cb53-1311"><a href="#cb53-1311" aria-hidden="true" tabindex="-1"></a>https://www.R-project.org/.</span>
<span id="cb53-1312"><a href="#cb53-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1313"><a href="#cb53-1313" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>7<span class="sc">\]</span> Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM,</span>
<span id="cb53-1314"><a href="#cb53-1314" aria-hidden="true" tabindex="-1"></a> Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019).</span>
<span id="cb53-1315"><a href="#cb53-1315" aria-hidden="true" tabindex="-1"></a>"Welcome to the tidyverse." <span class="sc">\_</span>Journal of</span>
<span id="cb53-1316"><a href="#cb53-1316" aria-hidden="true" tabindex="-1"></a> Open Source Software<span class="sc">\_</span>, <span class="sc">\*</span>4<span class="sc">\*</span>(43), 1686.</span>
<span id="cb53-1317"><a href="#cb53-1317" aria-hidden="true" tabindex="-1"></a>doi:10.21105/joss.01686 <span class="sc">\&lt;</span>https://doi.org/10.21105/joss.01686<span class="sc">\&gt;</span>.</span>
<span id="cb53-1318"><a href="#cb53-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-1319"><a href="#cb53-1319" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>8<span class="sc">\]</span> Becker OScbRA, Minka ARWRvbRBEbTP, Deckmyn.</span>
<span id="cb53-1320"><a href="#cb53-1320" aria-hidden="true" tabindex="-1"></a>A (2022).</span>
<span id="cb53-1321"><a href="#cb53-1321" aria-hidden="true" tabindex="-1"></a><span class="sc">\_</span>maps: Draw Geographical Maps<span class="sc">\_</span>.</span>
<span id="cb53-1322"><a href="#cb53-1322" aria-hidden="true" tabindex="-1"></a>R package version 3.4.1,</span>
<span id="cb53-1323"><a href="#cb53-1323" aria-hidden="true" tabindex="-1"></a><span class="sc">\&lt;</span>https://CRAN.R-project.org/package=maps<span class="sc">\&gt;</span>.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>