<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.427">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shaunak Padhye">
<meta name="dcterms.date" content="2023-05-22">
<meta name="description" content="Project">

<title>Final Project - History of International Futbol (Soccer)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="Final Project - History of International Futbol (Soccer)">
<meta name="twitter:description" content="Project">
<meta name="twitter:image" content="https://dacss.github.io/601_Spring_2023/posts/ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-20-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/DACSS" rel="" target="">
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#describe-the-data-set" id="toc-describe-the-data-set" class="nav-link" data-scroll-target="#describe-the-data-set">Describe the data set</a></li>
  <li><a href="#tidy-data-and-mutate-variables-as-needed" id="toc-tidy-data-and-mutate-variables-as-needed" class="nav-link" data-scroll-target="#tidy-data-and-mutate-variables-as-needed">Tidy Data and Mutate Variables (as needed)</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive Statistics</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a>
  <ul class="collapse">
  <li><a href="#effect-of-home-advantage" id="toc-effect-of-home-advantage" class="nav-link" data-scroll-target="#effect-of-home-advantage">Effect of Home Advantage</a></li>
  <li><a href="#impact-of-historical-events" id="toc-impact-of-historical-events" class="nav-link" data-scroll-target="#impact-of-historical-events">Impact of historical events</a></li>
  <li><a href="#analysis-of-penalties" id="toc-analysis-of-penalties" class="nav-link" data-scroll-target="#analysis-of-penalties">Analysis of Penalties</a></li>
  </ul></li>
  <li><a href="#conclusion-and-reflection" id="toc-conclusion-and-reflection" class="nav-link" data-scroll-target="#conclusion-and-reflection">Conclusion and Reflection</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography">Bibliography</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project - History of International Futbol (Soccer)</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">final_Project</div>
    <div class="quarto-category">Shaunak Padhye</div>
    <div class="quarto-category">International Soccer</div>
  </div>
  </div>

<div>
  <div class="description">
    Project
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shaunak Padhye </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 22, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridisLite)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The FIFA 2022 world cup saw some of the best soccer performances that we’ve ever seen, with Lionel Messi finally winning the most prestigious trophy in Soccer. It was a reminder as to why this sport is called the “Beautiful Game” and why so many people all over the world follow it. Soccer has a very rich history with experts saying that modern version began sometime during the 19th Century. This analysis aims to go over the history of International soccer and see what interesting inferences we can derive from the data. This analysis will begin with a brief introduction of the data and tidying of the data for the analysis. Then we will look at the following topics and try to answer a few questions:</p>
<ol type="1">
<li><p>Home Advantage Analysis: The dataset covers international games played from 1872 to 2022, allowing for an in-depth examination of the home advantage phenomenon. By analyzing team performances in home and away matches, I aim to identify the extent and significance of home advantage across different eras and regions.</p></li>
<li><p>Impact of Major World Events on Soccer: I will explore the influence of major world events, such as wars and economic crises, on international soccer. By examining the dataset within the context of historical events, we can uncover how these factors have shaped the sport’s development</p></li>
<li><p>Analysis of Penalties: Penalties have been a major part of the sport and I will demonstrate the impact penalties have on a match.</p></li>
</ol>
</section>
<section id="describe-the-data-set" class="level2">
<h2 class="anchored" data-anchor-id="describe-the-data-set">Describe the data set</h2>
<p>Dataser link: https://www.kaggle.com/datasets/martj42/international-football-results-from-1872-to-2017?select=results.csv</p>
<p>For this project, I will be working with 151 years of International Soccer history: Results and Goal scorers dataset. The International Soccer dataset has 2 files - “results.csv” and “goalscorers.csv”. This dataset contains information about the International matches played from 1872 till 2023, and the players who scored the goals in these matches.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading the data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>goalscorers <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"ShaunakPadhye_FinalProjectData/goalscorers.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"ShaunakPadhye_FinalProjectData/results.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lets start by looking at the results dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dimensions of results dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44557     9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimpse into the results dataset</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [44,557 × 9] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ date      : Date[1:44557], format: "1872-11-30" "1873-03-08" ...
 $ home_team : chr [1:44557] "Scotland" "England" "Scotland" "England" ...
 $ away_team : chr [1:44557] "England" "Scotland" "England" "Scotland" ...
 $ home_score: num [1:44557] 0 4 2 2 3 4 1 0 7 9 ...
 $ away_score: num [1:44557] 0 2 1 2 0 0 3 2 2 0 ...
 $ tournament: chr [1:44557] "Friendly" "Friendly" "Friendly" "Friendly" ...
 $ city      : chr [1:44557] "Glasgow" "London" "Glasgow" "London" ...
 $ country   : chr [1:44557] "Scotland" "England" "Scotland" "England" ...
 $ neutral   : logi [1:44557] FALSE FALSE FALSE FALSE FALSE FALSE ...
 - attr(*, "spec")=
  .. cols(
  ..   date = col_date(format = ""),
  ..   home_team = col_character(),
  ..   away_team = col_character(),
  ..   home_score = col_double(),
  ..   away_score = col_double(),
  ..   tournament = col_character(),
  ..   city = col_character(),
  ..   country = col_character(),
  ..   neutral = col_logical()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>We can see that the results dataset contains 44557 rows, which means that we contain data about 44557 matches.</p>
<p>This dataset has 9 variables: date - date of the match home_team - the name of the home team (country) away_team - the name of the away team (country) home_score - goals scored by the home team away_score - goals scored by the away team tournament - the name of the tournament city - the city where the match was played country - the country where the match was played neutral - TRUE/FALSE, whether the match was played at a neutral venue</p>
<p>Now, lets look at the Goal scorers data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dimensions of goalscorers dataset</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(goalscorers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 41008     8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimpse into the results dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(goalscorers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [41,008 × 8] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ date     : Date[1:41008], format: "1916-07-02" "1916-07-02" ...
 $ home_team: chr [1:41008] "Chile" "Chile" "Chile" "Chile" ...
 $ away_team: chr [1:41008] "Uruguay" "Uruguay" "Uruguay" "Uruguay" ...
 $ team     : chr [1:41008] "Uruguay" "Uruguay" "Uruguay" "Uruguay" ...
 $ scorer   : chr [1:41008] "José Piendibene" "Isabelino Gradín" "Isabelino Gradín" "José Piendibene" ...
 $ minute   : num [1:41008] 44 55 70 75 2 44 60 62 67 75 ...
 $ own_goal : logi [1:41008] FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ penalty  : logi [1:41008] FALSE FALSE FALSE FALSE FALSE FALSE ...
 - attr(*, "spec")=
  .. cols(
  ..   date = col_date(format = ""),
  ..   home_team = col_character(),
  ..   away_team = col_character(),
  ..   team = col_character(),
  ..   scorer = col_character(),
  ..   minute = col_double(),
  ..   own_goal = col_logical(),
  ..   penalty = col_logical()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>The goal scorers dataset contains 41008 rows which suggests that 41008 goals were scored. This number is less than the number of games from the results dataset, which seems strange. We will explore this later in the analysis.</p>
<p>This dataset has 8 variables: date - date of the match home_team - the name of the home team (country) away_team - the name of the away team (country) team - name of the team that scored the goal scorer - name of player who scored the goal own_goal - whether the goal was an own goal penalty - whether the goal was a penalty</p>
</section>
<section id="tidy-data-and-mutate-variables-as-needed" class="level2">
<h2 class="anchored" data-anchor-id="tidy-data-and-mutate-variables-as-needed">Tidy Data and Mutate Variables (as needed)</h2>
<p>Now that we’ve looked at the datasets, lets check if it requires any tidying. We’ll start by checking if the datasets contain any duplicated rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for duplicates in results dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(results[<span class="fu">duplicated</span>(results),])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for duplicates in goalscorers dataset</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(goalscorers[<span class="fu">duplicated</span>(goalscorers),])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81  8</code></pre>
</div>
</div>
<p>Seems like we have 81 duplicated rows in the goal scorers dataset. Lets check the duplicates to investigate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimpse the duplicated rows in goalscorers dataset</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(goalscorers[<span class="fu">duplicated</span>(goalscorers),])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 81
Columns: 8
$ date      &lt;date&gt; 1963-11-26, 1963-11-28, 1963-11-28, 1965-03-14, 1968-01-16,…
$ home_team &lt;chr&gt; "Ghana", "Ethiopia", "Nigeria", "Suriname", "Congo", "Ghana"…
$ away_team &lt;chr&gt; "Ethiopia", "Tunisia", "Sudan", "Trinidad and Tobago", "Ghan…
$ team      &lt;chr&gt; "Ghana", "Ethiopia", "Sudan", "Suriname", "Ghana", "Ghana", …
$ scorer    &lt;chr&gt; "Edward Acquah", "Mengistu Worku", "Nasr Eddin Abbas", "Edmu…
$ minute    &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ own_goal  &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS…
$ penalty   &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALS…</code></pre>
</div>
</div>
<p>As we can see, the minute variable shows NA for all the duplicates. This means that for these matches the minute at which the player scored was not recorded. Therefore, if a player scored more than once in these games, their entries in the row would be duplicated. This issue should go once we handle the NA values.</p>
<p>Lets start by checking NA values in the results dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if results dataset has NA values</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(results))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Now from the previous section we know that the goalscorers dataset contains NA values. Lets check how many NA values are present.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if goalscorers dataset has NA values</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(goalscorers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 307</code></pre>
</div>
</div>
<p>Lets see what variables contain these NA values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking NA values in each column</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">colnames</span>(goalscorers)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (c <span class="cf">in</span> col){</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"NA values in "</span>, c, <span class="st">": "</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(goalscorers[,c]))))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "NA values in date: 0"
[1] "NA values in home_team: 0"
[1] "NA values in away_team: 0"
[1] "NA values in team: 0"
[1] "NA values in scorer: 49"
[1] "NA values in minute: 258"
[1] "NA values in own_goal: 0"
[1] "NA values in penalty: 0"</code></pre>
</div>
</div>
<p>For the NA values in the minutes variable, we do not want to lose this data. For this reason we will replace the NA values with the mean of the minutes variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing NA values with mean value for minute column</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>goalscorers<span class="sc">$</span>minute <span class="ot">&lt;-</span> <span class="fu">na.aggregate</span>(goalscorers<span class="sc">$</span>minute, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since for a few entries the scorer variable is empty we don’t know who scored the goal. We can remove these rows from the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing NA values from scorer column</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>goalscorers <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(goalscorers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking if NA values removed successfully</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(goalscorers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>The datasets have been cleaned and are ready for further processing.</p>
<p>Lets look at the variables in the results dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns in results dataset</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "date"       "home_team"  "away_team"  "home_score" "away_score"
[6] "tournament" "city"       "country"    "neutral"   </code></pre>
</div>
</div>
<p>We can see that we don’t have a variable to tell us which team won the match. We will introduce a new variable called result for this purpose.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding result column in results dataset</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    home_score <span class="sc">&gt;</span> away_score <span class="sc">~</span> <span class="st">"Home Team"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    home_score <span class="sc">&lt;</span> away_score <span class="sc">~</span> <span class="st">"Away Team"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    home_score <span class="sc">==</span> away_score <span class="sc">~</span> <span class="st">"Draw"</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results[, <span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"home_team"</span>,<span class="st">"away_team"</span>,<span class="st">"home_score"</span>,<span class="st">"away_score"</span>,<span class="st">"result"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  date       home_team away_team home_score away_score result   
  &lt;date&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;    
1 1872-11-30 Scotland  England            0          0 Draw     
2 1873-03-08 England   Scotland           4          2 Home Team
3 1874-03-07 Scotland  England            2          1 Home Team
4 1875-03-06 England   Scotland           2          2 Draw     
5 1876-03-04 Scotland  England            3          0 Home Team
6 1876-03-25 Scotland  Wales              4          0 Home Team</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h2>
<p>I’ll start by creating a summary of the results data sets using the summary function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of Results</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      date             home_team          away_team           home_score    
 Min.   :1872-11-30   Length:44557       Length:44557       Min.   : 0.000  
 1st Qu.:1979-06-29   Class :character   Class :character   1st Qu.: 1.000  
 Median :1999-04-28   Mode  :character   Mode  :character   Median : 1.000  
 Mean   :1992-08-13                                         Mean   : 1.739  
 3rd Qu.:2011-06-04                                         3rd Qu.: 2.000  
 Max.   :2023-03-29                                         Max.   :31.000  
   away_score      tournament            city             country         
 Min.   : 0.000   Length:44557       Length:44557       Length:44557      
 1st Qu.: 0.000   Class :character   Class :character   Class :character  
 Median : 1.000   Mode  :character   Mode  :character   Mode  :character  
 Mean   : 1.178                                                           
 3rd Qu.: 2.000                                                           
 Max.   :21.000                                                           
  neutral           result         
 Mode :logical   Length:44557      
 FALSE:33480     Class :character  
 TRUE :11077     Mode  :character  
                                   
                                   
                                   </code></pre>
</div>
</div>
<p>There are few interesting things to note from the above summary.</p>
<p>The first is that the first match in the data set was played on 30th November, 1872 and the latest match was played on 29th March, 2023.</p>
<p>The maximum number of goals scored by a Home Team is 31 and maximum goals scored by an Away Team is 21. These could be errors in the dataset or these matches could have had some extraordinary circumstances that allowed for such a feat.</p>
<p>Lets now look at the number of tournaments that have been occured in International soccer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of unique tournaments in results dataset</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(results<span class="sc">$</span>tournament))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 142</code></pre>
</div>
</div>
<p>There is a wide variety of tournaments that have been played. Some of these tournaments might be region specific, some might be level specific. Qualifying tournamets such as World Cup Qualifiers are also counted.</p>
<p>Lets look at the distribution of the neutral variable using a bar chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for distribution of neutral variable</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> neutral)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Matches on Neutral Grounds"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Neutral Ground"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As we can see a small portion of the matches were played on neutral grounds and most of them were played either on the Home Team ground or the Away Team ground.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of goalscorers dataset</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(goalscorers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      date             home_team          away_team             team          
 Min.   :1916-07-02   Length:40959       Length:40959       Length:40959      
 1st Qu.:1985-10-30   Class :character   Class :character   Class :character  
 Median :2001-06-06   Mode  :character   Mode  :character   Mode  :character  
 Mean   :1996-09-29                                                           
 3rd Qu.:2012-01-29                                                           
 Max.   :2022-12-18                                                           
    scorer              minute        own_goal        penalty       
 Length:40959       Min.   :  1.00   Mode :logical   Mode :logical  
 Class :character   1st Qu.: 28.00   FALSE:40241     FALSE:38274    
 Mode  :character   Median : 51.00   TRUE :718       TRUE :2685     
                    Mean   : 50.02                                  
                    3rd Qu.: 73.00                                  
                    Max.   :122.00                                  </code></pre>
</div>
</div>
<p>For this dataset, the minimum year in the date variable is 1916. This explains the discrepancy between the dimensions of the two datasets. This dataset does not contain the data of the goal scorers for matches from 1872 till 1916.</p>
<p>Now, lets check the distribution of the minute variable to see at what minute in a match the most goals have been scored.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the frequency of the continuous variable</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>frequency_data <span class="ot">&lt;-</span> goalscorers <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(minute) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">frequency =</span> <span class="fu">n</span>())</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe with the frequency data</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>frequency_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> frequency_data<span class="sc">$</span>minute,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">frequency =</span> frequency_data<span class="sc">$</span>frequency</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the line chart</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(frequency_df, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> frequency)) <span class="sc">+</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Goals scored per Minute"</span>, <span class="at">x =</span> <span class="st">"Minute"</span>, <span class="at">y =</span> <span class="st">"Number of Goals"</span>) <span class="sc">+</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above plot we can see that we have two local maximas in the distribution. The first maxima occurs around the 45 minute mark which is when the first half in a soccer game ends. The second maxima occurs around the 90 minute mark, which is when a soccer match ends. This tells us that most goals are scored during critical sections in a match where the team might be in a make or break situation.</p>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization</h2>
<section id="effect-of-home-advantage" class="level3">
<h3 class="anchored" data-anchor-id="effect-of-home-advantage">Effect of Home Advantage</h3>
<p>Now we will look at whether playing on a Home ground gives an advantage to the Home Team.</p>
<p>We’ll start by checking how many games have been played on a home ground rather than a neutral venue. This is controlled by the neutral variable in the results dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of games played on a home ground</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(results <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutral <span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33480    10</code></pre>
</div>
</div>
<p>A total of 33480 matches have been played on the home ground of a team rather than a neutral location.</p>
<p>Lets plot the distribution of wins for the result variable. This will allow us to see how many matches ended with the home team winning and how many for the away team and how many ended in a draw.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of result of match based for matches played on Home Ground</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutral <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date,home_team,away_team) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> result, <span class="at">fill =</span> result)) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Results of matches played on Home Ground"</span>, <span class="at">x =</span> <span class="st">"Result"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here we can see that a significant portion (over half) of the wins come from Home Teams when they’re playing at their Home ground.</p>
<p>We’ll plot the same graph for neutral locations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of result of match based for matches played on neutral Ground</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutral <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date,home_team,away_team) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> result, <span class="at">fill =</span> result)) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Results of matches played on Neutral Ground"</span>, <span class="at">x =</span> <span class="st">"Result"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The difference between the number of wins for Home Team and Away Team is significantly less for matches played at a neutral venue.</p>
<p>We’ll now check if this trend has been followed throughout various decades.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of result by decade for matches played on Home ground</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutral <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(<span class="fu">year</span>(date) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(decade, result) <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(decade), <span class="at">y =</span> n, <span class="at">fill =</span> result)) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Game Results by Decade"</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Decade"</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"viridis"</span>, <span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that a similar distribution has been observed over the decades. This is surprising as due to the ease of travel in the modern age, fans and supporters can travel to support their countries in International games. We would expect this distribution to slightly even out, but this doesn’t seem to be the case.</p>
<p>One possible explanation for this is that the number of matches being played per decade has drastically increased as we can see in the graph below. Due to the sheer volume of games being played it is difficult for fans to go to all the matches their country is playing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of games played per decade</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutral <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(<span class="fu">year</span>(date) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(decade) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(decade), <span class="at">y =</span> n, <span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Games Played by Decade"</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Decade"</span>,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Games"</span>) <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can check which teams have been most successful as the Home Team.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(result <span class="sc">==</span> <span class="st">"Home Team"</span> <span class="sc">&amp;</span> neutral <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(home_team) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_wins =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_wins)) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">dense_rank</span>(<span class="fu">desc</span>(total_wins))) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(home_team, total_wins), <span class="at">y =</span> total_wins, <span class="at">fill =</span> rank)) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Countries with Most Wins as Home Team"</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Wins"</span>) <span class="sc">+</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> viridisLite<span class="sc">::</span><span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">option =</span> <span class="st">"A"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the above graph, we see a lot of expected countries, which have a very rich soccer culture such as England, Germany, France, Italy and Brazil. There are a few surprises as well such as Hungary and the United States.</p>
<p>Conversely, we can check which teams have been most successful as the Away Team.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(result <span class="sc">==</span> <span class="st">"Away Team"</span> <span class="sc">&amp;</span> neutral <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(home_team) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_wins =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_wins)) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">dense_rank</span>(<span class="fu">desc</span>(total_wins))) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(home_team, total_wins), <span class="at">y =</span> total_wins, <span class="at">fill =</span> rank)) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Countries with Most Wins as Away Team"</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Wins"</span>) <span class="sc">+</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> viridisLite<span class="sc">::</span><span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">option =</span> <span class="st">"A"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These results are surprising as most of these countries aren’t known for soccer. You might expect a country having more successful away record being one of the top ranked soccer nations but the result above disabuses us of this notion.</p>
<p>We can check the same result for matches played on neutral grounds. For this we will have to modify the results dataset. The teams playing in each match are split into two variables: Home Team and Away Team. Since we want to group by “team”, we will need to pivot the home_team and away_team into a single variable called “team”. This will allow us to group the data set by team.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>result_pivoted <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(home_team, away_team), <span class="at">names_to =</span> <span class="st">"team_type"</span>, <span class="at">values_to =</span> <span class="st">"team"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">team_type =</span> <span class="fu">ifelse</span>(team_type <span class="sc">==</span> <span class="st">"home_team"</span>, <span class="st">"Home Team"</span>, <span class="st">"Away Team"</span>))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(result_pivoted[, <span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"home_score"</span>,<span class="st">"away_score"</span>,<span class="st">"result"</span>,<span class="st">"team_type"</span>,<span class="st">"team"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  date       home_score away_score result    team_type team    
  &lt;date&gt;          &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;   
1 1872-11-30          0          0 Draw      Home Team Scotland
2 1872-11-30          0          0 Draw      Away Team England 
3 1873-03-08          4          2 Home Team Home Team England 
4 1873-03-08          4          2 Home Team Away Team Scotland
5 1874-03-07          2          1 Home Team Home Team Scotland
6 1874-03-07          2          1 Home Team Away Team England </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>result_pivoted <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(result <span class="sc">==</span> team_type <span class="sc">&amp;</span> neutral <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_wins =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_wins)) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">dense_rank</span>(<span class="fu">desc</span>(total_wins))) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(team, total_wins), <span class="at">y =</span> total_wins, <span class="at">fill =</span> rank)) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Countries with Most Wins on Neutral grounds"</span>,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Wins"</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> viridisLite<span class="sc">::</span><span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">option =</span> <span class="st">"A"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Again we see a few expected countries and few unexpected ones. A possible explanation for countries like Iraq, Saudi Arabia, Indonesia is the political climate in these countries might have prevented them from playing matches at home. For this reason a neutral venue might have been arranged for all those game which might have otherwise been played at their home ground.</p>
</section>
<section id="impact-of-historical-events" class="level3">
<h3 class="anchored" data-anchor-id="impact-of-historical-events">Impact of historical events</h3>
<p>Now we will investigate the impact of major world events on International Soccer.</p>
<p>We’ll start by plotting a line chart for number of matches played per year over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">matches =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> matches)) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Matches Played per Year"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Matches"</span>) <span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1870</span>, <span class="dv">2020</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see from the above graph that there is a general increasing trend in the number of matches played. We will divide the time frame into two parts 1872 to 1950 and 1950 to 2022. We are doing this to examine the trends with more focus.</p>
<p>We will start with examining the data from 1872 to 1950.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">matches =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;</span> <span class="dv">1950</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> matches)) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Matches Played per Year"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Matches"</span>) <span class="sc">+</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1870</span>, <span class="dv">1950</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the above graph, we can see that there are two significant dips in the number of matches being played. These dips (minima) correspond to the years when the two World Wars happened. As we’d expect the World Wars upset the entire balance in global geo-political situation and the number of soccer matches being played also decreased.</p>
<p>Similarly, we will check the trend for years 1950 to 2022.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">matches =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;</span> <span class="dv">1950</span> <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> matches)) <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Matches Played per Year"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Matches"</span>) <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1950</span>, <span class="dv">2022</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see a general increasing trend for the above graph. There are a lot of local maximas and minimas in this graph. The local maximas correspond to when most of the major International tournaments are played. For example, the World Cup is played every 4 years.</p>
<p>We see a massive decrease in the number of matches played for the year 2020. This is the year when the Covid 19 pandemic struck the world and everyone was forced to quarantine. As expected even soccer felt the ramifications of this.</p>
<p>The trend from years 1950 till 1980 is very erratic. These were the years when there was Cold War going on between the United States of America and Russia, which might be one of the reasons for that trend.</p>
</section>
<section id="analysis-of-penalties" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-penalties">Analysis of Penalties</h3>
<p>Finally we will look at Penalties and see how they affect the game. Penalties are given to a team if they are fouled near the opponent’s goal. The team then gets the opportunity to score goal from a certain distance with only the goal keeper in the way. Penalties are also used as deciders in case a match ends up as a draw.</p>
<p>Lets see which countries have been most successful at scoring penalties.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by and summarize goalscorers dataset to find out top 10 teams with most penalties</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>penalty_analysis <span class="ot">&lt;-</span> goalscorers <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(penalty <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">%&gt;%</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_penalties =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_penalties)) <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the top 10 teams with the most penalties</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(penalty_analysis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   team        total_penalties
   &lt;chr&gt;                 &lt;int&gt;
 1 Brazil                   64
 2 Mexico                   60
 3 Argentina                58
 4 Netherlands              52
 5 Spain                    52
 6 Germany                  51
 7 England                  50
 8 Sweden                   50
 9 Denmark                  47
10 Uruguay                  46</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar chart of the top 10 teams with the most penalties</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penalty_analysis, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(team, total_penalties), <span class="at">y =</span> total_penalties)) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Teams with the Most Penalties"</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Team"</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Penalties"</span>) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now we’ll check how penalties affect the outcome of a game. For this analysis we will have to merge the results and the goalscorers datasets. This because the match outcome data is stored in the results dataset and the penalty data is stored in the goalscorers dataset. We can uniquely identify a match based on the date and the two teams that played the game. We will join the two datasets using these three variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging results and goalscorers datasets</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>merged_results <span class="ot">&lt;-</span> <span class="fu">merge</span>(results,goalscorers , <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"home_team"</span>, <span class="st">"away_team"</span>))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(merged_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        date home_team away_team home_score away_score   tournament
1 1916-07-02     Chile   Uruguay          0          4 Copa América
2 1916-07-02     Chile   Uruguay          0          4 Copa América
3 1916-07-02     Chile   Uruguay          0          4 Copa América
4 1916-07-02     Chile   Uruguay          0          4 Copa América
5 1916-07-06 Argentina     Chile          6          1 Copa América
6 1916-07-06 Argentina     Chile          6          1 Copa América
          city   country neutral    result      team           scorer minute
1 Buenos Aires Argentina    TRUE Away Team   Uruguay  José Piendibene     44
2 Buenos Aires Argentina    TRUE Away Team   Uruguay Isabelino Gradín     55
3 Buenos Aires Argentina    TRUE Away Team   Uruguay Isabelino Gradín     70
4 Buenos Aires Argentina    TRUE Away Team   Uruguay  José Piendibene     75
5 Buenos Aires Argentina   FALSE Home Team Argentina    Alberto Ohaco      2
6 Buenos Aires Argentina   FALSE Home Team     Chile   Telésforo Báez     44
  own_goal penalty
1    FALSE   FALSE
2    FALSE   FALSE
3    FALSE   FALSE
4    FALSE   FALSE
5    FALSE   FALSE
6    FALSE   FALSE</code></pre>
</div>
</div>
<p>Lets look at the impact of penalties on the outcome of matches.</p>
<p>We will calculate the number of games where the home team scored a penalty and won the game and the number of games where the home team scored a penalty but lost the game. Then we will create a pie chart to show the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of penalties scored by home team where Home team won the match</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>home_penalties <span class="ot">&lt;-</span> merged_results <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(penalty <span class="sc">&amp;</span> home_team <span class="sc">==</span> team <span class="sc">&amp;</span> result <span class="sc">==</span> <span class="st">"Home Team"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>home_penalties</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1237</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of penalties scored by home team where Away team won the match</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>home_penalties_l <span class="ot">&lt;-</span> merged_results <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(penalty <span class="sc">&amp;</span> home_team <span class="sc">==</span> team <span class="sc">&amp;</span> result <span class="sc">==</span> <span class="st">"Away Team"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>home_penalties_l</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 225</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding data to a dataframe</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">category =</span> <span class="fu">c</span>(<span class="st">"Wins with Penalty"</span>, <span class="st">"Losses with Penalty"</span>),</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">count =</span> <span class="fu">c</span>(home_penalties, home_penalties_l))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the pie chart</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> count, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Penalties Distribution"</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Category"</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ShaunakPadhye_FinalProject_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As we can see, matches where a team took a penalty, most likely that team ended up winning the match.</p>
</section>
</section>
<section id="conclusion-and-reflection" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-and-reflection">Conclusion and Reflection</h2>
<p>The visualizations in the “Home Advantage” section provide validation that playing at a home ground does provide an advantage to the Home Team. However, I don’t believe this is a bad thing. Fans of the sport are very passionate about the teams that they support and having their team play in their home ground allows these fans to show their support. At the same time these tournaments should be scheduled so that some teams aren’t getting an unfair advantage in the overall tournament. It would be interesting to see how players individually are impacted by playing at home or away and if we could classify players accordingly.</p>
<p>In the second part of the analysis, I got the same results as expected. Soccer is majorly impacted by World events such as Wars and Pandemics. But the sport is also able to recover from this. As we can see the sport has grown a lot in 150 years. A similar analysis for a single country might be able to give us an insight on how the socio-political conditions there affect their participation in International Soccer.</p>
<p>Finally, we did a brief analysis of penalties. We can surmise that penalties play a major role in deciding the outcome of games. There has been a lot of debate regarding alternatives to penalties to make the game more balanced. I believe that having the threat of giving away a penalty keeps the defenders of the teams in check as they risk losing a goal.</p>
</section>
<section id="bibliography" class="level2">
<h2 class="anchored" data-anchor-id="bibliography">Bibliography</h2>
<p>International Soccer dataset: https://www.kaggle.com/datasets/martj42/international-football-results-from-1872-to-2017?select=results.csv</p>
<p>History of Football (Soccer): https://www.footballhistory.org/</p>
<p>Key events of the 20th century: https://en.wikipedia.org/wiki/Key_events_of_the_20th_century</p>
<p>R Language as programming language</p>
<p>Wickham, H., &amp; Grolemund, G. (2016). R for data science: Visualize, model, transform, tidy, and import data. OReilly Media.</p>
<p>The R Graph Gallery-https://r-graph-gallery.com/</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/601_Spring_2023" data-repo-id="R_kgDOI4JcJA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb63" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project - History of International Futbol (Soccer)"</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Shaunak Padhye"</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Project"</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "05/22/2023"</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - final_Project</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - Shaunak Padhye</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - International Soccer</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: inline</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridisLite)</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>The FIFA 2022 world cup saw some of the best soccer performances that we've ever seen, with Lionel Messi finally winning the most prestigious trophy in Soccer. It was a reminder as to why this sport is called the "Beautiful Game" and why so many people all over the world follow it. Soccer has a very rich history with experts saying that modern version began sometime during the 19th Century. This analysis aims to go over the history of International soccer and see what interesting inferences we can derive from the data. This analysis will begin with a brief introduction of the data and tidying of the data for the analysis. Then we will look at the following topics and try to answer a few questions:</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>1) Home Advantage Analysis:</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>The dataset covers international games played from 1872 to 2022, allowing for an in-depth examination of the home advantage phenomenon. By analyzing team performances in home and away matches, I aim to identify the extent and significance of home advantage across different eras and regions.</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>2) Impact of Major World Events on Soccer:</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>I will explore the influence of major world events, such as wars and economic crises, on international soccer. By examining the dataset within the context of historical events, we can uncover how these factors have shaped the sport's development</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>3) Analysis of Penalties:</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>Penalties have been a major part of the sport and I will demonstrate the impact penalties have on a match.</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a><span class="fu">## Describe the data set</span></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>Dataser link:</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>https://www.kaggle.com/datasets/martj42/international-football-results-from-1872-to-2017?select=results.csv</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>For this project, I will be working with 151 years of International Soccer history: Results and Goal scorers dataset. The International Soccer dataset has 2 files - "results.csv" and "goalscorers.csv". This dataset contains information about the International matches played from 1872 till 2023, and the players who scored the goals in these matches.</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading the data</span></span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>goalscorers <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"ShaunakPadhye_FinalProjectData/goalscorers.csv"</span>)</span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"ShaunakPadhye_FinalProjectData/results.csv"</span>)</span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>Lets start by looking at the results dataset.</span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Dimensions of results dataset</span></span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(results)</span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimpse into the results dataset</span></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(results)</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>We can see that the results dataset contains 44557 rows, which means that we contain data about 44557 matches.</span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>This dataset has 9 variables:</span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a>date - date of the match</span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a>home_team - the name of the home team (country)</span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a>away_team - the name of the away team (country)</span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>home_score - goals scored by the home team</span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a>away_score - goals scored by the away team</span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a>tournament - the name of the tournament</span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a>city - the city where the match was played</span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a>country - the country where the match was played</span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a>neutral - TRUE/FALSE, whether the match was played at a neutral venue</span>
<span id="cb63-93"><a href="#cb63-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-94"><a href="#cb63-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-95"><a href="#cb63-95" aria-hidden="true" tabindex="-1"></a>Now, lets look at the Goal scorers data set.</span>
<span id="cb63-96"><a href="#cb63-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-99"><a href="#cb63-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-100"><a href="#cb63-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Dimensions of goalscorers dataset</span></span>
<span id="cb63-101"><a href="#cb63-101" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(goalscorers)</span>
<span id="cb63-102"><a href="#cb63-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-105"><a href="#cb63-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-106"><a href="#cb63-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimpse into the results dataset</span></span>
<span id="cb63-107"><a href="#cb63-107" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(goalscorers)</span>
<span id="cb63-108"><a href="#cb63-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-109"><a href="#cb63-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-110"><a href="#cb63-110" aria-hidden="true" tabindex="-1"></a>The goal scorers dataset contains 41008 rows which suggests that 41008 goals were scored. This number is less than the number of games from the results dataset, which seems strange. We will explore this later in the analysis.</span>
<span id="cb63-111"><a href="#cb63-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-112"><a href="#cb63-112" aria-hidden="true" tabindex="-1"></a>This dataset has 8 variables:</span>
<span id="cb63-113"><a href="#cb63-113" aria-hidden="true" tabindex="-1"></a>date - date of the match</span>
<span id="cb63-114"><a href="#cb63-114" aria-hidden="true" tabindex="-1"></a>home_team - the name of the home team (country)</span>
<span id="cb63-115"><a href="#cb63-115" aria-hidden="true" tabindex="-1"></a>away_team - the name of the away team (country)</span>
<span id="cb63-116"><a href="#cb63-116" aria-hidden="true" tabindex="-1"></a>team - name of the team that scored the goal</span>
<span id="cb63-117"><a href="#cb63-117" aria-hidden="true" tabindex="-1"></a>scorer - name of player who scored the goal</span>
<span id="cb63-118"><a href="#cb63-118" aria-hidden="true" tabindex="-1"></a>own_goal - whether the goal was an own goal</span>
<span id="cb63-119"><a href="#cb63-119" aria-hidden="true" tabindex="-1"></a>penalty - whether the goal was a penalty</span>
<span id="cb63-120"><a href="#cb63-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-121"><a href="#cb63-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-122"><a href="#cb63-122" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tidy Data and Mutate Variables (as needed)</span></span>
<span id="cb63-123"><a href="#cb63-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-124"><a href="#cb63-124" aria-hidden="true" tabindex="-1"></a>Now that we've looked at the datasets, lets check if it requires any tidying. We'll start by checking if the datasets contain any duplicated rows.</span>
<span id="cb63-125"><a href="#cb63-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-128"><a href="#cb63-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-129"><a href="#cb63-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for duplicates in results dataset</span></span>
<span id="cb63-130"><a href="#cb63-130" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(results[<span class="fu">duplicated</span>(results),])</span>
<span id="cb63-131"><a href="#cb63-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-132"><a href="#cb63-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-135"><a href="#cb63-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-136"><a href="#cb63-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for duplicates in goalscorers dataset</span></span>
<span id="cb63-137"><a href="#cb63-137" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(goalscorers[<span class="fu">duplicated</span>(goalscorers),])</span>
<span id="cb63-138"><a href="#cb63-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-139"><a href="#cb63-139" aria-hidden="true" tabindex="-1"></a>Seems like we have 81 duplicated rows in the goal scorers dataset. Lets check the duplicates to investigate.</span>
<span id="cb63-140"><a href="#cb63-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-143"><a href="#cb63-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-144"><a href="#cb63-144" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimpse the duplicated rows in goalscorers dataset</span></span>
<span id="cb63-145"><a href="#cb63-145" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(goalscorers[<span class="fu">duplicated</span>(goalscorers),])</span>
<span id="cb63-146"><a href="#cb63-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-147"><a href="#cb63-147" aria-hidden="true" tabindex="-1"></a>As we can see, the minute variable shows NA for all the duplicates. This means that for these matches the minute at which the player scored was not recorded. Therefore, if a player scored more than once in these games, their entries in the row would be duplicated. This issue should go once we handle the NA values.</span>
<span id="cb63-148"><a href="#cb63-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-149"><a href="#cb63-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-150"><a href="#cb63-150" aria-hidden="true" tabindex="-1"></a>Lets start by checking NA values in the results dataset.</span>
<span id="cb63-151"><a href="#cb63-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-154"><a href="#cb63-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-155"><a href="#cb63-155" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if results dataset has NA values</span></span>
<span id="cb63-156"><a href="#cb63-156" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(results))</span>
<span id="cb63-157"><a href="#cb63-157" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-158"><a href="#cb63-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-159"><a href="#cb63-159" aria-hidden="true" tabindex="-1"></a>Now from the previous section we know that the goalscorers dataset contains NA values. Lets check how many NA values are present.</span>
<span id="cb63-160"><a href="#cb63-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-163"><a href="#cb63-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-164"><a href="#cb63-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if goalscorers dataset has NA values</span></span>
<span id="cb63-165"><a href="#cb63-165" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(goalscorers))</span>
<span id="cb63-166"><a href="#cb63-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-167"><a href="#cb63-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-168"><a href="#cb63-168" aria-hidden="true" tabindex="-1"></a>Lets see what variables contain these NA values</span>
<span id="cb63-171"><a href="#cb63-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-172"><a href="#cb63-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking NA values in each column</span></span>
<span id="cb63-173"><a href="#cb63-173" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">colnames</span>(goalscorers)</span>
<span id="cb63-174"><a href="#cb63-174" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (c <span class="cf">in</span> col){</span>
<span id="cb63-175"><a href="#cb63-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"NA values in "</span>, c, <span class="st">": "</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(goalscorers[,c]))))</span>
<span id="cb63-176"><a href="#cb63-176" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-177"><a href="#cb63-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-178"><a href="#cb63-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-179"><a href="#cb63-179" aria-hidden="true" tabindex="-1"></a>For the NA values in the minutes variable, we do not want to lose this data. For this reason we will replace the NA values with the mean of the minutes variable.</span>
<span id="cb63-180"><a href="#cb63-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-183"><a href="#cb63-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-184"><a href="#cb63-184" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing NA values with mean value for minute column</span></span>
<span id="cb63-185"><a href="#cb63-185" aria-hidden="true" tabindex="-1"></a>goalscorers<span class="sc">$</span>minute <span class="ot">&lt;-</span> <span class="fu">na.aggregate</span>(goalscorers<span class="sc">$</span>minute, <span class="at">FUN =</span> mean)</span>
<span id="cb63-186"><a href="#cb63-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-187"><a href="#cb63-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-188"><a href="#cb63-188" aria-hidden="true" tabindex="-1"></a>Since for a few entries the scorer variable is empty we don't know who scored the goal. We can remove these rows from the dataset.</span>
<span id="cb63-191"><a href="#cb63-191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-192"><a href="#cb63-192" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing NA values from scorer column</span></span>
<span id="cb63-193"><a href="#cb63-193" aria-hidden="true" tabindex="-1"></a>goalscorers <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(goalscorers)</span>
<span id="cb63-194"><a href="#cb63-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-195"><a href="#cb63-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-196"><a href="#cb63-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-199"><a href="#cb63-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-200"><a href="#cb63-200" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking if NA values removed successfully</span></span>
<span id="cb63-201"><a href="#cb63-201" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(goalscorers))</span>
<span id="cb63-202"><a href="#cb63-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-203"><a href="#cb63-203" aria-hidden="true" tabindex="-1"></a>The datasets have been cleaned and are ready for further processing.</span>
<span id="cb63-204"><a href="#cb63-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-205"><a href="#cb63-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-206"><a href="#cb63-206" aria-hidden="true" tabindex="-1"></a>Lets look at the variables in the results dataset.</span>
<span id="cb63-207"><a href="#cb63-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-210"><a href="#cb63-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-211"><a href="#cb63-211" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns in results dataset</span></span>
<span id="cb63-212"><a href="#cb63-212" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(results)</span>
<span id="cb63-213"><a href="#cb63-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-214"><a href="#cb63-214" aria-hidden="true" tabindex="-1"></a>We can see that we don't have a variable to tell us which team won the match. We will introduce a new variable called result for this purpose.</span>
<span id="cb63-215"><a href="#cb63-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-218"><a href="#cb63-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-219"><a href="#cb63-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding result column in results dataset</span></span>
<span id="cb63-220"><a href="#cb63-220" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb63-221"><a href="#cb63-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result =</span> <span class="fu">case_when</span>(</span>
<span id="cb63-222"><a href="#cb63-222" aria-hidden="true" tabindex="-1"></a>    home_score <span class="sc">&gt;</span> away_score <span class="sc">~</span> <span class="st">"Home Team"</span>,</span>
<span id="cb63-223"><a href="#cb63-223" aria-hidden="true" tabindex="-1"></a>    home_score <span class="sc">&lt;</span> away_score <span class="sc">~</span> <span class="st">"Away Team"</span>,</span>
<span id="cb63-224"><a href="#cb63-224" aria-hidden="true" tabindex="-1"></a>    home_score <span class="sc">==</span> away_score <span class="sc">~</span> <span class="st">"Draw"</span></span>
<span id="cb63-225"><a href="#cb63-225" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb63-226"><a href="#cb63-226" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(results[, <span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"home_team"</span>,<span class="st">"away_team"</span>,<span class="st">"home_score"</span>,<span class="st">"away_score"</span>,<span class="st">"result"</span>)])</span>
<span id="cb63-227"><a href="#cb63-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-228"><a href="#cb63-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-229"><a href="#cb63-229" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive Statistics</span></span>
<span id="cb63-230"><a href="#cb63-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-231"><a href="#cb63-231" aria-hidden="true" tabindex="-1"></a>I'll start by creating a summary of the results data sets using the summary function</span>
<span id="cb63-232"><a href="#cb63-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-235"><a href="#cb63-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-236"><a href="#cb63-236" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of Results</span></span>
<span id="cb63-237"><a href="#cb63-237" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span>
<span id="cb63-238"><a href="#cb63-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-239"><a href="#cb63-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-240"><a href="#cb63-240" aria-hidden="true" tabindex="-1"></a>There are few interesting things to note from the above summary.</span>
<span id="cb63-241"><a href="#cb63-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-242"><a href="#cb63-242" aria-hidden="true" tabindex="-1"></a>The first is that the first match in the data set was played on 30th November, 1872 and the latest match was played on 29th March, 2023.</span>
<span id="cb63-243"><a href="#cb63-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-244"><a href="#cb63-244" aria-hidden="true" tabindex="-1"></a>The maximum number of goals scored by a Home Team is 31 and maximum goals scored by an Away Team is 21. These could be errors in the dataset or these matches could have had some extraordinary circumstances that allowed for such a feat.</span>
<span id="cb63-245"><a href="#cb63-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-246"><a href="#cb63-246" aria-hidden="true" tabindex="-1"></a>Lets now look at the number of tournaments that have been occured in International soccer:</span>
<span id="cb63-249"><a href="#cb63-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-250"><a href="#cb63-250" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of unique tournaments in results dataset</span></span>
<span id="cb63-251"><a href="#cb63-251" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(results<span class="sc">$</span>tournament))</span>
<span id="cb63-252"><a href="#cb63-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-253"><a href="#cb63-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-254"><a href="#cb63-254" aria-hidden="true" tabindex="-1"></a>There is a wide variety of tournaments that have been played. Some of these tournaments might be region specific, some might be level specific. Qualifying tournamets such as World Cup Qualifiers are also counted.</span>
<span id="cb63-255"><a href="#cb63-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-256"><a href="#cb63-256" aria-hidden="true" tabindex="-1"></a>Lets look at the distribution of the neutral variable using a bar chart.</span>
<span id="cb63-259"><a href="#cb63-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-260"><a href="#cb63-260" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for distribution of neutral variable</span></span>
<span id="cb63-261"><a href="#cb63-261" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results, <span class="fu">aes</span>(<span class="at">x =</span> neutral)) <span class="sc">+</span></span>
<span id="cb63-262"><a href="#cb63-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb63-263"><a href="#cb63-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Matches on Neutral Grounds"</span>,</span>
<span id="cb63-264"><a href="#cb63-264" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Neutral Ground"</span>,</span>
<span id="cb63-265"><a href="#cb63-265" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb63-266"><a href="#cb63-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-267"><a href="#cb63-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb63-268"><a href="#cb63-268" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb63-269"><a href="#cb63-269" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb63-270"><a href="#cb63-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-271"><a href="#cb63-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-272"><a href="#cb63-272" aria-hidden="true" tabindex="-1"></a>As we can see a small portion of the matches were played on neutral grounds and most of them were played either on the Home Team ground or the Away Team ground.</span>
<span id="cb63-273"><a href="#cb63-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-274"><a href="#cb63-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-277"><a href="#cb63-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-278"><a href="#cb63-278" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of goalscorers dataset</span></span>
<span id="cb63-279"><a href="#cb63-279" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(goalscorers)</span>
<span id="cb63-280"><a href="#cb63-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-281"><a href="#cb63-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-282"><a href="#cb63-282" aria-hidden="true" tabindex="-1"></a>For this dataset, the minimum year in the date variable is 1916. This explains the discrepancy between the dimensions of the two datasets. This dataset does not contain the data of the goal scorers for matches from 1872 till 1916.</span>
<span id="cb63-283"><a href="#cb63-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-284"><a href="#cb63-284" aria-hidden="true" tabindex="-1"></a>Now, lets check the distribution of the minute variable to see at what minute in a match the most goals have been scored.</span>
<span id="cb63-285"><a href="#cb63-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-288"><a href="#cb63-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-289"><a href="#cb63-289" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the frequency of the continuous variable</span></span>
<span id="cb63-290"><a href="#cb63-290" aria-hidden="true" tabindex="-1"></a>frequency_data <span class="ot">&lt;-</span> goalscorers <span class="sc">%&gt;%</span></span>
<span id="cb63-291"><a href="#cb63-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(minute) <span class="sc">%&gt;%</span></span>
<span id="cb63-292"><a href="#cb63-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">frequency =</span> <span class="fu">n</span>())</span>
<span id="cb63-293"><a href="#cb63-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-294"><a href="#cb63-294" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe with the frequency data</span></span>
<span id="cb63-295"><a href="#cb63-295" aria-hidden="true" tabindex="-1"></a>frequency_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb63-296"><a href="#cb63-296" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> frequency_data<span class="sc">$</span>minute,</span>
<span id="cb63-297"><a href="#cb63-297" aria-hidden="true" tabindex="-1"></a>  <span class="at">frequency =</span> frequency_data<span class="sc">$</span>frequency</span>
<span id="cb63-298"><a href="#cb63-298" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-299"><a href="#cb63-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-300"><a href="#cb63-300" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the line chart</span></span>
<span id="cb63-301"><a href="#cb63-301" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(frequency_df, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> frequency)) <span class="sc">+</span></span>
<span id="cb63-302"><a href="#cb63-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-303"><a href="#cb63-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Goals scored per Minute"</span>, <span class="at">x =</span> <span class="st">"Minute"</span>, <span class="at">y =</span> <span class="st">"Number of Goals"</span>) <span class="sc">+</span></span>
<span id="cb63-304"><a href="#cb63-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb63-305"><a href="#cb63-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-306"><a href="#cb63-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-307"><a href="#cb63-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-308"><a href="#cb63-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-309"><a href="#cb63-309" aria-hidden="true" tabindex="-1"></a>From the above plot we can see that we have two local maximas in the distribution. The first maxima occurs around the 45 minute mark which is when the first half in a soccer game ends. The second maxima occurs around the 90 minute mark, which is when a soccer match ends. This tells us that most goals are scored during critical sections in a match where the team might be in a make or break situation.</span>
<span id="cb63-310"><a href="#cb63-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-311"><a href="#cb63-311" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualization</span></span>
<span id="cb63-312"><a href="#cb63-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-313"><a href="#cb63-313" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effect of Home Advantage</span></span>
<span id="cb63-314"><a href="#cb63-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-315"><a href="#cb63-315" aria-hidden="true" tabindex="-1"></a>Now we will look at whether playing on a Home ground gives an advantage to the Home Team.</span>
<span id="cb63-316"><a href="#cb63-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-317"><a href="#cb63-317" aria-hidden="true" tabindex="-1"></a>We'll start by checking how many games have been played on a home ground rather than a neutral venue. This is controlled by the neutral variable in the results dataset.</span>
<span id="cb63-318"><a href="#cb63-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-321"><a href="#cb63-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-322"><a href="#cb63-322" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of games played on a home ground</span></span>
<span id="cb63-323"><a href="#cb63-323" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(results <span class="sc">%&gt;%</span> </span>
<span id="cb63-324"><a href="#cb63-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutral <span class="sc">==</span> <span class="cn">FALSE</span>))</span>
<span id="cb63-325"><a href="#cb63-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-326"><a href="#cb63-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-327"><a href="#cb63-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-328"><a href="#cb63-328" aria-hidden="true" tabindex="-1"></a>A total of 33480 matches have been played on the home ground of a team rather than a neutral location.</span>
<span id="cb63-329"><a href="#cb63-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-330"><a href="#cb63-330" aria-hidden="true" tabindex="-1"></a>Lets plot the distribution of wins for the result variable. This will allow us to see how many matches ended with the home team winning and how many for the away team and how many ended in a draw.</span>
<span id="cb63-331"><a href="#cb63-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-334"><a href="#cb63-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-335"><a href="#cb63-335" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of result of match based for matches played on Home Ground</span></span>
<span id="cb63-336"><a href="#cb63-336" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb63-337"><a href="#cb63-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutral <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-338"><a href="#cb63-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date,home_team,away_team) <span class="sc">%&gt;%</span></span>
<span id="cb63-339"><a href="#cb63-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> result, <span class="at">fill =</span> result)) <span class="sc">+</span></span>
<span id="cb63-340"><a href="#cb63-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb63-341"><a href="#cb63-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Results of matches played on Home Ground"</span>, <span class="at">x =</span> <span class="st">"Result"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb63-342"><a href="#cb63-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-343"><a href="#cb63-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb63-344"><a href="#cb63-344" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb63-345"><a href="#cb63-345" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb63-346"><a href="#cb63-346" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb63-347"><a href="#cb63-347" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb63-348"><a href="#cb63-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb63-349"><a href="#cb63-349" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-350"><a href="#cb63-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-351"><a href="#cb63-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-352"><a href="#cb63-352" aria-hidden="true" tabindex="-1"></a>Here we can see that a significant portion (over half) of the wins come from Home Teams when they're playing at their Home ground.</span>
<span id="cb63-353"><a href="#cb63-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-354"><a href="#cb63-354" aria-hidden="true" tabindex="-1"></a>We'll plot the same graph for neutral locations.</span>
<span id="cb63-355"><a href="#cb63-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-358"><a href="#cb63-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-359"><a href="#cb63-359" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of result of match based for matches played on neutral Ground</span></span>
<span id="cb63-360"><a href="#cb63-360" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span> </span>
<span id="cb63-361"><a href="#cb63-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutral <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-362"><a href="#cb63-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date,home_team,away_team) <span class="sc">%&gt;%</span></span>
<span id="cb63-363"><a href="#cb63-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> result, <span class="at">fill =</span> result)) <span class="sc">+</span></span>
<span id="cb63-364"><a href="#cb63-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb63-365"><a href="#cb63-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Results of matches played on Neutral Ground"</span>, <span class="at">x =</span> <span class="st">"Result"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb63-366"><a href="#cb63-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-367"><a href="#cb63-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb63-368"><a href="#cb63-368" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb63-369"><a href="#cb63-369" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb63-370"><a href="#cb63-370" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb63-371"><a href="#cb63-371" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb63-372"><a href="#cb63-372" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb63-373"><a href="#cb63-373" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-374"><a href="#cb63-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-375"><a href="#cb63-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-376"><a href="#cb63-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-377"><a href="#cb63-377" aria-hidden="true" tabindex="-1"></a>The difference between the number of wins for Home Team and Away Team is significantly less for matches played at a neutral venue.</span>
<span id="cb63-378"><a href="#cb63-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-379"><a href="#cb63-379" aria-hidden="true" tabindex="-1"></a>We'll now check if this trend has been followed throughout various decades.</span>
<span id="cb63-382"><a href="#cb63-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-383"><a href="#cb63-383" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of result by decade for matches played on Home ground</span></span>
<span id="cb63-384"><a href="#cb63-384" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb63-385"><a href="#cb63-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutral <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-386"><a href="#cb63-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(<span class="fu">year</span>(date) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-387"><a href="#cb63-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(decade, result) <span class="sc">%&gt;%</span></span>
<span id="cb63-388"><a href="#cb63-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-389"><a href="#cb63-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(decade), <span class="at">y =</span> n, <span class="at">fill =</span> result)) <span class="sc">+</span></span>
<span id="cb63-390"><a href="#cb63-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>, <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb63-391"><a href="#cb63-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Game Results by Decade"</span>,</span>
<span id="cb63-392"><a href="#cb63-392" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Decade"</span>,</span>
<span id="cb63-393"><a href="#cb63-393" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb63-394"><a href="#cb63-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"viridis"</span>, <span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb63-395"><a href="#cb63-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb63-396"><a href="#cb63-396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-397"><a href="#cb63-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-398"><a href="#cb63-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-399"><a href="#cb63-399" aria-hidden="true" tabindex="-1"></a>We can see that a similar distribution has been observed over the decades. This is surprising as due to the ease of travel in the modern age, fans and supporters can travel to support their countries in International games. We would expect this distribution to slightly even out, but this doesn't seem to be the case.</span>
<span id="cb63-400"><a href="#cb63-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-401"><a href="#cb63-401" aria-hidden="true" tabindex="-1"></a>One possible explanation for this is that the number of matches being played per decade has drastically increased as we can see in the graph below. Due to the sheer volume of games being played it is difficult for fans to go to all the matches their country is playing.</span>
<span id="cb63-402"><a href="#cb63-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-405"><a href="#cb63-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-406"><a href="#cb63-406" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of games played per decade</span></span>
<span id="cb63-407"><a href="#cb63-407" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb63-408"><a href="#cb63-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutral <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-409"><a href="#cb63-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(<span class="fu">year</span>(date) <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-410"><a href="#cb63-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(decade) <span class="sc">%&gt;%</span></span>
<span id="cb63-411"><a href="#cb63-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-412"><a href="#cb63-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(decade), <span class="at">y =</span> n, <span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb63-413"><a href="#cb63-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb63-414"><a href="#cb63-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Games Played by Decade"</span>,</span>
<span id="cb63-415"><a href="#cb63-415" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Decade"</span>,</span>
<span id="cb63-416"><a href="#cb63-416" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of Games"</span>) <span class="sc">+</span></span>
<span id="cb63-417"><a href="#cb63-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb63-418"><a href="#cb63-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-419"><a href="#cb63-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-420"><a href="#cb63-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-421"><a href="#cb63-421" aria-hidden="true" tabindex="-1"></a>We can check which teams have been most successful as the Home Team.</span>
<span id="cb63-422"><a href="#cb63-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-425"><a href="#cb63-425" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-426"><a href="#cb63-426" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb63-427"><a href="#cb63-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(result <span class="sc">==</span> <span class="st">"Home Team"</span> <span class="sc">&amp;</span> neutral <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-428"><a href="#cb63-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(home_team) <span class="sc">%&gt;%</span></span>
<span id="cb63-429"><a href="#cb63-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_wins =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb63-430"><a href="#cb63-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_wins)) <span class="sc">%&gt;%</span></span>
<span id="cb63-431"><a href="#cb63-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-432"><a href="#cb63-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">dense_rank</span>(<span class="fu">desc</span>(total_wins))) <span class="sc">%&gt;%</span></span>
<span id="cb63-433"><a href="#cb63-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(home_team, total_wins), <span class="at">y =</span> total_wins, <span class="at">fill =</span> rank)) <span class="sc">+</span></span>
<span id="cb63-434"><a href="#cb63-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb63-435"><a href="#cb63-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Countries with Most Wins as Home Team"</span>,</span>
<span id="cb63-436"><a href="#cb63-436" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb63-437"><a href="#cb63-437" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Wins"</span>) <span class="sc">+</span></span>
<span id="cb63-438"><a href="#cb63-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> viridisLite<span class="sc">::</span><span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">option =</span> <span class="st">"A"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb63-439"><a href="#cb63-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-440"><a href="#cb63-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb63-441"><a href="#cb63-441" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb63-442"><a href="#cb63-442" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb63-443"><a href="#cb63-443" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb63-444"><a href="#cb63-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb63-445"><a href="#cb63-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb63-446"><a href="#cb63-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-447"><a href="#cb63-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-448"><a href="#cb63-448" aria-hidden="true" tabindex="-1"></a>From the above graph, we see a lot of expected countries, which have a very rich soccer culture such as England, Germany, France, Italy and Brazil. There are a few surprises as well such as Hungary and the United States.</span>
<span id="cb63-449"><a href="#cb63-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-450"><a href="#cb63-450" aria-hidden="true" tabindex="-1"></a>Conversely, we can check which teams have been most successful as the Away Team.</span>
<span id="cb63-451"><a href="#cb63-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-452"><a href="#cb63-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-455"><a href="#cb63-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-456"><a href="#cb63-456" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb63-457"><a href="#cb63-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(result <span class="sc">==</span> <span class="st">"Away Team"</span> <span class="sc">&amp;</span> neutral <span class="sc">==</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-458"><a href="#cb63-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(home_team) <span class="sc">%&gt;%</span></span>
<span id="cb63-459"><a href="#cb63-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_wins =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb63-460"><a href="#cb63-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_wins)) <span class="sc">%&gt;%</span></span>
<span id="cb63-461"><a href="#cb63-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-462"><a href="#cb63-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">dense_rank</span>(<span class="fu">desc</span>(total_wins))) <span class="sc">%&gt;%</span></span>
<span id="cb63-463"><a href="#cb63-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(home_team, total_wins), <span class="at">y =</span> total_wins, <span class="at">fill =</span> rank)) <span class="sc">+</span></span>
<span id="cb63-464"><a href="#cb63-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb63-465"><a href="#cb63-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Countries with Most Wins as Away Team"</span>,</span>
<span id="cb63-466"><a href="#cb63-466" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb63-467"><a href="#cb63-467" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Wins"</span>) <span class="sc">+</span></span>
<span id="cb63-468"><a href="#cb63-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> viridisLite<span class="sc">::</span><span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">option =</span> <span class="st">"A"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb63-469"><a href="#cb63-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-470"><a href="#cb63-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb63-471"><a href="#cb63-471" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb63-472"><a href="#cb63-472" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb63-473"><a href="#cb63-473" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb63-474"><a href="#cb63-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb63-475"><a href="#cb63-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb63-476"><a href="#cb63-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-477"><a href="#cb63-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-478"><a href="#cb63-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-479"><a href="#cb63-479" aria-hidden="true" tabindex="-1"></a>These results are surprising as most of these countries aren't known for soccer. You might expect a country having more successful away record being one of the top ranked soccer nations but the result above disabuses us of this notion.</span>
<span id="cb63-480"><a href="#cb63-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-481"><a href="#cb63-481" aria-hidden="true" tabindex="-1"></a>We can check the same result for matches played on neutral grounds. For this we will have to modify the results dataset. The teams playing in each match are split into two variables: Home Team and Away Team. Since we want to group by "team", we will need to pivot the home_team and away_team into a single variable called "team". This will allow us to group the data set by team.</span>
<span id="cb63-482"><a href="#cb63-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-483"><a href="#cb63-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-486"><a href="#cb63-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-487"><a href="#cb63-487" aria-hidden="true" tabindex="-1"></a>result_pivoted <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb63-488"><a href="#cb63-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(home_team, away_team), <span class="at">names_to =</span> <span class="st">"team_type"</span>, <span class="at">values_to =</span> <span class="st">"team"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-489"><a href="#cb63-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">team_type =</span> <span class="fu">ifelse</span>(team_type <span class="sc">==</span> <span class="st">"home_team"</span>, <span class="st">"Home Team"</span>, <span class="st">"Away Team"</span>))</span>
<span id="cb63-490"><a href="#cb63-490" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(result_pivoted[, <span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"home_score"</span>,<span class="st">"away_score"</span>,<span class="st">"result"</span>,<span class="st">"team_type"</span>,<span class="st">"team"</span>)])</span>
<span id="cb63-491"><a href="#cb63-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-492"><a href="#cb63-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-493"><a href="#cb63-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-496"><a href="#cb63-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-497"><a href="#cb63-497" aria-hidden="true" tabindex="-1"></a>result_pivoted <span class="sc">%&gt;%</span></span>
<span id="cb63-498"><a href="#cb63-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(result <span class="sc">==</span> team_type <span class="sc">&amp;</span> neutral <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-499"><a href="#cb63-499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">%&gt;%</span></span>
<span id="cb63-500"><a href="#cb63-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_wins =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb63-501"><a href="#cb63-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_wins)) <span class="sc">%&gt;%</span></span>
<span id="cb63-502"><a href="#cb63-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-503"><a href="#cb63-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">dense_rank</span>(<span class="fu">desc</span>(total_wins))) <span class="sc">%&gt;%</span></span>
<span id="cb63-504"><a href="#cb63-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(team, total_wins), <span class="at">y =</span> total_wins, <span class="at">fill =</span> rank)) <span class="sc">+</span></span>
<span id="cb63-505"><a href="#cb63-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb63-506"><a href="#cb63-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Countries with Most Wins on Neutral grounds"</span>,</span>
<span id="cb63-507"><a href="#cb63-507" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Country"</span>,</span>
<span id="cb63-508"><a href="#cb63-508" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Wins"</span>) <span class="sc">+</span></span>
<span id="cb63-509"><a href="#cb63-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> viridisLite<span class="sc">::</span><span class="fu">viridis</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">option =</span> <span class="st">"A"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb63-510"><a href="#cb63-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-511"><a href="#cb63-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb63-512"><a href="#cb63-512" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb63-513"><a href="#cb63-513" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb63-514"><a href="#cb63-514" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb63-515"><a href="#cb63-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb63-516"><a href="#cb63-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb63-517"><a href="#cb63-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-518"><a href="#cb63-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-519"><a href="#cb63-519" aria-hidden="true" tabindex="-1"></a>Again we see a few expected countries and few unexpected ones. A possible explanation for countries like Iraq, Saudi Arabia, Indonesia is the political climate in these countries might have prevented them from playing matches at home. For this reason a neutral venue might have been arranged for all those game which might have otherwise been played at their home ground.</span>
<span id="cb63-520"><a href="#cb63-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-521"><a href="#cb63-521" aria-hidden="true" tabindex="-1"></a><span class="fu">### Impact of historical events</span></span>
<span id="cb63-522"><a href="#cb63-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-523"><a href="#cb63-523" aria-hidden="true" tabindex="-1"></a>Now we will investigate the impact of major world events on International Soccer.</span>
<span id="cb63-524"><a href="#cb63-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-525"><a href="#cb63-525" aria-hidden="true" tabindex="-1"></a>We'll start by plotting a line chart for number of matches played per year over time.</span>
<span id="cb63-526"><a href="#cb63-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-529"><a href="#cb63-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-530"><a href="#cb63-530" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb63-531"><a href="#cb63-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb63-532"><a href="#cb63-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">matches =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb63-533"><a href="#cb63-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-534"><a href="#cb63-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> matches)) <span class="sc">+</span></span>
<span id="cb63-535"><a href="#cb63-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-536"><a href="#cb63-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Matches Played per Year"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Matches"</span>) <span class="sc">+</span></span>
<span id="cb63-537"><a href="#cb63-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1870</span>, <span class="dv">2020</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb63-538"><a href="#cb63-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb63-539"><a href="#cb63-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-540"><a href="#cb63-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-541"><a href="#cb63-541" aria-hidden="true" tabindex="-1"></a>We can see from the above graph that there is a general increasing trend in the number of matches played. We will divide the time frame into two parts 1872 to 1950 and 1950 to 2022. We are doing this to examine the trends with more focus.</span>
<span id="cb63-542"><a href="#cb63-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-543"><a href="#cb63-543" aria-hidden="true" tabindex="-1"></a>We will start with examining the data from 1872 to 1950.</span>
<span id="cb63-544"><a href="#cb63-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-547"><a href="#cb63-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-548"><a href="#cb63-548" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb63-549"><a href="#cb63-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb63-550"><a href="#cb63-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">matches =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb63-551"><a href="#cb63-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;</span> <span class="dv">1950</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-552"><a href="#cb63-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> matches)) <span class="sc">+</span></span>
<span id="cb63-553"><a href="#cb63-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-554"><a href="#cb63-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Matches Played per Year"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Matches"</span>) <span class="sc">+</span></span>
<span id="cb63-555"><a href="#cb63-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1870</span>, <span class="dv">1950</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb63-556"><a href="#cb63-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb63-557"><a href="#cb63-557" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-558"><a href="#cb63-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-559"><a href="#cb63-559" aria-hidden="true" tabindex="-1"></a>In the above graph, we can see that there are two significant dips in the number of matches being played. These dips (minima) correspond to the years when the two World Wars happened. As we'd expect the World Wars upset the entire balance in global geo-political situation and the number of soccer matches being played also decreased.</span>
<span id="cb63-560"><a href="#cb63-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-561"><a href="#cb63-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-562"><a href="#cb63-562" aria-hidden="true" tabindex="-1"></a>Similarly, we will check the trend for years 1950 to 2022.</span>
<span id="cb63-563"><a href="#cb63-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-566"><a href="#cb63-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-567"><a href="#cb63-567" aria-hidden="true" tabindex="-1"></a>results <span class="sc">%&gt;%</span></span>
<span id="cb63-568"><a href="#cb63-568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb63-569"><a href="#cb63-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">matches =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb63-570"><a href="#cb63-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;</span> <span class="dv">1950</span> <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-571"><a href="#cb63-571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> matches)) <span class="sc">+</span></span>
<span id="cb63-572"><a href="#cb63-572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"steelblue"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb63-573"><a href="#cb63-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Matches Played per Year"</span>, <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Matches"</span>) <span class="sc">+</span></span>
<span id="cb63-574"><a href="#cb63-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1950</span>, <span class="dv">2022</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb63-575"><a href="#cb63-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb63-576"><a href="#cb63-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-577"><a href="#cb63-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-578"><a href="#cb63-578" aria-hidden="true" tabindex="-1"></a>We can see a general increasing trend for the above graph. There are a lot of local maximas and minimas in this graph. The local maximas correspond to when most of the major International tournaments are played. For example, the World Cup is played every 4 years.</span>
<span id="cb63-579"><a href="#cb63-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-580"><a href="#cb63-580" aria-hidden="true" tabindex="-1"></a>We see a massive decrease in the number of matches played for the year 2020. This is the year when the Covid 19 pandemic struck the world and everyone was forced to quarantine. As expected even soccer felt the ramifications of this.</span>
<span id="cb63-581"><a href="#cb63-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-582"><a href="#cb63-582" aria-hidden="true" tabindex="-1"></a>The trend from years 1950 till 1980 is very erratic. These were the years when there was Cold War going on between the United States of America and Russia, which might be one of the reasons for that trend.</span>
<span id="cb63-583"><a href="#cb63-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-584"><a href="#cb63-584" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of Penalties</span></span>
<span id="cb63-585"><a href="#cb63-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-586"><a href="#cb63-586" aria-hidden="true" tabindex="-1"></a>Finally we will look at Penalties and see how they affect the game.</span>
<span id="cb63-587"><a href="#cb63-587" aria-hidden="true" tabindex="-1"></a>Penalties are given to a team if they are fouled near the opponent's goal. The team then gets the opportunity to score goal from a certain distance with only the goal keeper in the way.</span>
<span id="cb63-588"><a href="#cb63-588" aria-hidden="true" tabindex="-1"></a>Penalties are also used as deciders in case a match ends up as a draw.</span>
<span id="cb63-589"><a href="#cb63-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-590"><a href="#cb63-590" aria-hidden="true" tabindex="-1"></a>Lets see which countries have been most successful at scoring penalties.</span>
<span id="cb63-591"><a href="#cb63-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-594"><a href="#cb63-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-595"><a href="#cb63-595" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by and summarize goalscorers dataset to find out top 10 teams with most penalties</span></span>
<span id="cb63-596"><a href="#cb63-596" aria-hidden="true" tabindex="-1"></a>penalty_analysis <span class="ot">&lt;-</span> goalscorers <span class="sc">%&gt;%</span></span>
<span id="cb63-597"><a href="#cb63-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(penalty <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-598"><a href="#cb63-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team) <span class="sc">%&gt;%</span></span>
<span id="cb63-599"><a href="#cb63-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_penalties =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb63-600"><a href="#cb63-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_penalties)) <span class="sc">%&gt;%</span></span>
<span id="cb63-601"><a href="#cb63-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>)</span>
<span id="cb63-602"><a href="#cb63-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-603"><a href="#cb63-603" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the top 10 teams with the most penalties</span></span>
<span id="cb63-604"><a href="#cb63-604" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(penalty_analysis)</span>
<span id="cb63-605"><a href="#cb63-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-606"><a href="#cb63-606" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar chart of the top 10 teams with the most penalties</span></span>
<span id="cb63-607"><a href="#cb63-607" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penalty_analysis, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(team, total_penalties), <span class="at">y =</span> total_penalties)) <span class="sc">+</span></span>
<span id="cb63-608"><a href="#cb63-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb63-609"><a href="#cb63-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Teams with the Most Penalties"</span>,</span>
<span id="cb63-610"><a href="#cb63-610" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Team"</span>,</span>
<span id="cb63-611"><a href="#cb63-611" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Penalties"</span>) <span class="sc">+</span></span>
<span id="cb63-612"><a href="#cb63-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb63-613"><a href="#cb63-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-614"><a href="#cb63-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-615"><a href="#cb63-615" aria-hidden="true" tabindex="-1"></a>Now we'll check how penalties affect the outcome of a game. For this analysis we will have to merge the results and the goalscorers datasets. This because the match outcome data is stored in the results dataset and the penalty data is stored in the goalscorers dataset.</span>
<span id="cb63-616"><a href="#cb63-616" aria-hidden="true" tabindex="-1"></a>We can uniquely identify a match based on the date and the two teams that played the game. We will join the two datasets using these three variables.</span>
<span id="cb63-619"><a href="#cb63-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-620"><a href="#cb63-620" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging results and goalscorers datasets</span></span>
<span id="cb63-621"><a href="#cb63-621" aria-hidden="true" tabindex="-1"></a>merged_results <span class="ot">&lt;-</span> <span class="fu">merge</span>(results,goalscorers , <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"home_team"</span>, <span class="st">"away_team"</span>))</span>
<span id="cb63-622"><a href="#cb63-622" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(merged_results)</span>
<span id="cb63-623"><a href="#cb63-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-624"><a href="#cb63-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-625"><a href="#cb63-625" aria-hidden="true" tabindex="-1"></a>Lets look at the impact of penalties on the outcome of matches.</span>
<span id="cb63-626"><a href="#cb63-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-627"><a href="#cb63-627" aria-hidden="true" tabindex="-1"></a>We will calculate the number of games where the home team scored a penalty and won the game and the number of games where the home team scored a penalty but lost the game. Then we will create a pie chart to show the results.</span>
<span id="cb63-628"><a href="#cb63-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-631"><a href="#cb63-631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-632"><a href="#cb63-632" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of penalties scored by home team where Home team won the match</span></span>
<span id="cb63-633"><a href="#cb63-633" aria-hidden="true" tabindex="-1"></a>home_penalties <span class="ot">&lt;-</span> merged_results <span class="sc">%&gt;%</span></span>
<span id="cb63-634"><a href="#cb63-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(penalty <span class="sc">&amp;</span> home_team <span class="sc">==</span> team <span class="sc">&amp;</span> result <span class="sc">==</span> <span class="st">"Home Team"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-635"><a href="#cb63-635" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb63-636"><a href="#cb63-636" aria-hidden="true" tabindex="-1"></a>home_penalties</span>
<span id="cb63-637"><a href="#cb63-637" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-640"><a href="#cb63-640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-641"><a href="#cb63-641" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of penalties scored by home team where Away team won the match</span></span>
<span id="cb63-642"><a href="#cb63-642" aria-hidden="true" tabindex="-1"></a>home_penalties_l <span class="ot">&lt;-</span> merged_results <span class="sc">%&gt;%</span></span>
<span id="cb63-643"><a href="#cb63-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(penalty <span class="sc">&amp;</span> home_team <span class="sc">==</span> team <span class="sc">&amp;</span> result <span class="sc">==</span> <span class="st">"Away Team"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-644"><a href="#cb63-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb63-645"><a href="#cb63-645" aria-hidden="true" tabindex="-1"></a>home_penalties_l</span>
<span id="cb63-646"><a href="#cb63-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-649"><a href="#cb63-649" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb63-650"><a href="#cb63-650" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding data to a dataframe</span></span>
<span id="cb63-651"><a href="#cb63-651" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">category =</span> <span class="fu">c</span>(<span class="st">"Wins with Penalty"</span>, <span class="st">"Losses with Penalty"</span>),</span>
<span id="cb63-652"><a href="#cb63-652" aria-hidden="true" tabindex="-1"></a>                   <span class="at">count =</span> <span class="fu">c</span>(home_penalties, home_penalties_l))</span>
<span id="cb63-653"><a href="#cb63-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-654"><a href="#cb63-654" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the pie chart</span></span>
<span id="cb63-655"><a href="#cb63-655" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> count, <span class="at">fill =</span> category)) <span class="sc">+</span></span>
<span id="cb63-656"><a href="#cb63-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb63-657"><a href="#cb63-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb63-658"><a href="#cb63-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Penalties Distribution"</span>,</span>
<span id="cb63-659"><a href="#cb63-659" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Category"</span>,</span>
<span id="cb63-660"><a href="#cb63-660" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb63-661"><a href="#cb63-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb63-662"><a href="#cb63-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb63-663"><a href="#cb63-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb63-664"><a href="#cb63-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-665"><a href="#cb63-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-666"><a href="#cb63-666" aria-hidden="true" tabindex="-1"></a>As we can see, matches where a team took a penalty, most likely that team ended up winning the match.</span>
<span id="cb63-667"><a href="#cb63-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-668"><a href="#cb63-668" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion and Reflection</span></span>
<span id="cb63-669"><a href="#cb63-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-670"><a href="#cb63-670" aria-hidden="true" tabindex="-1"></a>The visualizations in the "Home Advantage" section provide validation that playing at a home ground does provide an advantage to the Home Team. However, I don't believe this is a bad thing. Fans of the sport are very passionate about the teams that they support and having their team play in their home ground allows these fans to show their support. At the same time these tournaments should be scheduled so that some teams aren't getting an unfair advantage in the overall tournament. It would be interesting to see how players individually are impacted by playing at home or away and if we could classify players accordingly.</span>
<span id="cb63-671"><a href="#cb63-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-672"><a href="#cb63-672" aria-hidden="true" tabindex="-1"></a>In the second part of the analysis, I got the same results as expected. Soccer is majorly impacted by World events such as Wars and Pandemics. But the sport is also able to recover from this. As we can see the sport has grown a lot in 150 years. A similar analysis for a single country might be able to give us an insight on how the socio-political conditions there affect their participation in International Soccer.</span>
<span id="cb63-673"><a href="#cb63-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-674"><a href="#cb63-674" aria-hidden="true" tabindex="-1"></a>Finally, we did a brief analysis of penalties. We can surmise that penalties play a major role in deciding the outcome of games. There has been a lot of debate regarding alternatives to penalties to make the game more balanced. I believe that having the threat of giving away a penalty keeps the defenders of the teams in check as they risk losing a goal.</span>
<span id="cb63-675"><a href="#cb63-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-676"><a href="#cb63-676" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bibliography</span></span>
<span id="cb63-677"><a href="#cb63-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-678"><a href="#cb63-678" aria-hidden="true" tabindex="-1"></a>International Soccer dataset:</span>
<span id="cb63-679"><a href="#cb63-679" aria-hidden="true" tabindex="-1"></a>https://www.kaggle.com/datasets/martj42/international-football-results-from-1872-to-2017?select=results.csv</span>
<span id="cb63-680"><a href="#cb63-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-681"><a href="#cb63-681" aria-hidden="true" tabindex="-1"></a>History of Football (Soccer):</span>
<span id="cb63-682"><a href="#cb63-682" aria-hidden="true" tabindex="-1"></a>https://www.footballhistory.org/</span>
<span id="cb63-683"><a href="#cb63-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-684"><a href="#cb63-684" aria-hidden="true" tabindex="-1"></a>Key events of the 20th century:</span>
<span id="cb63-685"><a href="#cb63-685" aria-hidden="true" tabindex="-1"></a>https://en.wikipedia.org/wiki/Key_events_of_the_20th_century</span>
<span id="cb63-686"><a href="#cb63-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-687"><a href="#cb63-687" aria-hidden="true" tabindex="-1"></a>R Language as programming language</span>
<span id="cb63-688"><a href="#cb63-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-689"><a href="#cb63-689" aria-hidden="true" tabindex="-1"></a>Wickham, H., &amp; Grolemund, G. (2016). R for data science: Visualize, model, transform, tidy, and import data. OReilly Media.</span>
<span id="cb63-690"><a href="#cb63-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-691"><a href="#cb63-691" aria-hidden="true" tabindex="-1"></a>The R Graph Gallery-https://r-graph-gallery.com/</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>