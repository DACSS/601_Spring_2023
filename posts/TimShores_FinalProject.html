<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.427">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tim Shores">
<meta name="dcterms.date" content="2023-05-20">
<meta name="description" content="Local police department call data analysis for two small rural towns">

<title>Final Project: Tim Shores</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<link rel="stylesheet" href="styles.css">
<meta name="twitter:title" content="Final Project: Tim Shores">
<meta name="twitter:description" content="Local police department call data analysis for two small rural towns">
<meta name="twitter:image" content="https://dacss.github.io/601_Spring_2023/posts/TimShores_FinalProject_files/figure-html/chunkTotalHours-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1920">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/DACSS" rel="" target="">
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/DACSS" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a></li>
  <li><a href="#dataset-introduction" id="toc-dataset-introduction" class="nav-link" data-scroll-target="#dataset-introduction">Dataset Introduction</a></li>
  <li><a href="#analysis-plan" id="toc-analysis-plan" class="nav-link" data-scroll-target="#analysis-plan">Analysis Plan</a></li>
  <li><a href="#results-analysis-and-visualization" id="toc-results-analysis-and-visualization" class="nav-link" data-scroll-target="#results-analysis-and-visualization">Results: Analysis and Visualization</a>
  <ul>
  <li><a href="#total-hours-working-on-calls" id="toc-total-hours-working-on-calls" class="nav-link" data-scroll-target="#total-hours-working-on-calls">Total hours working on calls</a></li>
  <li><a href="#comparing-towns" id="toc-comparing-towns" class="nav-link" data-scroll-target="#comparing-towns">Comparing towns</a>
  <ul class="collapse">
  <li><a href="#growth-trends-total-hours-by-town" id="toc-growth-trends-total-hours-by-town" class="nav-link" data-scroll-target="#growth-trends-total-hours-by-town">Growth trends: Total hours by town</a></li>
  </ul></li>
  <li><a href="#comparing-call-reasons" id="toc-comparing-call-reasons" class="nav-link" data-scroll-target="#comparing-call-reasons">Comparing call reasons</a>
  <ul class="collapse">
  <li><a href="#top-level-of-effort-call-reasons" id="toc-top-level-of-effort-call-reasons" class="nav-link" data-scroll-target="#top-level-of-effort-call-reasons">Top level-of-effort call reasons</a></li>
  <li><a href="#top-growth-call-reasons" id="toc-top-growth-call-reasons" class="nav-link" data-scroll-target="#top-growth-call-reasons">Top growth call reasons</a></li>
  <li><a href="#top-impact-call-reasons" id="toc-top-impact-call-reasons" class="nav-link" data-scroll-target="#top-impact-call-reasons">Top impact call reasons</a></li>
  <li><a href="#bottom-impact-call-reasons" id="toc-bottom-impact-call-reasons" class="nav-link" data-scroll-target="#bottom-impact-call-reasons">Bottom impact call reasons</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comparing-themes" id="toc-comparing-themes" class="nav-link" data-scroll-target="#comparing-themes">Comparing themes</a>
  <ul>
  <li><a href="#conclusion-and-discussion" id="toc-conclusion-and-discussion" class="nav-link" data-scroll-target="#conclusion-and-discussion">Conclusion and Discussion</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography">Bibliography</a></li>
  </ul></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a>
  <ul>
  <li><a href="#data-dictionary" id="toc-data-dictionary" class="nav-link" data-scroll-target="#data-dictionary">Data Dictionary</a></li>
  <li><a href="#sample-summaries-of-the-call-reasons-data-frame" id="toc-sample-summaries-of-the-call-reasons-data-frame" class="nav-link" data-scroll-target="#sample-summaries-of-the-call-reasons-data-frame">Sample summaries of the call reasons data frame</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project: Tim Shores</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">final_Project</div>
  </div>
  </div>

<div>
  <div class="description">
    Local police department call data analysis for two small rural towns
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tim Shores </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 20, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>my_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"broom"</span>, <span class="st">"fs"</span>, <span class="st">"pdftools"</span>, <span class="st">"knitr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"viridis"</span>, <span class="st">"hrbrthemes"</span>, <span class="st">"gridExtra"</span>, <span class="st">"tidytext"</span>) <span class="co"># create vector of packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(my_packages, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) <span class="co"># load multiple packages</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="summary" class="level3">
<h3 class="anchored" data-anchor-id="summary">Summary</h3>
<p>This is the story of two small, rural Massachusetts towns that have made an agreement to combine their local police departments. The goal of the regionalization agreement initiated in 2020 has been to reduce cost by sharing a service. However, regionalization has made it more challenging for the towns to assess public safety expenses.</p>
<p>For example, if demand for first responders has increased, is it because a single police department is now responding to crime from both towns? Or is it for reasons unrelated to regionalization, such as increased police response to medical calls or other calls for which police response is not required?</p>
<p>I intend to use the data collected to better inform budgeting and public safety discussion by public officials in the two towns. Furthermore, the work of regionalized municipal services is a common challenge that small rural towns, strapped for revenue, must consider. Improving how we collect and derive insights from municipal service regionalization data will be a vital service to towns who often don’t have the capacity to organize their own data-driven policy and administration.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Research question
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>What is the nature of public safety need behind the increase in calls that police respond to?</strong></p>
</div>
</div>
</section>
<section id="background" class="level3">
<h3 class="anchored" data-anchor-id="background">Background</h3>
<p>Since 2020, I have volunteered my time as a community organizer and political office-holder in the small rural town of Leverett, Massachusetts. One of the key challenges of public administration in Leverett is the lack of resources for gathering good evidence for public decision-making.</p>
<p>At the recent budget meetings in Spring 2023, the Leverett Police Chief made a budget request for a fourth full-time officer position. This position would help the Police Department overcome these problems:</p>
<ol type="1">
<li>Decreased supply of police officer human resources due to state criminal justice reform.</li>
<li>Increased demand for police officer human resources due to increased call volume in the towns of Leverett and Wendell.</li>
</ol>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problem #1 in detail
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>How has state reform decreased supply of police officers?</strong></p>
</div>
</div>
<p>Since 2021, state POST reform has made it <a href="https://www.berkshireeagle.com/news/central_berkshires/lenox-police-chief-talks-impact-of-new-rules-for-part-time-officers/article_3949b04c-35b2-11ec-8169-a72d6e4669a8.html">difficult for local police departments</a> to fill their on-duty schedules with reserve officers. Before 2021, reserve officers required half as much training as full-time officers. Reserve officers could work part-time or as a second job in seasonal positions and shifts as-needed. The State of Massachusetts Peace Officer Standards and Training (POST) Commission enacted a reform that required reserves to train as much as full-time officers. This has removed an incentive for people to become or remain reserve officers. The pool of reserve officers is shrinking. Local police departments, struggling to meet their scheduling needs, resort to requests for more full-time positions.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problem #2 in detail
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>How much and why has call volume increased in Leverett and Wendell?</strong></p>
</div>
</div>
<p>Since 2020, when the Wendell chief of police retired, the neighboring towns of Leverett and Wendell have agreed to combine their municipal police service. Wendell closed its own police department (WPD) and began to allocate budget revenue to the Leverett Police Department (LPD). LPD took responsibility for responding to police and emergency calls from both Leverett and Wendell. This regionalization of municipal service is expected to reduce public safety costs over time. However, the Leverett Finance Committee observed at a 2023 budget hearing that Leverett has been paying more than its share of police expenses. Meanwhile, citing an increase in call volume, LPD is still working out how to adapt to two towns’ worth of demand for police service.</p>
<p>To solve these problems, Leverett Chief of Police Scott Minckler proposed that Leverett hire a fourth full-time officer.</p>
<p>The request was approved by the Leverett and Wendell Police Services Oversight committee, the Leverett Personnel Board, and the Leverett Finance Committee. When the matter came before the Leverett Selectboard budget meeting, some members of town government and the public wanted to know more detail about the increase in call volume.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Questions voiced by the public
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li>What types of calls are increasing?</li>
<li>What is the change in personnel time needed per call and per type of call?</li>
<li>What days and times of day do we see the most calls or the most change in calls?</li>
<li>Why do we need another officer when the populations and number of properties in the two towns have not grown substantially?</li>
</ol>
</div>
</div>
<p>Chief Minckler’s response to these questions was informed by his administrative experience, but not by thorough call data analysis. Due to difficulties generating reports from the administrative software used by many emergency response departments, the Chief was not able to speak to call data beyond call volume and call type. At public meetings, I heard Leverett residents express curiosity about the nature of increased call volume: How much was due to violent crime, domestic violence, interpersonal conflict, fraud, property rights violations, traffic violations, medical emergencies, mental health emergencies, fires?</p>
<p>Although people had multiple concerns and interests in the matter, most meeting participants had this basic question in common:</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Research question
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>What is the nature of public safety need behind the increase in calls that police respond to?</strong></p>
</div>
</div>
<p>In other words, if we hired another police officer, would that meet the public safety needs that drive increased call volume? If our increased needs are by nature medical, mental health, fire, or community health and well-being, <strong>then we risk misallocating public resources in a solution to the wrong problem</strong>.</p>
</section>
<section id="dataset-introduction" class="level3">
<h3 class="anchored" data-anchor-id="dataset-introduction">Dataset Introduction</h3>
<p>To collect data that could help understand more about the public safety need of Leverett and Wendell, I submitted this <a href="https://www.mass.gov/info-details/massachusetts-law-about-freedom-of-information-and-public-records">public records request</a>:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Email to PD: Thu, Mar 30, 2023 at 3:00 PM
</div>
</div>
<div class="callout-body-container callout-body">
<p>Subject: Public Records Request for Leverett PD call data To: Scott D. Minckler <a href="mailto:policechief@leverett.ma.us" class="email">policechief@leverett.ma.us</a></p>
<p>Hi Chief Minckler,</p>
<p>I also left a voicemail, but thought it would help to send my request by email. I’ve been learning about the budget requests from last week’s meeting to get a sense of the request and the call volume and any other factors behind the request. It would help if I could learn more about our call data.</p>
<p>I’m writing to request public data to do with Leverett and Wendell calls made to dispatch, and calls handled by our police department, for the 5-year period 2018 to 2022 (inclusive of the years 2018, 2019, 2020, 2021, and 2022). I’m requesting complete police department call detail records, with columns of data redacted if they are subject to specific statutory exemption to the MA Public Records Law due to criteria such as victim confidentiality.</p>
<p>Please export data from your call management software application to CSV or XLSX files, rather than PDF or Word documents. The tabular CSV or XLSX format will facilitate data analysis.</p>
<p>If the export files are too large for email attachment, please upload to this Drive location:</p>
<p><em>url omitted</em></p>
<p>Thanks! Let me know if you have any questions or feedback.</p>
<p>Tim Shores</p>
</div>
</div>
<p>Chief Minckler called me the following Monday morning to discuss the request. He could supply reports, but not at the level of detail that I requested. I also learned from Chief Minckler that one reason for the growth of calls in Wendell was that the former police chief of Wendell did not record every call. This was not made known at the time when the two towns negotiated their regionalization agreement.</p>
<p>I spoke with Supervisor Butch Garrity of Shelburne Dispatch, which serves as the 911 dispatcher for most towns in Franklin County, including Leverett and Wendell. The dispatch center and local agencies have used a client-server application called <a href="https://www.centralsquare.com/">IMC-Central Square</a> since 1997 to manage dispatch calls and responses. The application has a reputation for being difficult to use and limited in functionality.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
IMC-Central Square report limitations
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>The report export format was limited to PDF.</li>
<li>They could only provide call summary data. It was not practical to provide call detail data that would include relevant information (such as call day and time of day, location, demographics of people involved, and details of actions taken by responding officers) because Central Square has no redaction functions.</li>
</ol>
</div>
</div>
<p>These software limitations have come up before in Leverett. In 2020, while researching a report on policing and the experience of people of color in town, the Leverett Social Justice Committee (SJC) submitted multiple requests for police call data that included race and ethnicity of people involved. LPD claimed that they were not able to comply because they were unable to generate the reports. The SJC met with someone at Amherst PD, which uses the same software, who offered to meet with LPD about how to generate IMC-Central Square reports. I am not aware of any follow-through on that offer for inter-departmental collaboration on the SJC public records request.</p>
<p>Based on my career experience with numerous database systems, I’m confident that technical means exist to overcome these functional limits. However, I take the claims of the LPD and Shelburne Dispatch to be made in good faith. At the end of the day, it comes down to a lack of resources, and as a researcher I must set my expectations accordingly.</p>
<p>Chief Minckler sent me 10 PDF files: one for each town and year, from 2018 to 2022. Each file includes 3 tables:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Source report structure
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>Call Reason Breakdown</strong> shows the number of calls for each call reason, average time per call per call reason, and the type and number of actions taken in response to each call reason.</li>
<li><strong>Call Action Breakdown</strong> shows summaries of call actions.</li>
<li><strong>Operator Race and Sex Breakdown</strong> shows summary demographics of vehicle operators involved in traffic stops and violations.</li>
</ol>
</div>
</div>
<p><strong>Call Reason Breakdown</strong> is the the only object of this analysis. CSV exports of all three data frames are available in the bibliography.</p>
<p>I used the R libraries <code>purrr</code> and <code>pdf_tools</code> to read-in the data to a list of 10 lists of data frames: one data frame for each page, one list for each file, in a collection of 10 files.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># creates fs_path vector of each file in that directory</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>projectFiles <span class="ot">&lt;-</span> <span class="fu">dir_ls</span>(<span class="st">'../posts/TimShores_FinalProject_Data'</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># I have csv files in that folder for public sharing ... remove them from vector.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>projectFiles <span class="ot">&lt;-</span> projectFiles[<span class="fu">grepl</span>(<span class="st">'</span><span class="sc">\\</span><span class="st">.pdf$'</span>, projectFiles)]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>projectFiles_list <span class="ot">&lt;-</span> projectFiles <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(pdf_data) <span class="co"># purrr function that applies pdf_data reading function to each file element of fs_path vector</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># map creates a list of lists of tibbles (a tibble for each page of each pdf)</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now that I've consumed my files I can str_replace to get town and year info from each filename.</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>projectFiles <span class="ot">&lt;-</span> projectFiles <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">'../posts/TimShores_FinalProject_Data/'</span>, <span class="st">''</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">'.pdf'</span>, <span class="st">''</span>) </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(projectFiles_list) <span class="ot">&lt;-</span> projectFiles</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I took the following general steps to parse this list:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data transformation steps
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Mutated each row with information about the town, year, and source page number.</li>
<li>Flattened the nested list of data frames into a single data frame.</li>
<li>Used <code>pivot_wider</code> to create columns based on PDF page x coordinates coordinates recorded for each observation by <code>pdf_data</code>. The x coordinates help identify column boundaries in the original report: each column had a minimum and maximum value for x.</li>
<li>Plyered apart the tables according to their distinct meanings into separate data frames: call reasons, call actions, and operator demographics.</li>
<li>Filtered out or filled in all NA values. Every observation in the original reports had values for every variable. Plyering into separate data frames leaes blanks or NAs where the original report format staggers. Therefore, I interpret NA to indicate that I must remove the row or fill in the variable with a sub-heading value. The end result is three data frames with no NAs.</li>
</ol>
</div>
</div>
<p>See my comments in the code block below for details.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This next part took a couple days of searching for a tidy solution. </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Then I just decided to use a good old-fashioned nested for loop.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The structure of the original documents is that each of 10 files has a variable number of pages.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Therefore, the projectFiles_list structure is a nested list of dataframes: list[[list]][[dataframe]]. </span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># I want to mutate each df with the page number from its PDF, or "innerpageid". </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Inner pagination corresponds to each dataframe's nested list element index (j in list[[i]][[j]]) which </span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is information that gets destroyed as soon as I map to an unnested list. I couldn't find a tidy solution to capturing that nested</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># "inner" page id before the map, so I used a nested for loop to assign value to innerpageid before appending my mapped/mutated df to</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a new single-layer list.</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>allYearsList <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(projectFiles_list)) { <span class="co"># seq_along(projectFiles_list) creates vector with a number value for each list element</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(projectFiles_list[[i]])) {</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    projectFiles_list[[i]][[j]] <span class="ot">&lt;-</span> <span class="fu">mutate</span>(projectFiles_list[[i]][[j]], <span class="at">innerpageid =</span> j)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  allYearsList <span class="ot">&lt;-</span> <span class="fu">append</span>(allYearsList, <span class="fu">map2</span>(projectFiles_list[[i]], </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">names</span>(projectFiles_list[i]), </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                                            <span class="sc">~</span>.x <span class="sc">%&gt;%</span> </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">mutate</span>(<span class="at">filename =</span> .y)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                                            )</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                         )</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this bind_rows takes all of the df observations from all of the list elements and binds them together in a single df.</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># outerpageid is the 'page' number in an absolute sequence (1 to 78 in this case) rather than segmented by file (1 to 9, 1 to 7 etc.)</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Note that outerpageid is not particularly important (it's semantically identical to town, year, innerpageid) </span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and I should remove this scaffold.</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>allYearsDF <span class="ot">&lt;-</span> allYearsList <span class="sc">%&gt;%</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">'outerpageid'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">c</span>(filename, innerpageid), <span class="at">.after =</span> outerpageid) <span class="sc">%&gt;%</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(height <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span> y <span class="sc">&gt;</span> <span class="dv">13</span> <span class="sc">&amp;</span> text <span class="sc">!=</span> <span class="st">"Action:"</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this creates a problem of staggered lines</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF <span class="sc">%&gt;%</span> </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(outerpageid, filename, innerpageid, y), <span class="at">names_from =</span> x, <span class="at">values_from =</span> text)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co"># solution from https://stackoverflow.com/questions/45515218/combine-rows-in-data-frame-containing-na-to-make-complete-row</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Supply lists by splicing them into dots:</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>coalesce_by_column <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dplyr<span class="sc">::</span><span class="fu">coalesce</span>(<span class="sc">!!!</span> <span class="fu">as.list</span>(df)))</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">outerpageid =</span> <span class="fu">as.integer</span>(outerpageid))</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(outerpageid, filename, innerpageid, y) <span class="sc">%&gt;%</span> <span class="co"># outerpageid is redundant here</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(coalesce_by_column) <span class="sc">%&gt;%</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="co"># do I need to ungroup() ? doesn't seem to hurt!</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># it will help to order columns by numeric order - they are the x coords from left to right. This looks for all non-alpha column names.</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>numcols <span class="ot">=</span> <span class="fu">sort</span>(<span class="fu">as.numeric</span>(<span class="fu">names</span>(allYearsDF_wide)[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"[a-z]"</span>, <span class="fu">names</span>(allYearsDF_wide))]))</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> <span class="fu">select</span>(allYearsDF_wide, outerpageid, filename, innerpageid, y, <span class="fu">match</span>(numcols, <span class="fu">names</span>(allYearsDF_wide))) </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now we have a df that is simply x:y coordinates of the page</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># time to smush cols together, yay smush!</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span> </span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x5to52"</span>, <span class="fu">c</span>(<span class="st">"5"</span><span class="sc">:</span><span class="st">"47"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x53to197"</span>, <span class="fu">c</span>(<span class="st">"53"</span><span class="sc">:</span><span class="st">"197"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x198to238"</span>, <span class="fu">c</span>(<span class="st">"198"</span><span class="sc">:</span><span class="st">"233"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x239to280"</span>, <span class="fu">c</span>(<span class="st">"239"</span><span class="sc">:</span><span class="st">"270"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x281to329"</span>, <span class="fu">c</span>(<span class="st">"281"</span><span class="sc">:</span><span class="st">"329"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x330to371"</span>, <span class="fu">c</span>(<span class="st">"330"</span><span class="sc">:</span><span class="st">"371"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x372to449"</span>, <span class="fu">c</span>(<span class="st">"372"</span><span class="sc">:</span><span class="st">"431"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x450toEnd"</span>, <span class="fu">c</span>(<span class="st">"450"</span><span class="sc">:</span><span class="st">"545"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note that spacing does differ on each page (as indicated by the colnames), but the boundaries are stable</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (as indicated by the united colnames -- I manually confirmed the minimum pixel position of each column on each data frame)</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># final tidying of Call_Reason text separated into different columns</span></span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this sequence of conditionals looks through new columns named after PDF page x coordinates </span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># then pastes values depending on their x coords, reconstructing variables </span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># from PDF text box fragments</span></span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x5to52 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x5to52, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(x5to52,<span class="st">" "</span>,x53to197), </span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(x5to52)),</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>         <span class="at">x53to197 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x5to52, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(x53to197)), <span class="co"># delete from additional columns</span></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>         <span class="at">x53to197 =</span> <span class="fu">ifelse</span>(x53to197 <span class="sc">==</span> <span class="st">""</span>, </span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(x53to197, <span class="st">" "</span>, x198to238, <span class="st">" "</span>, x239to280, <span class="st">" "</span>, x281to329, <span class="st">" "</span>, x330to371, <span class="st">" "</span>, x372to449, <span class="st">" "</span>, x450toEnd)),</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>         <span class="at">x198to238 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x198to238)), <span class="co"># delete from add'l cols</span></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>         <span class="at">x239to280 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>),</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x239to280)), <span class="co"># delete from add'l cols</span></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>         <span class="at">x281to329 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x281to329)), <span class="co"># delete from add'l cols</span></span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>         <span class="at">x330to371 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x330to371)), <span class="co"># delete from add'l cols</span></span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>         <span class="at">x372to449 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x372to449)), <span class="co"># delete from add'l cols</span></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>         <span class="at">x450toEnd =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>),</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x450toEnd)) <span class="co"># delete from add'l cols</span></span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>  <span class="co"># replace blanks with NAs in the 2nd and 3rd cols. </span></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>), <span class="sc">~</span><span class="fu">na_if</span>(., <span class="st">''</span>)) </span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># I tried this using paste in the previous mutate, but the result was a text string "NA", not an NA.</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># label each action with its call reason</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(x5to52, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span>                             <span class="co"># populate rows to support normalization</span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x53to197 =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Action"</span>, x53to197))  <span class="co"># create a column name</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(allYearsDF_wide)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)] <span class="ot">&lt;-</span> allYearsDF_wide[<span class="dv">1</span>,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)]    <span class="co"># set values from the first row to column headings </span></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span>                              <span class="co"># tidy column names</span></span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"._"</span>, <span class="st">"_"</span>, .x, <span class="at">fixed =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"@"</span>, <span class="st">"at"</span>, .x, <span class="at">fixed =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">avg_hours_to_arrive =</span> avg_arrive,</span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>         <span class="at">avg_hours_at_scene =</span> avg_time_at_scene) <span class="sc">%&gt;%</span></span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(innerpageid <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">|</span> y <span class="sc">!=</span> <span class="dv">69</span> <span class="sc">|</span> call_reason <span class="sc">!=</span> <span class="st">"Call_Reason"</span>) <span class="sc">%&gt;%</span>   <span class="co"># some y values reliably indicate</span></span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(self <span class="sc">!=</span> <span class="st">"Self_Init"</span>) <span class="sc">%&gt;%</span>                                         <span class="co"># headers/footers on source PDF page format</span></span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_regex</span>(filename, <span class="fu">c</span>(<span class="at">town =</span> <span class="st">"^[A-Za-z]+"</span>, <span class="at">year =</span> <span class="st">"[0-9]{4}$"</span>)) <span class="sc">%&gt;%</span>  <span class="co"># sep filename into town and year</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">town =</span> <span class="fu">factor</span>(town),</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="fu">make_date</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(year), <span class="at">month =</span> <span class="dv">1</span>, <span class="at">day =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(total, <span class="st">"___%"</span>)) <span class="sc">%&gt;%</span>                                           <span class="co"># this is a total column - don't need it</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(call_reason<span class="sc">:</span>avg_hours_at_scene, <span class="sc">~</span><span class="fu">na_if</span>(., <span class="st">""</span>)))</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First df achievement unlocked: Call Reasons</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span> </span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(action)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(self)) <span class="sc">%&gt;%</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(town, year, call_reason, self, disp, avg_hours_to_arrive, avg_hours_at_scene) <span class="sc">%&gt;%</span></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">factor</span>(call_reason)) <span class="sc">%&gt;%</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"self"</span>, <span class="st">"disp"</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"avg_hours_to_arrive"</span>, <span class="st">"avg_hours_at_scene"</span>), as.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_hours_to_arrive =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(avg_hours_to_arrive), <span class="dv">0</span>, avg_hours_to_arrive),</span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_hours_per_call =</span> avg_hours_to_arrive <span class="sc">+</span> avg_hours_at_scene,</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_hours_per_call =</span> avg_hours_per_call <span class="sc">/</span> <span class="dv">60</span>,    <span class="co"># convert times to hours</span></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls =</span> self <span class="sc">+</span> disp,</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> totalCalls <span class="sc">*</span> avg_hours_per_call) <span class="sc">%&gt;%</span></span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(avg_hours_to_arrive, avg_hours_at_scene)) <span class="sc">%&gt;%</span></span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"total"</span>, call_reason, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="co"># Final step, get rid of of rows with call_reason = TOTAL</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Second df achievement unlocked: Call Actions (each call reason has 1+ actions)</span></span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (note: not used in the current version of the analysis, </span></span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a>  <span class="co"># but a link to the file is made available in the bibliography</span></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a>callActionsDF <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span> </span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(action)) <span class="sc">%&gt;%</span></span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"total"</span>, call_reason, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(town, year, call_reason, action))  <span class="sc">%&gt;%</span></span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_regex</span>(action, <span class="fu">c</span>(<span class="at">actionname =</span> <span class="st">".+"</span>, <span class="st">" = "</span>, <span class="at">actioncount =</span> <span class="st">".*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">factor</span>(call_reason),</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>         <span class="at">actionname =</span> <span class="fu">factor</span>(actionname),</span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>         <span class="at">actioncount =</span> <span class="fu">str_squish</span>(actioncount),</span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>         <span class="at">actioncount =</span> <span class="fu">as.integer</span>(actioncount))</span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Third and final df achievement unlocked: Operator demographics, not explicitly related to call reasons/actions,</span></span>
<span id="cb3-169"><a href="#cb3-169" aria-hidden="true" tabindex="-1"></a>  <span class="co"># But we can confidently assume that "operator" means "driver of vehicle"</span></span>
<span id="cb3-170"><a href="#cb3-170" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (note: not used in the current version of the analysis, </span></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a>  <span class="co"># but a link to the file is made available in the bibliography</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a>operatorSummaryDF <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span> </span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(action)) <span class="sc">%&gt;%</span></span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"total"</span>, call_reason, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">opcategory =</span> <span class="fu">str_extract</span>(action, <span class="st">"Sex|Race|Ethnicity"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(opcategory) <span class="sc">%&gt;%</span></span>
<span id="cb3-178"><a href="#cb3-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"total"</span>, action, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-179"><a href="#cb3-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">opid =</span> action) <span class="sc">%&gt;%</span></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(town, year, opcategory, opid))  <span class="sc">%&gt;%</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_regex</span>(opid, <span class="fu">c</span>(<span class="at">opid =</span> <span class="st">"[A-Za-z/</span><span class="sc">\\</span><span class="st">-</span><span class="sc">\\</span><span class="st">s]+"</span>, <span class="at">opcount =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">s[0-9]{1,3}"</span>, <span class="st">".+"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">opcategory =</span> <span class="fu">factor</span>(opcategory),</span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a>         <span class="at">opid =</span> <span class="fu">str_squish</span>(opid),</span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a>         <span class="at">opid =</span> <span class="fu">factor</span>(opid),</span>
<span id="cb3-185"><a href="#cb3-185" aria-hidden="true" tabindex="-1"></a>         <span class="at">opcount =</span> <span class="fu">str_squish</span>(opcount),</span>
<span id="cb3-186"><a href="#cb3-186" aria-hidden="true" tabindex="-1"></a>         <span class="at">opcount =</span> <span class="fu">as.integer</span>(opcount))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>See the appendix for a data dictionary and sample summaries of each data frame.</p>
<p>The LPD call data does not show when police response is required or optional. There are also 121 call reasons. To make analysis simpler and yield insights about public safety need, I created 10 “public safety themes” and mapped one to each call reason. This is my interpretation of call reasons to create a taxonomy that permits interpretations of calls according to when police response is required in comparison with the calls that a police officer responds to because another type of first responder is not available. I will remain open to feedback and referrals to standard taxonomies, if any exist. One of the dilemmas of analyzing police data is a lack of clear policing data standards.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Public safety themes
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Administration</li>
<li>Fire</li>
<li>Medical</li>
<li>Mental Health or Social Work</li>
<li>Nonviolent Crime</li>
<li>Other Safety</li>
<li>Prevention</li>
<li>Utility</li>
<li>Vehicular</li>
<li>Violent Crime</li>
</ul>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a vector of all the factors, because I need to create a simpler taxonomy</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>callReasonNameFactors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"209A SERVICE"</span>, <span class="st">"209A VIOLATION"</span>, <span class="st">"911 CALL"</span>, <span class="st">"911 HANG UP"</span>, <span class="st">"911 MIS DIAL"</span>, <span class="st">"911 Text to 911"</span>, <span class="st">"ABANDONED 911 CALL"</span>, <span class="st">"ABANDONED MV"</span>, <span class="st">"ADMINISTRATIVE"</span>, <span class="st">"ALARM BURGLAR OR HOLDUP"</span>, <span class="st">"ANIMAL COMPLAINT"</span>, <span class="st">"ANNOYING PHONE CALLS"</span>, <span class="st">"ARTICLES LOST"</span>, <span class="st">"ARTICLES RECOVERED"</span>, <span class="st">"ASSAULT"</span>, <span class="st">"ASSIST CITIZEN"</span>, <span class="st">"ASSIST OTHER AGENCY"</span>, <span class="st">"BE ON THE LOOK OUT"</span>, <span class="st">"BREAKING &amp; ENTERING AUTO"</span>, <span class="st">"BREAKING &amp; ENTERING PAST"</span>, <span class="st">"BREAKING AND ENTERING"</span>, <span class="st">"BRUSH FIRE"</span>, <span class="st">"BUILDING/LOCATION CHECK"</span>, <span class="st">"BURN/AGRI PERMIT"</span>, <span class="st">"BYLAW VIOLATION"</span>, <span class="st">"Car vs. Deer"</span>, <span class="st">"CARBON MONOXIDE HAZARD"</span>, <span class="st">"CHECK WELFARE"</span>, <span class="st">"CHIMNEY FIRE"</span>, <span class="st">"Civil Issue"</span>, <span class="st">"COMMUNITY POLICING"</span>, <span class="st">"COMPLAINT"</span>, <span class="st">"COURT"</span>, <span class="st">"CRUISER MAINTENANCE"</span>, <span class="st">"CSO FOLLOW UP"</span>, <span class="st">"CSO OUTREACH"</span>, <span class="st">"CUSTODY ISSUE"</span>, <span class="st">"DEATH"</span>, <span class="st">"DETAIL REQUEST"</span>, <span class="st">"DISABLED MV"</span>, <span class="st">"DISTURBANCE"</span>, <span class="st">"DOMESTIC"</span>, <span class="st">"Drill/Testing"</span>, <span class="st">"DRUG OFFENSE"</span>, <span class="st">"DRUNK"</span>, <span class="st">"EMS ALARM - LIFELINE ACTIVATED"</span>, <span class="st">"ESCORT/TRANSPORT"</span>, <span class="st">"EXPLOSION"</span>, <span class="st">"FIGHT"</span>, <span class="st">"FIRE ALARM"</span>, <span class="st">"FIRE WORKS"</span>, <span class="st">"FIRE, OTHER NON-SPECIFIC"</span>, <span class="st">"FIREARMS LICENSING"</span>, <span class="st">"FOLLOW UP INVESTIGATION"</span>, <span class="st">"FRAUD/SCAM"</span>, <span class="st">"GAS LEAK"</span>, <span class="st">"GENERAL INFO"</span>, <span class="st">"HARASSMENT"</span>, <span class="st">"HIT AND RUN"</span>, <span class="st">"ILLEGAL BURN"</span>, <span class="st">"ILLEGAL DUMPING"</span>, <span class="st">"INVESTIGATION"</span>, <span class="st">"JUVENILE OFFENSES"</span>, <span class="st">"KEEP THE PEACE"</span>, <span class="st">"LARCENY"</span>, <span class="st">"LINE DOWN, POWER,PHONE OR CABL"</span>, <span class="st">"LOCKOUT"</span>, <span class="st">"MEDICAL EMERGENCY"</span>, <span class="st">"MISCELLANEOUS"</span>, <span class="st">"MISSING PERSON"</span>, <span class="st">"MOTOR VEHICLE - STOLEN"</span>, <span class="st">"MOTOR VEHICLE ACCIDE W/INJURY"</span>, <span class="st">"MOTOR VEHICLE ACCIDENT NO INJU"</span>, <span class="st">"MOTOR VEHICLE COMPLAINT"</span>, <span class="st">"MOTOR VEHICLE RECOVERED"</span>, <span class="st">"MOTOR VEHICLE VIOLATION"</span>, <span class="st">"NOISE COMPLAINT"</span>, <span class="st">"NOTIFICATION"</span>, <span class="st">"ODOR INVESTIGATION"</span>, <span class="st">"OFFICER WANTED"</span>, <span class="st">"OPEN DOOR"</span>, <span class="st">"Paid Detail"</span>, <span class="st">"PAPERWORK SERVICE"</span>, <span class="st">"PARKING COMPLAINT"</span>, <span class="st">"PATROL AREA"</span>, <span class="st">"POWER OUTAGE/FAILURE"</span>, <span class="st">"RADAR/TRAFFIC ENFORCEMENT"</span>, <span class="st">"RAPE"</span>, <span class="st">"REPOSSESSION"</span>, <span class="st">"RESCUE CALL"</span>, <span class="st">"ROLLING 9"</span>, <span class="st">"ROLLING Q2-1"</span>, <span class="st">"RUNAWAY"</span>, <span class="st">"SAFETY HAZARD"</span>, <span class="st">"SCHOOL RESOURCE OFFICER DUTIES"</span>, <span class="st">"SEARCH"</span>, <span class="st">"Section 12"</span>, <span class="st">"SERVE WARRANT"</span>, <span class="st">"SERVICE CALL"</span>, <span class="st">"SEX OFFENDER REGISTRATION"</span>, <span class="st">"SHOPLIFTING"</span>, <span class="st">"SHOTS FIRED"</span>, <span class="st">"SMOKE INVESTIGATION"</span>, <span class="st">"SOLICITING"</span>, <span class="st">"STRUCTURE FIRE"</span>, <span class="st">"SUICIDE COMMITTED"</span>, <span class="st">"SUICIDE THREAT"</span>, <span class="st">"SUMMONS SERVICE"</span>, <span class="st">"SUSPICIOUS ACTIVITY"</span>, <span class="st">"SUSPICIOUS PACKAGE"</span>, <span class="st">"SUSPICIOUS PERSON"</span>, <span class="st">"SUSPICIOUS VEHICLE"</span>, <span class="st">"SWATTING"</span>, <span class="st">"THREAT"</span>, <span class="st">"TRAFFIC CONTROL"</span>, <span class="st">"TRAFFIC HAZARD"</span>, <span class="st">"TRESPASS"</span>, <span class="st">"TRUANT"</span>, <span class="st">"UNWANTED PERSON"</span>, <span class="st">"VANDALISM"</span>, <span class="st">"VEHICLE FIRE"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># here is that simpler taxonomy!</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>callReasonNameThemes <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Mental Health or Social Work"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Administration"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Administration"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Fire"</span>, <span class="st">"Prevention"</span>, <span class="st">"Fire"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Fire"</span>, <span class="st">"Prevention"</span>, <span class="st">"Fire"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Prevention"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Administration"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Administration"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Medical"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Fire"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Fire"</span>, <span class="st">"Fire"</span>, <span class="st">"Fire"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Utility"</span>, <span class="st">"Administration"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Fire"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Administration"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Prevention"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Utility"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Medical"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Medical"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Administration"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Prevention"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Prevention"</span>, <span class="st">"Utility"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Administration"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Prevention"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Fire"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Fire"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Administration"</span>, <span class="st">"Prevention"</span>, <span class="st">"Prevention"</span>, <span class="st">"Prevention"</span>, <span class="st">"Prevention"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Fire"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>factorThemesDF <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">call_reason =</span> callReasonNameFactors, <span class="at">call_theme =</span> callReasonNameThemes) <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">factor</span>(call_reason),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">call_theme =</span> <span class="fu">factor</span>(call_theme))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> <span class="fu">left_join</span>(callReasonsDF, factorThemesDF, <span class="at">by =</span><span class="st">'call_reason'</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>callActionsDF <span class="ot">&lt;-</span> <span class="fu">left_join</span>(callActionsDF, factorThemesDF, <span class="at">by =</span><span class="st">'call_reason'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="analysis-plan" class="level3">
<h3 class="anchored" data-anchor-id="analysis-plan">Analysis Plan</h3>
<p>My goal is to analyze and visualize call data in answer to this question:</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Research question
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>What is the nature of public safety need behind the increase in calls that police respond to?</strong></p>
</div>
</div>
<p>My analysis plan is to answer the following more specific questions for both towns together, and compared between towns:</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Specific questions for analysis
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Has the time spent doing police work grown over time?</li>
<li>Leverett and Wendell began a regionalization agreement in 2020. How has that impacted the data of time spent on calls?</li>
<li>Which call reasons require the most personnel time?</li>
<li>What call reasons have grown the most over time, in terms of personnel time?</li>
<li>What call reasons have decreased the most in terms of personnel time?</li>
<li>What can we learn about the public safety impact of change in calls in terms of broad themes?</li>
</ol>
</div>
</div>
</section>
<section id="results-analysis-and-visualization" class="level2">
<h2 class="anchored" data-anchor-id="results-analysis-and-visualization">Results: Analysis and Visualization</h2>
<p>To prepare my data for presentation of growth trends compared between call reasons and themes over time, the first code chunk uses grouping and linear regression to calculate estimates of correlation coefficients, and joins and a tribble to package the results together in data frames that make for easier presentation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating summary DFs, first step is to estimate change in hours per year</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># will do this for each factor: call_reason, town, call_theme</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">########## trying out this awesomeness to model estimated change in hours each year for each call reason factor</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># https://r4stats.com/2017/04/18/group-by-modeling-in-r-made-easy/</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>tempGroupDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(<span class="fu">year</span>(year)))     <span class="co"># I convert to integer to pass to tidy() below</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># This way tidy() returns a model estimate with year unit as predictor</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># If I left it as a date, the model estimate unit would be 1 day rather than 1 year</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># this next df assignment produces a correlation of determination estimate of hourly increase with year as a predictor:</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># For each factor call reason, the estimate is how many hours we expect the factor to change in 1 year.</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># note that this does not meet the test for statistical significance - p-values in this model are higher than is acceptable.</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># this is primarily meant to determine order of factors in terms of predicted change based on the small data set.</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>crHoursEstByYear <span class="ot">&lt;-</span> <span class="fu">do</span>(tempGroupDF, </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tidy</span>(</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>     <span class="fu">lm</span>(totalHours <span class="sc">~</span> year, <span class="at">data =</span> .))) <span class="sc">%&gt;%</span>      <span class="co"># tidy() creates a tibble from a linear model</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span>                    <span class="co"># removes intercept values, not needed for this simple analysis</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estYearlyHourChange_Reason =</span> <span class="fu">round</span>(estimate, <span class="dv">1</span>)) <span class="sc">%&gt;%</span>      <span class="co"># replacing NA with 0 - small n, assume no growth</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(estimate)) <span class="sc">%&gt;%</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(call_reason, estYearlyHourChange_Reason))</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co"># from https://bookdown.org/pdr_higgins/rmrwr/linear-regression-and-broom-for-tidying-models.html</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># "the second column is the estimate. This is the point estimate of the effect of each predictor in the multivariable model. For the intraOp_surgerySize predictor, this is 0.316. This means that for each unit or level increase of intraOp_surgerySize, which is defined on a 1-3 scale from small to large, the pacu_30min_throat pain (on a 0-10 scale), increases by 0.316 points. So a large surgery (2 levels larger than small) will result in, on average, a pacu_30min_throat pain score 0.632 points higher than a small surgery."</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(crHoursEstByYear, <span class="at">by =</span> <span class="fu">join_by</span>(call_reason))</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(estYearlyHourChange_Reason))       <span class="co"># omit call reasons with NA values estimated growth, these have the lowest incidence </span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tempGroupDF)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(crHoursEstByYear)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>tempGroupDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls_Reason =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours_Reason =</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tempGroupDF, <span class="at">by =</span> <span class="fu">join_by</span>(call_reason))</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a><span class="do">########## do that again for theme</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>tempGroupDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_theme) <span class="sc">%&gt;%</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(<span class="fu">year</span>(year))) </span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>crHoursEstByYear <span class="ot">&lt;-</span> <span class="fu">do</span>(tempGroupDF, </span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tidy</span>(</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>     <span class="fu">lm</span>(totalHours <span class="sc">~</span> year, <span class="at">data =</span> .))) <span class="sc">%&gt;%</span>      </span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span>                    </span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estYear_HoursByTheme =</span> <span class="fu">round</span>(estimate, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(estimate)) <span class="sc">%&gt;%</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(call_theme, estYear_HoursByTheme))</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(crHoursEstByYear, <span class="at">by =</span> <span class="fu">join_by</span>(call_theme))</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(estYear_HoursByTheme)) </span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tempGroupDF)</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(crHoursEstByYear)</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize df for theme: group by year</span></span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>tempGroupDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_theme) <span class="sc">%&gt;%</span></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls_Theme =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours_Theme =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tempGroupDF, <span class="at">by =</span> <span class="fu">join_by</span>(call_theme))</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a><span class="do">##########</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a><span class="do">### summary and linear model (lm) calculations for presentation</span></span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>crYearDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>crTownYearDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(town, year) <span class="sc">%&gt;%</span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>crTownYearThemeDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(town, year, call_theme) <span class="sc">%&gt;%</span></span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate growth percentage of hours worked</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>crYeargrowthPct <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">paste0</span>(<span class="fu">round</span>(</span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>  (crYearDF[<span class="dv">5</span>,<span class="dv">3</span>] <span class="sc">-</span> crYearDF[<span class="dv">1</span>,<span class="dv">3</span>]) <span class="sc">/</span> crYearDF[<span class="dv">1</span>,<span class="dv">3</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)[[<span class="dv">1</span>]],</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%"</span>))</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>crLevgrowthPct <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">paste0</span>(<span class="fu">round</span>(</span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>  (crTownYearDF[<span class="dv">5</span>,<span class="dv">4</span>] <span class="sc">-</span> crTownYearDF[<span class="dv">1</span>,<span class="dv">4</span>]) <span class="sc">/</span> crTownYearDF[<span class="dv">1</span>,<span class="dv">4</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)[[<span class="dv">1</span>]],</span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%"</span>))</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>crWengrowthPct <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">paste0</span>(<span class="fu">round</span>(</span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>  (crTownYearDF[<span class="dv">10</span>,<span class="dv">4</span>] <span class="sc">-</span> crTownYearDF[<span class="dv">6</span>,<span class="dv">4</span>]) <span class="sc">/</span> crTownYearDF[<span class="dv">6</span>,<span class="dv">4</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)[[<span class="dv">1</span>]],</span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%"</span>))</span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate linear model coefficient estimate of x (hour increase by year)</span></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a>crYeargrowthLM <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">lm</span>(totalHours <span class="sc">~</span> <span class="fu">year</span>(year), </span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> crYearDF)<span class="sc">$</span>coefficients[<span class="dv">2</span>], <span class="dv">1</span>)</span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>crYeargrowthLMChar <span class="ot">&lt;-</span> <span class="fu">as.character</span>(crYeargrowthLM)</span>
<span id="cb5-131"><a href="#cb5-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-132"><a href="#cb5-132" aria-hidden="true" tabindex="-1"></a>crLevgrowthLM <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">lm</span>(totalHours <span class="sc">~</span> <span class="fu">year</span>(year), </span>
<span id="cb5-133"><a href="#cb5-133" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> <span class="fu">filter</span>(crTownYearDF, </span>
<span id="cb5-134"><a href="#cb5-134" aria-hidden="true" tabindex="-1"></a>                                        town <span class="sc">==</span> <span class="st">"Leverett"</span>)</span>
<span id="cb5-135"><a href="#cb5-135" aria-hidden="true" tabindex="-1"></a>                          )<span class="sc">$</span>coefficients[<span class="dv">2</span>], <span class="dv">1</span>)</span>
<span id="cb5-136"><a href="#cb5-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-137"><a href="#cb5-137" aria-hidden="true" tabindex="-1"></a>crWengrowthLM <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">lm</span>(totalHours <span class="sc">~</span> <span class="fu">year</span>(year), </span>
<span id="cb5-138"><a href="#cb5-138" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> <span class="fu">filter</span>(crTownYearDF, </span>
<span id="cb5-139"><a href="#cb5-139" aria-hidden="true" tabindex="-1"></a>                                        town <span class="sc">==</span> <span class="st">"Wendell"</span>)</span>
<span id="cb5-140"><a href="#cb5-140" aria-hidden="true" tabindex="-1"></a>                          )<span class="sc">$</span>coefficients[<span class="dv">2</span>], <span class="dv">1</span>)</span>
<span id="cb5-141"><a href="#cb5-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-142"><a href="#cb5-142" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate weekly hour increase per lm</span></span>
<span id="cb5-143"><a href="#cb5-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-144"><a href="#cb5-144" aria-hidden="true" tabindex="-1"></a>crYeargrowthLMweekChar <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">round</span>(crYeargrowthLM <span class="sc">/</span> <span class="dv">52</span>, <span class="dv">1</span>))</span>
<span id="cb5-145"><a href="#cb5-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-146"><a href="#cb5-146" aria-hidden="true" tabindex="-1"></a>crYeargrowthLMweek <span class="ot">&lt;-</span> <span class="fu">round</span>(crYeargrowthLM <span class="sc">/</span> <span class="dv">52</span>, <span class="dv">1</span>)</span>
<span id="cb5-147"><a href="#cb5-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-148"><a href="#cb5-148" aria-hidden="true" tabindex="-1"></a>crLevgrowthLMweek <span class="ot">&lt;-</span> <span class="fu">round</span>(crLevgrowthLM <span class="sc">/</span> <span class="dv">52</span>, <span class="dv">1</span>)</span>
<span id="cb5-149"><a href="#cb5-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-150"><a href="#cb5-150" aria-hidden="true" tabindex="-1"></a>crWengrowthLMweek <span class="ot">&lt;-</span> <span class="fu">round</span>(crWengrowthLM <span class="sc">/</span> <span class="dv">52</span>, <span class="dv">1</span>)</span>
<span id="cb5-151"><a href="#cb5-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-152"><a href="#cb5-152" aria-hidden="true" tabindex="-1"></a>  <span class="co"># assume standard 40-hour work week</span></span>
<span id="cb5-153"><a href="#cb5-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-154"><a href="#cb5-154" aria-hidden="true" tabindex="-1"></a>assumedFTE <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb5-155"><a href="#cb5-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-156"><a href="#cb5-156" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate hour increase per lm in terms of weekly FTE</span></span>
<span id="cb5-157"><a href="#cb5-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-158"><a href="#cb5-158" aria-hidden="true" tabindex="-1"></a>crYeargrowthFTE <span class="ot">&lt;-</span> <span class="fu">round</span>(crYeargrowthLM <span class="sc">/</span> <span class="dv">52</span> <span class="sc">/</span> assumedFTE, <span class="dv">2</span>)</span>
<span id="cb5-159"><a href="#cb5-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-160"><a href="#cb5-160" aria-hidden="true" tabindex="-1"></a>crYeargrowthFTEChar <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">round</span>(crYeargrowthLM <span class="sc">/</span> <span class="dv">52</span> <span class="sc">/</span> assumedFTE, <span class="dv">2</span>))</span>
<span id="cb5-161"><a href="#cb5-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-162"><a href="#cb5-162" aria-hidden="true" tabindex="-1"></a>crLevgrowthFTE <span class="ot">&lt;-</span> <span class="fu">round</span>(crLevgrowthLM <span class="sc">/</span> <span class="dv">52</span> <span class="sc">/</span> assumedFTE, <span class="dv">2</span>)</span>
<span id="cb5-163"><a href="#cb5-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-164"><a href="#cb5-164" aria-hidden="true" tabindex="-1"></a>crWengrowthFTE <span class="ot">&lt;-</span> <span class="fu">round</span>(crWengrowthLM <span class="sc">/</span> <span class="dv">52</span> <span class="sc">/</span> assumedFTE, <span class="dv">2</span>)</span>
<span id="cb5-165"><a href="#cb5-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-166"><a href="#cb5-166" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb5-167"><a href="#cb5-167" aria-hidden="true" tabindex="-1"></a><span class="do">### end of summary and lm calculations </span></span>
<span id="cb5-168"><a href="#cb5-168" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb5-169"><a href="#cb5-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-170"><a href="#cb5-170" aria-hidden="true" tabindex="-1"></a><span class="do">### now assign to df for presentation:</span></span>
<span id="cb5-171"><a href="#cb5-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-172"><a href="#cb5-172" aria-hidden="true" tabindex="-1"></a>crtyGrowthDF <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb5-173"><a href="#cb5-173" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>town, <span class="sc">~</span>total_growth,  <span class="sc">~</span>yr_hr_growth, <span class="sc">~</span>wk_hr_growth, <span class="sc">~</span>fte_growth,</span>
<span id="cb5-174"><a href="#cb5-174" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Leverett"</span>, crLevgrowthPct, crLevgrowthLM, crLevgrowthLMweek, crLevgrowthFTE,</span>
<span id="cb5-175"><a href="#cb5-175" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Wendell"</span>, crWengrowthPct, crWengrowthLM, crWengrowthLMweek, crWengrowthFTE,</span>
<span id="cb5-176"><a href="#cb5-176" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Both Towns"</span>, crYeargrowthPct, crYeargrowthLM, crYeargrowthLMweek, crYeargrowthFTE</span>
<span id="cb5-177"><a href="#cb5-177" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="total-hours-working-on-calls" class="level3">
<h3 class="anchored" data-anchor-id="total-hours-working-on-calls">Total hours working on calls</h3>
<p>The first question for a municipal department is about what impacts the budget. For this, three key metrics are call volume, average hours worked per call reason, and total hours worked. I took these steps to create the first plot:</p>
<ol type="1">
<li>Grouped by call reason and town to summarize hours.</li>
<li>Constructed an area plot with an lm trend line.</li>
</ol>
<p>The change in total hours worked over time shows the big picture:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">### first plot shows the big picture: change in total hours</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, town) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> totalHours, <span class="at">fill =</span> town)) <span class="sc">+</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total hours: Police officers working on calls"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkTotalHours-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The big picture shows <strong>81.2% growth</strong> in total hours worked by police officers in the two towns together <strong>from 2018 to 2022</strong>.</p>
<p>Another way to express this is with a linear model, the <strong><span style="color:orangered;">orange trend line</span></strong>: we’ve seen the two towns add <strong>86.3 hours</strong> of policing every year. This could be useful for the town’s personnel planning. Assuming a <strong>40-hour full-time equivalence (FTE)</strong> and an increase of 86.3 hours per year (or <strong>1.7 hours per week</strong>), Leverett and Wendell police call hours grow by <strong>0.04 FTE each year</strong>.</p>
<p>For these simple models, I have omitted call reasons with incidence too low to calculate estimated growth. These had NA values for the correlation coefficient which complicates the analysis, and since these call reasons are so infrequent their omission is not to the detriment of analysis.</p>
<p>This answers the first question:</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Specific question for analysis
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Has the time spent doing police work grown over time?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An answer!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Yes, Leverett and Wendell added 86.3 hours of policing, or 0.04 FTE, every year from 2018 to 2022</p>
</div>
</div>
<p>Note that 2,080 hours is a year’s worth of FTE, and the call data show that the total hours spent policing in both towns is less than 1 FTE.</p>
<p>Call hour workload is an important factor in public safety personnel management. There is also the need for sufficient coverage so officers are available to respond to calls when they come in. There is also the self-determination of the community: the people who live in a town contribute by right to decisions about public safety. Although these are both necessary elements of a full understanding of policing and public safety, they’re beyond the scope of this analysis.</p>
</section>
<section id="comparing-towns" class="level3">
<h3 class="anchored" data-anchor-id="comparing-towns">Comparing towns</h3>
<p>What else could we learn from this data set about what drives this growth in policing?</p>
<p>A simple next step is to compare the towns. Faceting by town lets us compare the change in calls and hours worked over the 5-year period:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># total call volume by town</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> crTownYearDF <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> totalCalls, <span class="at">fill =</span> town)) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total call volume by town"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Calls"</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(town))</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># total hours by town</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> crTownYearDF <span class="sc">%&gt;%</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> totalHours, <span class="at">fill =</span> town)) <span class="sc">+</span> </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total hours by town"</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(town))</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g1, g2, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByTown-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Most calls come from Leverett and the LPD works most hours in response to Leverett calls. <strong><span style="color:orangered;">Orange trend lines</span></strong> have a positive slope on all 4 plots, slightly more so for Wendell. This means that there is a positive correlation coefficient when using year as a predictor of total hours: positive growth over time.</p>
<p>Using the same analysis that I applied to total hours, this table summarizes rates of change that correspond to the <strong><span style="color:orangered;">orange trend line</span></strong> in these plots:</p>
<section id="growth-trends-total-hours-by-town" class="level4">
<h4 class="anchored" data-anchor-id="growth-trends-total-hours-by-town">Growth trends: Total hours by town</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>crtyGrowthDF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["town"],"name":[1],"type":["chr"],"align":["left"]},{"label":["total_growth"],"name":[2],"type":["chr"],"align":["left"]},{"label":["yr_hr_growth"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["wk_hr_growth"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["fte_growth"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Leverett","2":"83.8%","3":"37.0","4":"0.7","5":"0.02"},{"1":"Wendell","2":"73.1%","3":"49.3","4":"0.9","5":"0.02"},{"1":"Both Towns","2":"81.2%","3":"86.3","4":"1.7","5":"0.04"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This reveals that Wendell, despite their low proportion of calls and hours, has driven most growth in calls compared with Leverett.</p>
<p>It’s more accurate and fair to say that missing data from Wendell has driven the appearance of more than half of the rate of growth in the data. As described earlier, I learned from my discussion with LPD Chief Minckler that Wendell’s former police chief didn’t log calls consistently. Improved data input by LPD officers has created a more accurate record of policing in Wendell. It’s possible to use this data set to estimate Wendell’s past police call data, but that’s beyond the scope of this analysis.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Specific questions for analysis
</div>
</div>
<div class="callout-body-container callout-body">
<ol start="2" type="1">
<li>Leverett and Wendell began a regionalization agreement in 2020. How has that impacted the data of time spent on calls?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An answer!
</div>
</div>
<div class="callout-body-container callout-body">
<p>By taking responsibility for policing in Wendell, LPD officers have improved call data about Wendell policing, bringing it up to LPD quality. When summarizing data inclusively before and after regionalization, Wendell shows <strong>73.1% growth</strong> in hours on calls from 2018 to 2022 – or what appears to be <strong>0.9 additional hours</strong> of police work every week.</p>
<p>Anecdotally, I learned from LPD Chief Minckler that the previous Wendell police chief did not log all calls. This probably explains Wendell’s high rate. Two to three years from now, LPD will have more data and experience to support a confident assessment of Wendell’s true policing needs.</p>
</div>
</div>
</section>
</section>
<section id="comparing-call-reasons" class="level3">
<h3 class="anchored" data-anchor-id="comparing-call-reasons">Comparing call reasons</h3>
<p>With 122 factor levels, the plot of total hours by call reason is a blur and the legend would take up the whole page. This plot is only useful to show the complication of grouping by call reasons:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>crYearReason <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>crYearReason <span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> totalHours, <span class="at">fill =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total hours by call reason"</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByReason1-1.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># will use this in next chunk to get proportion of each call reason factor</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>grandTotalHours <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sum</span>(callReasonsDF<span class="sc">$</span>totalHours), <span class="dv">0</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>grandTotalHoursChar <span class="ot">=</span> <span class="fu">as.character</span>(<span class="fu">format</span>(grandTotalHours, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="top-level-of-effort-call-reasons" class="level4">
<h4 class="anchored" data-anchor-id="top-level-of-effort-call-reasons">Top level-of-effort call reasons</h4>
<p>Grouping by <code>call_reason</code> and summing total hours allows me to learn which types of calls take the most time. This lollipop plot shows the top 30 call reasons in terms of hours worked in both towns over the 5-year period. From 2018 to 2022, there was <strong>a grand total of 6,263 hours</strong> for all calls in both towns. Each lollipop in the plot shows the absolute number of hours and the percentage of the grand total.</p>
<p>I used factors ordered by linear regression estimates made in a previous code chunk to find the top N call reasons by rate of growth.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this gets factors of top 30 call reasons by hours worked</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>crFactorTotals <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">round</span>(<span class="fu">sum</span>(totalHours), <span class="dv">1</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> crFactorTotals <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(totalHours)) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, totalHours)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span>    <span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>                                                              <span class="co"># it works in this plot but not the next one...</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> totalHours, <span class="at">y =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"dodgerblue4"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  </span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(percentOfAllHours, <span class="st">"%"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1500</span>),</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">250</span>),</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">50</span>),</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"top"</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top level-of-effort"</span>,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"Top 30 call reasons 2018-2022 (# of hours, % of all hours)"</span>,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Level-of-effort: Total hours worked"</span>,</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Reasons (top to bottom: most to least LOE)"</span>) <span class="sc">+</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_viridis(discrete = T, option = "cividis") +</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByReason2-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Specific questions for analysis
</div>
</div>
<div class="callout-body-container callout-body">
<ol start="3" type="1">
<li>Which call reasons require the most personnel time?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An answer!
</div>
</div>
<div class="callout-body-container callout-body">
<div data-pagedtable="false">

<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["call_reason"],"name":[1],"type":["fct"],"align":["left"]},{"label":["totalHours"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"RADAR/TRAFFIC ENFORCEMENT","2":"1308.7"},{"1":"ADMINISTRATIVE","2":"818.0"},{"1":"MOTOR VEHICLE VIOLATION","2":"608.6"},{"1":"MEDICAL EMERGENCY","2":"377.7"},{"1":"BUILDING/LOCATION CHECK","2":"312.5"},{"1":"MOTOR VEHICLE ACCIDENT NO INJU","2":"194.8"},{"1":"COMMUNITY POLICING","2":"154.4"},{"1":"ANIMAL COMPLAINT","2":"152.5"},{"1":"TRAFFIC HAZARD","2":"142.7"},{"1":"LINE DOWN, POWER,PHONE OR CABL","2":"122.1"},{"1":"OFFICER WANTED","2":"118.4"},{"1":"CRUISER MAINTENANCE","2":"116.4"},{"1":"SAFETY HAZARD","2":"107.0"},{"1":"CHECK WELFARE","2":"101.4"},{"1":"PATROL AREA","2":"101.4"},{"1":"TRAFFIC CONTROL","2":"98.6"},{"1":"ASSIST CITIZEN","2":"96.7"},{"1":"FIREARMS LICENSING","2":"91.5"},{"1":"DISABLED MV","2":"87.7"},{"1":"FOLLOW UP INVESTIGATION","2":"78.1"},{"1":"911 CALL","2":"67.1"},{"1":"ALARM BURGLAR OR HOLDUP","2":"65.6"},{"1":"MOTOR VEHICLE COMPLAINT","2":"63.1"},{"1":"ASSIST OTHER AGENCY","2":"63.0"},{"1":"PAPERWORK SERVICE","2":"48.8"},{"1":"MISCELLANEOUS","2":"38.0"},{"1":"FIRE ALARM","2":"37.8"},{"1":"NOTIFICATION","2":"35.1"},{"1":"INVESTIGATION","2":"33.9"},{"1":"SUSPICIOUS VEHICLE","2":"28.9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We can facet plot to zoom in on the top 9 reasons, and see a correlation coefficient for each one. Some trend up, some trend down. This is interesting, but difficult to see a helpful pattern.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># next we only want top 9 reasons with the most total call hours</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> topHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(totalHours)) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>crTopHours <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason, year) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, totalHours)) </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>       <span class="co"># this fct_reorder isn't working to reorder, although it works in the previous chunk</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>crTopHours <span class="sc">%&gt;%</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> totalHours, </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">8</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leaderboard: Top level-of-effort"</span>,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"9 call reasons with the most hours"</span>,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>call_reason) <span class="sc">+</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> </span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>          <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByReason3-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="top-growth-call-reasons" class="level4">
<h4 class="anchored" data-anchor-id="top-growth-call-reasons">Top growth call reasons</h4>
<p>Since we can calculate a trend line for each call reason, we can identify the call reasons with the steepest trend lines as a representation of call level-of-effort that has grown the most since 2018. The next lollipop plot shows the top 30 call reasons by growth. In parity with the previous plot, the <span style="color:blue;">blue</span> and <span style="color:orangered;">orange</span> lollipops still represent total hours worked.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this gets factors of top 30 call reasons by growth in hours</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>crFactorTotals2 <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimateChangeHours =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(topHourFactors) <span class="co"># clear the previous df</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> crFactorTotals2 <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(estimateChangeHours)) <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, estYearlyHourChange_Reason)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span>    </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>      <span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>      <span class="co"># does it work in this plot?</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> totalHours, <span class="at">y =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"dodgerblue4"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">"+"</span>, estYearlyHourChange_Reason, <span class="st">" hrs/yr"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1100</span>),</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">250</span>),</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">50</span>),</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"top"</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top growth"</span>,</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"Top 30 call reasons by growth"</span>,</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Level-of-effort: Total hours worked"</span>,</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Reasons (top to bottom: most to least growth)"</span>) <span class="sc">+</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_viridis(discrete = T, option = "cividis") +</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByReason5-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>The top 9 facets by growth reveal somewhat more clearly the public safety landscape of these two towns.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># next we only want top 9 high growth reasons with the most total call hours</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> topHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(estimateChangeHours)) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>crTopGrowthHours <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason, year) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, estYearlyHourChange_Reason)) </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># this fct_reorder isn't working to reorder the facets</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>crTopGrowthHours <span class="sc">%&gt;%</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> totalHours, </span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">8</span>,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leaderboard: Top growth"</span>,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"9 call reasons that have grown the most"</span>,</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>call_reason) <span class="sc">+</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> </span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>          <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByReason6-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Or – an important reminder that volume and rate are independent from each other – we may have a set of public safety needs with a mixture of causes. For example, do these rates of change reflect administrative changes in record keeping? Do ‘assist citizen’ and ‘officer wanted’ call trends represent change in public safety needs, or change in how calls are logged? Has the incidence of death been so infrequent, or were calls about a person’s death coded differently during 2019 and 2020? This data won’t answer these questions, but my hope is that people can use this analysis will help prompt and clarify questions like these.</p>
</section>
<section id="top-impact-call-reasons" class="level4">
<h4 class="anchored" data-anchor-id="top-impact-call-reasons">Top impact call reasons</h4>
<p>Let’s combine total hours with top growth to get a better sense of call reasons with the most impact.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this gets factors of top 30 call reasons with top hours worked by growth in hours</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(crFactorTotals2)  <span class="co"># clear the previous df</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>crFactorTotals2 <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">productImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(topHourFactors) <span class="co"># clear the previous df</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> crFactorTotals2 <span class="sc">%&gt;%</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(productImpact)) <span class="sc">%&gt;%</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">productImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, productImpact)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span>    </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># does it work in this plot?</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> totalHours, <span class="at">y =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"dodgerblue4"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> </span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">"+"</span>, estYearlyHourChange_Reason, <span class="st">" hrs/yr"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1100</span>),</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">250</span>),</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">50</span>),</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"top"</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top impact"</span>,</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"30 call reasons with top level-of-effort and top growth"</span>,</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Level-of-effort: Total hours worked"</span>,</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Reasons (top to bottom: most to least impact)"</span>) <span class="sc">+</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_viridis(discrete = T, option = "cividis") +</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByReason7-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Now we can examine the 9 facets of the most impactful call reasons:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> topHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(productImpact)) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>crTopGrowthHours <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason, year) <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">productImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, productImpact)) </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># this fct_reorder isn't working to reorder the facets</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>crTopGrowthHours <span class="sc">%&gt;%</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> totalHours, </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">8</span>,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leaderboard: Top impact"</span>,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"9 call reasons with the most hours that have grown the most"</span>,</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>call_reason) <span class="sc">+</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> </span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>          <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByReason8-1.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> topHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(call_reason, totalHours, estYearlyHourChange_Reason))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Specific questions for analysis
</div>
</div>
<div class="callout-body-container callout-body">
<ol start="4" type="1">
<li>What call reasons have grown the most over time, in terms of personnel time?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An answer!
</div>
</div>
<div class="callout-body-container callout-body">
<div data-pagedtable="false">

<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["call_reason"],"name":[1],"type":["fct"],"align":["left"]},{"label":["totalHours"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["estYearlyHourChange_Reason"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"ADMINISTRATIVE","2":"817.99700","3":"6.0"},{"1":"MEDICAL EMERGENCY","2":"377.66267","3":"3.2"},{"1":"ANIMAL COMPLAINT","2":"152.46383","3":"5.5"},{"1":"COMMUNITY POLICING","2":"154.35833","3":"4.6"},{"1":"ASSIST CITIZEN","2":"96.74150","3":"4.9"},{"1":"LINE DOWN, POWER,PHONE OR CABL","2":"122.14267","3":"3.1"},{"1":"OFFICER WANTED","2":"118.35683","3":"2.4"},{"1":"CHECK WELFARE","2":"101.41583","3":"2.0"},{"1":"ASSIST OTHER AGENCY","2":"63.02283","3":"2.0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="bottom-impact-call-reasons" class="level4">
<h4 class="anchored" data-anchor-id="bottom-impact-call-reasons">Bottom impact call reasons</h4>
<p>Which call reasons have decreased the most?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this gets factors of bottom 30 call reasons with top hours worked by growth in hours</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(crFactorTotals2)  <span class="co"># clear the previous df</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>crFactorTotals2 <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">productLeastImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>bottomHourFactors <span class="ot">&lt;-</span> crFactorTotals2 <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(productLeastImpact)) <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">productLeastImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, productLeastImpact)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(bottomHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span>    </span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># does it work in this plot?</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> totalHours, <span class="at">y =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"dodgerblue4"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(estYearlyHourChange_Reason, <span class="st">" hrs/yr"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1600</span>),</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1600</span>, <span class="dv">250</span>),</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1600</span>, <span class="dv">50</span>),</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"bottom"</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bottom impact"</span>,</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"30 call reasons with the most negative growth </span></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a><span class="st">and most level-of-effort"</span>,</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Level-of-effort: Total hours worked"</span>,</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Reasons (top to bottom: least to most negative impact"</span>) <span class="sc">+</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_viridis(discrete = T, option = "cividis") +</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByReason9-1.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>bottomHourFactors <span class="ot">&lt;-</span> bottomHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(productLeastImpact)) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>crBottomGrowthHours <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason, year) <span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">productLeastImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(bottomHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, productLeastImpact)) </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># this fct_reorder isn't working to reorder the facets</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>crBottomGrowthHours <span class="sc">%&gt;%</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> totalHours, </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">8</span>,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>,</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leaderboard: Bottom impact"</span>,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"9 call reasons with the most hours that have decreased the most"</span>,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>call_reason) <span class="sc">+</span></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>          <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByReason9-2.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>bottomHourFactors <span class="ot">&lt;-</span> bottomHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(call_reason, totalHours, estYearlyHourChange_Reason))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Specific questions for analysis
</div>
</div>
<div class="callout-body-container callout-body">
<ol start="5" type="1">
<li>What call reasons have decreased the most in terms of personnel time?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An answer!
</div>
</div>
<div class="callout-body-container callout-body">
<div data-pagedtable="false">

<script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["call_reason"],"name":[1],"type":["fct"],"align":["left"]},{"label":["totalHours"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["estYearlyHourChange_Reason"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"SEARCH","2":"10.95133","3":"-10.6"},{"1":"FIREARMS LICENSING","2":"91.48067","3":"-1.5"},{"1":"MOTOR VEHICLE ACCIDENT NO INJU","2":"194.77250","3":"-1.3"},{"1":"TRAFFIC CONTROL","2":"98.56733","3":"-3.8"},{"1":"SAFETY HAZARD","2":"106.96050","3":"-5.1"},{"1":"TRAFFIC HAZARD","2":"142.70850","3":"-5.4"},{"1":"BUILDING/LOCATION CHECK","2":"312.53967","3":"-9.2"},{"1":"MOTOR VEHICLE VIOLATION","2":"608.58983","3":"-9.4"},{"1":"RADAR/TRAFFIC ENFORCEMENT","2":"1308.72983","3":"-36.8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="comparing-themes" class="level2">
<h2 class="anchored" data-anchor-id="comparing-themes">Comparing themes</h2>
<p>I would still find it helpful to paint with a broader brush. As I described earlier, I interpreted each of the 122 call reasons according to 10 call themes:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Public safety themes
</div>
</div>
<div class="callout-body-container callout-body">
<p>Administration, Fire, Medical, Mental Health or Social Work, Nonviolent Crime, Other Safety, Prevention, Utility, Vehicular, Violent Crime</p>
</div>
</div>
<p>Let’s find out impact in terms of theme.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_theme) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYear_HoursByTheme =</span> <span class="fu">mean</span>(estYear_HoursByTheme),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">productImpact =</span> <span class="fu">mean</span>(estYear_HoursByTheme) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_theme =</span> <span class="fu">fct_reorder</span>(call_theme, productImpact)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> totalHours, <span class="at">y =</span> call_theme)) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"purple4"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(estYear_HoursByTheme, <span class="st">" hrs/yr"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2900</span>),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2900</span>, <span class="dv">500</span>),</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2900</span>, <span class="dv">250</span>),</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"bottom"</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Thematic impact"</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"Call themes by level-of-effort and growth"</span>,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Level-of-effort: Total hours worked"</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Themes (top to bottom: most to least impact)"</span>) <span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByTheme1-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_theme, year) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYear_HoursByTheme =</span> <span class="fu">mean</span>(estYear_HoursByTheme),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">productImpact =</span> <span class="fu">mean</span>(estYear_HoursByTheme) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_theme =</span> <span class="fu">fct_reorder</span>(call_theme, productImpact)) <span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> totalHours, </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> call_theme)) <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">8</span>,</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leaderboard: Theme impact"</span>,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>call_theme) <span class="sc">+</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> </span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="TimShores_FinalProject_files/figure-html/chunkByTheme2-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Specific questions for analysis
</div>
</div>
<div class="callout-body-container callout-body">
<ol start="6" type="1">
<li>What can we learn about the public safety impact of change in calls in terms of broad themes?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An answer!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Call themes with substantial growth are, from most to least impact: Administration, Other Safety, Medical, Utility, and Prevention.</p>
<p>Call themes with small growth and impact: Nonviolent Crime, Fire, and Mental Health or Social Work.</p>
<p>One call theme has negative growth and small impact: Violent Crime.</p>
<p>One call theme has negative growth and enormous impact: Vehicular.</p>
</div>
</div>
<section id="conclusion-and-discussion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-and-discussion">Conclusion and Discussion</h3>
<p>This was the story of two small, rural Massachusetts towns that have made an agreement to combine their local police departments. By collecting, transforming, and analyzing 5 years of police call data, I’ve uncovered details about the share of call volume and level-of-effort between the towns, comparison of the level-of-effort of call reasons and how that effort has grown or decreased in the 5-year period, and more broadly, the comparison of level-of-effort growth and decrease observed in 10 public safety themes.</p>
<p>By pursuing 6 lines of specific inquiry, my goal was to answer the following general research question:</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Research question
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>What is the nature of public safety need behind the increase in calls that police respond to?</strong></p>
</div>
</div>
<p>The nature of increased public safety need in Leverett and Wendell appears to be primarily administrative in nature, followed by a variety of ‘other safety’ calls, medical first response, support of utility service providers, and preventive policing.</p>
<p>My research was prompted by the LPD request to the town to create a 4th full-time police officer position to overcome these problems:</p>
<ol type="1">
<li>Decreased supply of police officer human resources due to state criminal justice reform.</li>
<li>Increased demand for police officer human resources due to increased call volume in the towns of Leverett and Wendell.</li>
</ol>
<p>Human resource and scheduling needs are important and the problems of POST reform are significant, however the first question is not within the scope of my research question.</p>
<p>For the second question, I propose that my analysis shows the inadequacy of a rationale for hiring based on increased call volume without consideration of how level-of-effort (hours per call) has changed. Police hours on calls in Leverett and Wendell, with a department of 3 full-time officers, have not exceeded 1 FTE in the 5-year period 2018-2022. At a growth rate of +0.04 FTE/year it will take 25 years to justify LPD personnel growth by 1 FTE. In addition, I propose that the cause of emergency calls that police respond to is important: If these towns are dealing primarily with unmet medical needs and increased utility work along with administrative tasks, I find it difficult to understand how more police officers will help meet these needs. Since most our increased needs appear to be about administration, medical emergency, and utility service support, hiring additional police officers seems like the wrong move.</p>
<p>More officers would likely help with preventive policing and ‘other safety’ calls, and the case can be made that the efforts of preventive policing have contributed to the low growth rate of nonviolent crime and the negative rate of violent crime. Setting aside that this data doesn’t verify a causal relationship between prevention work and crime rates, the low crime numbers throughout the 5-year period makes me want to find out how much more reduction is possible, and whether the amount of work done on preventive police activities is proportional.</p>
<p>If I could recommend a course of action to Leverett and Wendell, it would be to take a closer look at administration, ‘other safety’, medical, utility, and prevention calls: ask if policing is the efficacious public response to the needs that drive these calls, or whether there are alternatives to policing that could better meet needs and ease the challenge of public administration. It so happens that I can make this recommendation, because I live here and I have been active in my town’s government.</p>
<p>My analysis is limited by assumptions made about the call data as an accurate representation of public safety incidents and police response – when in fact we’ve learned that Wendell call data is very poor quality before 2020. My attempt to classify call reasons by themes is not well-informed by criminal justice standards, and I’d need to address this before others could adopt the methodology. My plots reflect my inexperience with linear regression modeling, and my aesthetic deficits.</p>
<p>If I continue my research of this topic, I’d like to search for data that supports analysis about:</p>
<ul>
<li>The relationship between level-of-effort and change over time to call actions taken by officers, details of which are included in this data set.</li>
<li>Demographics of people involved in calls (responding officers, suspects, victims and other affected parties), which is only partially included in this data set.</li>
<li>Police work details not included in this data, such as time of year, day of week, and time of day patterns; geographic information; officer call notes; and relationships between different calls reasons.</li>
</ul>
<p>I hope that my data and thematic analysis demonstrates an approach to examining police work in a rural small town setting that’s useful to municipal administrators responsible for police oversight, personnel budgets, public safety decision-making, and data-driven community dialogue.</p>
</section>
<section id="bibliography" class="level3">
<h3 class="anchored" data-anchor-id="bibliography">Bibliography</h3>
<p>I received the data for this analysis by email directly from LPD Chief Scott Minckler in late March, 2023. The original format of the data was 10 PDF reports exported from the police department’s software application <a href="https://www.centralsquare.com/">IMC-Central Square</a>. Follow this link for copies of the original reports, as well as CSV exports from this analysis of the call reason, call action, and operator demographic data parsed from the source reports:</p>
<p><a href="https://github.com/timshores/601_Spring_2023/tree/template/posts/TimShores_FinalProject_Data" class="uri">https://github.com/timshores/601_Spring_2023/tree/template/posts/TimShores_FinalProject_Data</a></p>
</section>
</section>
<section id="appendix" class="level2">
<h2 class="anchored" data-anchor-id="appendix">Appendix</h2>
<section id="data-dictionary" class="level3">
<h3 class="anchored" data-anchor-id="data-dictionary">Data Dictionary</h3>
<p>These are the final data frame variables:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
callReasonsDF
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>call_reason</strong>: factor with 121 levels, describes the type of incident that resulted in a call to LPD or Shelburne Dispatch</li>
<li><strong>self</strong>: the number of calls per call_reason made directly to LPD (or WPD before 2021)</li>
<li><strong>disp</strong>: the number of calls per call_reason made to Shelburne Dispatch</li>
<li><strong>avg_hours_per_call</strong>: mean time in hours to work per call.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
callActionsDF
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>call_reason</strong>: Factor with 121 levels, same as in callReasonsDF</li>
<li><strong>actionname</strong>: Factor with 47 levels, one for each action outcome for a call</li>
<li><strong>actioncount</strong>: Count of actionnames for each call_reason</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
operatorSummaryDF
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>opcategory</strong>: Factor with 3 levels: Ethnicity, Race, or Sex</li>
<li><strong>opid</strong>: Factor with 11 levels corresponding to specific ethnicity, races, sexes</li>
<li><strong>opid</strong>: Count of vehicle operators for each opid</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key variables
</div>
</div>
<div class="callout-body-container callout-body">
<p>Each data frame includes the following variables that identify when and where the incident and response happened:</p>
<ul>
<li><strong>town</strong>: 2-level factor, Leverett or Wendell</li>
<li><strong>year</strong>: date, 2018 to 2022 (in all cases, month = 1 and day = 1)</li>
</ul>
<p>I can join reason and action data by using town, year, and call_reason as a compound key.</p>
</div>
</div>
</section>
<section id="sample-summaries-of-the-call-reasons-data-frame" class="level3">
<h3 class="anchored" data-anchor-id="sample-summaries-of-the-call-reasons-data-frame">Sample summaries of the call reasons data frame</h3>
<p>To get a sense of the scale of time spent on calls, these 3 tables show (1) a summary of time per call by the top 5 call reason mean times; (2) a summary of time per call by town; and (3) a summary of time per call by year.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define function to calculate mode</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>find_mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">unique</span>(x[<span class="sc">!</span><span class="fu">is.na</span>(x)]) <span class="co"># unique list as an index, without NA</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">tabulate</span>(<span class="fu">match</span>(x[<span class="sc">!</span><span class="fu">is.na</span>(x)], u))  <span class="co"># count how many times each index member occurs</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  u[tab <span class="sc">==</span> <span class="fu">max</span>(tab)] <span class="co">#  the max occurrence is the mode</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(u) <span class="co"># return mean in case the data is multimodal</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>callReasonsDF_ReasonSummary <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span> </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanHrs =</span> <span class="fu">mean</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">modeHrs =</span> <span class="fu">find_mode</span>(avg_hours_per_call), </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">minHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>], </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">lHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">2</span>], </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">medHrs =</span> <span class="fu">median</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">uHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">4</span>], </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">5</span>]</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(meanHrs))</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>crReasonRoundedDF <span class="ot">&lt;-</span> callReasonsDF_ReasonSummary <span class="sc">%&gt;%</span> </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(crReasonRoundedDF, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["call_reason"],"name":[1],"type":["fct"],"align":["left"]},{"label":["meanHrs"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["modeHrs"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["minHrs"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["lHingeHrs"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["medHrs"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["uHingeHrs"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["maxHrs"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"SUICIDE COMMITTED","2":"3.14","3":"3.14","4":"2.40","5":"2.40","6":"3.14","7":"3.89","8":"3.89"},{"1":"DOMESTIC","2":"2.40","3":"2.40","4":"1.36","5":"1.39","6":"2.31","7":"2.82","8":"4.14"},{"1":"STRUCTURE FIRE","2":"2.12","3":"2.12","4":"0.83","5":"1.16","6":"1.48","7":"2.77","8":"4.06"},{"1":"DEATH","2":"1.95","3":"1.95","4":"0.10","5":"1.20","6":"2.30","7":"2.88","8":"3.45"},{"1":"TRAFFIC HAZARD","2":"1.67","3":"1.86","4":"0.00","5":"0.25","6":"0.45","7":"0.55","8":"13.49"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>callReasonsDF_TownSummary <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(town) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanHrs =</span> <span class="fu">mean</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">modeHrs =</span> <span class="fu">find_mode</span>(avg_hours_per_call), </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">minHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>], </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">2</span>], </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">medHrs =</span> <span class="fu">median</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">uHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">4</span>], </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">5</span>]</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(meanHrs))</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>crTownRoundedDF <span class="ot">&lt;-</span> callReasonsDF_TownSummary <span class="sc">%&gt;%</span> </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>crTownRoundedDF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["town"],"name":[1],"type":["fct"],"align":["left"]},{"label":["meanHrs"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["modeHrs"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["minHrs"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["lHingeHrs"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["medHrs"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["uHingeHrs"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["maxHrs"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"Leverett","2":"0.50","3":"0.54","4":"0","5":"0.21","6":"0.4","7":"0.63","8":"4.14"},{"1":"Wendell","2":"0.49","3":"0.83","4":"0","5":"0.00","6":"0.2","7":"0.61","8":"13.49"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>callReasonsDF_YearSummary <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanHrs =</span> <span class="fu">mean</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">modeHrs =</span> <span class="fu">find_mode</span>(avg_hours_per_call), </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">minHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>], </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">lHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">2</span>], </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">medHrs =</span> <span class="fu">median</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">uHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">4</span>], </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">5</span>]</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(meanHrs))</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>crYearRoundedDF <span class="ot">&lt;-</span> callReasonsDF_YearSummary <span class="sc">%&gt;%</span> </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>crYearRoundedDF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["year"],"name":[1],"type":["date"],"align":["right"]},{"label":["meanHrs"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["modeHrs"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["minHrs"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["lHingeHrs"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["medHrs"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["uHingeHrs"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["maxHrs"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"2018-01-01","2":"0.59","3":"0.79","4":"0","5":"0.00","6":"0.31","7":"0.66","8":"13.49"},{"1":"2020-01-01","2":"0.59","3":"0.75","4":"0","5":"0.05","6":"0.43","7":"0.70","8":"4.85"},{"1":"2022-01-01","2":"0.48","3":"0.56","4":"0","5":"0.16","6":"0.38","7":"0.61","8":"2.82"},{"1":"2021-01-01","2":"0.47","3":"0.53","4":"0","5":"0.19","6":"0.39","7":"0.67","8":"2.69"},{"1":"2019-01-01","2":"0.37","3":"0.58","4":"0","5":"0.00","6":"0.22","7":"0.49","8":"4.14"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/601_Spring_2023" data-repo-id="R_kgDOI4JcJA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb26" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project: Tim Shores"</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Tim Shores"</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Local police department call data analysis for two small rural towns"</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "05/20/2023"</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 4</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="co">  - final_Project</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkGearUp}</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>my_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"broom"</span>, <span class="st">"fs"</span>, <span class="st">"pdftools"</span>, <span class="st">"knitr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"viridis"</span>, <span class="st">"hrbrthemes"</span>, <span class="st">"gridExtra"</span>, <span class="st">"tidytext"</span>) <span class="co"># create vector of packages</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(my_packages, require, <span class="at">character.only =</span> <span class="cn">TRUE</span>)) <span class="co"># load multiple packages</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">message=</span><span class="cn">FALSE</span>)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>This is the story of two small, rural Massachusetts towns that have made an agreement to combine their local police departments. The goal of the regionalization agreement initiated in 2020 has been to reduce cost by sharing a service. However, regionalization has made it more challenging for the towns to assess public safety expenses. </span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>For example, if demand for first responders has increased, is it because a single police department is now responding to crime from both towns? Or is it for reasons unrelated to regionalization, such as increased police response to medical calls or other calls for which police response is not required?</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>I intend to use the data collected to better inform budgeting and public safety discussion by public officials in the two towns. Furthermore, the work of regionalized municipal services is a common challenge that small rural towns, strapped for revenue, must consider. Improving how we collect and derive insights from municipal service regionalization data will be a vital service to towns who often don't have the capacity to organize their own data-driven policy and administration.</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a><span class="fu">## Research question</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>**What is the nature of public safety need behind the increase in calls that police respond to?**</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="fu">### Background</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>Since 2020, I have volunteered my time as a community organizer and political office-holder in the small rural town of Leverett, Massachusetts. One of the key challenges of public administration in Leverett is the lack of resources for gathering good evidence for public decision-making.</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>At the recent budget meetings in Spring 2023, the Leverett Police Chief made a budget request for a fourth full-time officer position. This position would help the Police Department overcome these problems:</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Decreased supply of police officer human resources due to state criminal justice reform.</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Increased demand for police officer human resources due to increased call volume in the towns of Leverett and Wendell.</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false}</span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a><span class="fu">## Problem #1 in detail</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>**How has state reform decreased supply of police officers?**</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>Since 2021, state POST reform has made it <span class="co">[</span><span class="ot">difficult for local police departments</span><span class="co">](https://www.berkshireeagle.com/news/central_berkshires/lenox-police-chief-talks-impact-of-new-rules-for-part-time-officers/article_3949b04c-35b2-11ec-8169-a72d6e4669a8.html)</span> to fill their on-duty schedules with reserve officers. Before 2021, reserve officers required half as much training as full-time officers. Reserve officers could work part-time or as a second job in seasonal positions and shifts as-needed. The State of Massachusetts Peace Officer Standards and Training (POST) Commission enacted a reform that required reserves to train as much as full-time officers. This has removed an incentive for people to become or remain reserve officers. The pool of reserve officers is shrinking. Local police departments, struggling to meet their scheduling needs, resort to requests for more full-time positions.</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false}</span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a><span class="fu">## Problem #2 in detail</span></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>**How much and why has call volume increased in Leverett and Wendell?**</span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>Since 2020, when the Wendell chief of police retired, the neighboring towns of Leverett and Wendell have agreed to combine their municipal police service. Wendell closed its own police department (WPD) and began to allocate budget revenue to the Leverett Police Department (LPD). LPD took responsibility for responding to police and emergency calls from both Leverett and Wendell. This regionalization of municipal service is expected to reduce public safety costs over time. However, the Leverett Finance Committee observed at a 2023 budget hearing that Leverett has been paying more than its share of police expenses. Meanwhile, citing an increase in call volume, LPD is still working out how to adapt to two towns' worth of demand for police service.  </span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>To solve these problems, Leverett Chief of Police Scott Minckler proposed that Leverett hire a fourth full-time officer. </span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>The request was approved by the Leverett and Wendell Police Services Oversight committee, the Leverett Personnel Board, and the Leverett Finance Committee. When the matter came before the Leverett Selectboard budget meeting, some members of town government and the public wanted to know more detail about the increase in call volume. </span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false}</span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a><span class="fu">## Questions voiced by the public</span></span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a>a. What types of calls are increasing? </span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a>b. What is the change in personnel time needed per call and per type of call?</span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a>c. What days and times of day do we see the most calls or the most change in calls?</span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a>d. Why do we need another officer when the populations and number of properties in the two towns have not grown substantially?</span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a>Chief Minckler's response to these questions was informed by his administrative experience, but not by thorough call data analysis. Due to difficulties generating reports from the administrative software used by many emergency response departments, the Chief was not able to speak to call data beyond call volume and call type. At public meetings, I heard Leverett residents express curiosity about the nature of increased call volume: How much was due to violent crime, domestic violence, interpersonal conflict, fraud, property rights violations, traffic violations, medical emergencies, mental health emergencies, fires? </span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a>Although people had multiple concerns and interests in the matter, most meeting participants had this basic question in common: </span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a><span class="fu">## Research question</span></span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a>**What is the nature of public safety need behind the increase in calls that police respond to?**</span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a>In other words, if we hired another police officer, would that meet the public safety needs that drive increased call volume? If our increased needs are by nature medical, mental health, fire, or community health and well-being, **then we risk misallocating public resources in a solution to the wrong problem**.</span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dataset Introduction</span></span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a>To collect data that could help understand more about the public safety need of Leverett and Wendell, I submitted this <span class="co">[</span><span class="ot">public records request</span><span class="co">](https://www.mass.gov/info-details/massachusetts-law-about-freedom-of-information-and-public-records)</span>:</span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a><span class="fu">## Email to PD: Thu, Mar 30, 2023 at 3:00 PM</span></span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a>Subject: Public Records Request for Leverett PD call data</span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a>To: Scott D. Minckler <span class="ot">&lt;policechief@leverett.ma.us&gt;</span></span>
<span id="cb26-121"><a href="#cb26-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-122"><a href="#cb26-122" aria-hidden="true" tabindex="-1"></a>Hi Chief Minckler,</span>
<span id="cb26-123"><a href="#cb26-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-124"><a href="#cb26-124" aria-hidden="true" tabindex="-1"></a>I also left a voicemail, but thought it would help to send my request by email. I've been learning about the budget requests from last week's meeting to get a sense of the request and the call volume and any other factors behind the request. It would help if I could learn more about our call data. </span>
<span id="cb26-125"><a href="#cb26-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-126"><a href="#cb26-126" aria-hidden="true" tabindex="-1"></a>I'm writing to request public data to do with Leverett and Wendell calls made to dispatch, and calls handled by our police department, for the 5-year period 2018 to 2022 (inclusive of the years 2018, 2019, 2020, 2021, and 2022). I'm requesting complete police department call detail records, with columns of data redacted if they are subject to specific statutory exemption to the MA Public Records Law due to criteria such as victim confidentiality. </span>
<span id="cb26-127"><a href="#cb26-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-128"><a href="#cb26-128" aria-hidden="true" tabindex="-1"></a>Please export data from your call management software application to CSV or XLSX files, rather than PDF or Word documents. The tabular CSV or XLSX format will facilitate data analysis.  </span>
<span id="cb26-129"><a href="#cb26-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-130"><a href="#cb26-130" aria-hidden="true" tabindex="-1"></a>If the export files are too large for email attachment, please upload to this Drive location: </span>
<span id="cb26-131"><a href="#cb26-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-132"><a href="#cb26-132" aria-hidden="true" tabindex="-1"></a>*url omitted*</span>
<span id="cb26-133"><a href="#cb26-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-134"><a href="#cb26-134" aria-hidden="true" tabindex="-1"></a>Thanks! Let me know if you have any questions or feedback.</span>
<span id="cb26-135"><a href="#cb26-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-136"><a href="#cb26-136" aria-hidden="true" tabindex="-1"></a>Tim Shores</span>
<span id="cb26-137"><a href="#cb26-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-138"><a href="#cb26-138" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-139"><a href="#cb26-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-140"><a href="#cb26-140" aria-hidden="true" tabindex="-1"></a>Chief Minckler called me the following Monday morning to discuss the request. He could supply reports, but not at the level of detail that I requested. I also learned from Chief Minckler that one reason for the growth of calls in Wendell was that the former police chief of Wendell did not record every call. This was not made known at the time when the two towns negotiated their regionalization agreement. </span>
<span id="cb26-141"><a href="#cb26-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-142"><a href="#cb26-142" aria-hidden="true" tabindex="-1"></a>I spoke with Supervisor Butch Garrity of Shelburne Dispatch, which serves as the 911 dispatcher for most towns in Franklin County, including Leverett and Wendell. The dispatch center and local agencies have used a client-server application called <span class="co">[</span><span class="ot">IMC-Central Square</span><span class="co">](https://www.centralsquare.com/)</span> since 1997 to manage dispatch calls and responses. The application has a reputation for being difficult to use and limited in functionality.</span>
<span id="cb26-143"><a href="#cb26-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-144"><a href="#cb26-144" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-145"><a href="#cb26-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-146"><a href="#cb26-146" aria-hidden="true" tabindex="-1"></a><span class="fu">### IMC-Central Square report limitations</span></span>
<span id="cb26-147"><a href="#cb26-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-148"><a href="#cb26-148" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The report export format was limited to PDF.</span>
<span id="cb26-149"><a href="#cb26-149" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>They could only provide call summary data. It was not practical to provide call detail data that would include relevant information (such as call day and time of day, location, demographics of people involved, and details of actions taken by responding officers) because Central Square has no redaction functions. </span>
<span id="cb26-150"><a href="#cb26-150" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-151"><a href="#cb26-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-152"><a href="#cb26-152" aria-hidden="true" tabindex="-1"></a>These software limitations have come up before in Leverett. In 2020, while researching a report on policing and the experience of people of color in town, the Leverett Social Justice Committee (SJC) submitted multiple requests for police call data that included race and ethnicity of people involved. LPD claimed that they were not able to comply because they were unable to generate the reports. The SJC met with someone at Amherst PD, which uses the same software, who offered to meet with LPD about how to generate IMC-Central Square reports. I am not aware of any follow-through on that offer for inter-departmental collaboration on the SJC public records request.</span>
<span id="cb26-153"><a href="#cb26-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-154"><a href="#cb26-154" aria-hidden="true" tabindex="-1"></a>Based on my career experience with numerous database systems, I'm confident that technical means exist to overcome these functional limits. However, I take the claims of the LPD and Shelburne Dispatch to be made in good faith. At the end of the day, it comes down to a lack of resources, and as a researcher I must set my expectations accordingly.</span>
<span id="cb26-155"><a href="#cb26-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-156"><a href="#cb26-156" aria-hidden="true" tabindex="-1"></a>Chief Minckler sent me 10 PDF files: one for each town and year, from 2018 to 2022. Each file includes 3 tables:</span>
<span id="cb26-157"><a href="#cb26-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-158"><a href="#cb26-158" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb26-159"><a href="#cb26-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-160"><a href="#cb26-160" aria-hidden="true" tabindex="-1"></a><span class="fu">## Source report structure</span></span>
<span id="cb26-161"><a href="#cb26-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-162"><a href="#cb26-162" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Call Reason Breakdown** shows the number of calls for each call reason, average time per call per call reason, and the type and number of actions taken in response to each call reason.</span>
<span id="cb26-163"><a href="#cb26-163" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Call Action Breakdown** shows summaries of call actions.</span>
<span id="cb26-164"><a href="#cb26-164" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Operator Race and Sex Breakdown** shows summary demographics of vehicle operators involved in traffic stops and violations.</span>
<span id="cb26-165"><a href="#cb26-165" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-166"><a href="#cb26-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-167"><a href="#cb26-167" aria-hidden="true" tabindex="-1"></a>**Call Reason Breakdown** is the the only object of this analysis. CSV exports of all three data frames are available in the bibliography.</span>
<span id="cb26-168"><a href="#cb26-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-169"><a href="#cb26-169" aria-hidden="true" tabindex="-1"></a>I used the R libraries <span class="in">`purrr`</span> and <span class="in">`pdf_tools`</span> to read-in the data to a list of 10 lists of data frames: one data frame for each page, one list for each file, in a collection of 10 files.</span>
<span id="cb26-170"><a href="#cb26-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-171"><a href="#cb26-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-172"><a href="#cb26-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkConsumeFiles}</span></span>
<span id="cb26-173"><a href="#cb26-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-174"><a href="#cb26-174" aria-hidden="true" tabindex="-1"></a>    <span class="co"># creates fs_path vector of each file in that directory</span></span>
<span id="cb26-175"><a href="#cb26-175" aria-hidden="true" tabindex="-1"></a>projectFiles <span class="ot">&lt;-</span> <span class="fu">dir_ls</span>(<span class="st">'../posts/TimShores_FinalProject_Data'</span>) </span>
<span id="cb26-176"><a href="#cb26-176" aria-hidden="true" tabindex="-1"></a>    <span class="co"># I have csv files in that folder for public sharing ... remove them from vector.</span></span>
<span id="cb26-177"><a href="#cb26-177" aria-hidden="true" tabindex="-1"></a>projectFiles <span class="ot">&lt;-</span> projectFiles[<span class="fu">grepl</span>(<span class="st">'</span><span class="sc">\\</span><span class="st">.pdf$'</span>, projectFiles)]</span>
<span id="cb26-178"><a href="#cb26-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-179"><a href="#cb26-179" aria-hidden="true" tabindex="-1"></a>projectFiles_list <span class="ot">&lt;-</span> projectFiles <span class="sc">%&gt;%</span></span>
<span id="cb26-180"><a href="#cb26-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(pdf_data) <span class="co"># purrr function that applies pdf_data reading function to each file element of fs_path vector</span></span>
<span id="cb26-181"><a href="#cb26-181" aria-hidden="true" tabindex="-1"></a>  <span class="co"># map creates a list of lists of tibbles (a tibble for each page of each pdf)</span></span>
<span id="cb26-182"><a href="#cb26-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-183"><a href="#cb26-183" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now that I've consumed my files I can str_replace to get town and year info from each filename.</span></span>
<span id="cb26-184"><a href="#cb26-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-185"><a href="#cb26-185" aria-hidden="true" tabindex="-1"></a>projectFiles <span class="ot">&lt;-</span> projectFiles <span class="sc">%&gt;%</span> </span>
<span id="cb26-186"><a href="#cb26-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">'../posts/TimShores_FinalProject_Data/'</span>, <span class="st">''</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-187"><a href="#cb26-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">'.pdf'</span>, <span class="st">''</span>) </span>
<span id="cb26-188"><a href="#cb26-188" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(projectFiles_list) <span class="ot">&lt;-</span> projectFiles</span>
<span id="cb26-189"><a href="#cb26-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-190"><a href="#cb26-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-191"><a href="#cb26-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-192"><a href="#cb26-192" aria-hidden="true" tabindex="-1"></a>I took the following general steps to parse this list:</span>
<span id="cb26-193"><a href="#cb26-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-194"><a href="#cb26-194" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb26-195"><a href="#cb26-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-196"><a href="#cb26-196" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data transformation steps</span></span>
<span id="cb26-197"><a href="#cb26-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-198"><a href="#cb26-198" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Mutated each row with information about the town, year, and source page number.</span>
<span id="cb26-199"><a href="#cb26-199" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Flattened the nested list of data frames into a single data frame.</span>
<span id="cb26-200"><a href="#cb26-200" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Used <span class="in">`pivot_wider`</span> to create columns based on PDF page x coordinates coordinates recorded for each observation by <span class="in">`pdf_data`</span>. The x coordinates help identify column boundaries in the original report: each column had a minimum and maximum value for x.</span>
<span id="cb26-201"><a href="#cb26-201" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Plyered apart the tables according to their distinct meanings into separate data frames: call reasons, call actions, and operator demographics.</span>
<span id="cb26-202"><a href="#cb26-202" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Filtered out or filled in all NA values. Every observation in the original reports had values for every variable. Plyering into separate data frames leaes blanks or NAs where the original report format staggers. Therefore, I interpret NA to indicate that I must remove the row or fill in the variable with a sub-heading value. The end result is three data frames with no NAs.</span>
<span id="cb26-203"><a href="#cb26-203" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-204"><a href="#cb26-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-205"><a href="#cb26-205" aria-hidden="true" tabindex="-1"></a>See my comments in the code block below for details.</span>
<span id="cb26-206"><a href="#cb26-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-207"><a href="#cb26-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-208"><a href="#cb26-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkParseFiles}</span></span>
<span id="cb26-209"><a href="#cb26-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-210"><a href="#cb26-210" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This next part took a couple days of searching for a tidy solution. </span></span>
<span id="cb26-211"><a href="#cb26-211" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Then I just decided to use a good old-fashioned nested for loop.</span></span>
<span id="cb26-212"><a href="#cb26-212" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The structure of the original documents is that each of 10 files has a variable number of pages.</span></span>
<span id="cb26-213"><a href="#cb26-213" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Therefore, the projectFiles_list structure is a nested list of dataframes: list[[list]][[dataframe]]. </span></span>
<span id="cb26-214"><a href="#cb26-214" aria-hidden="true" tabindex="-1"></a>  <span class="co"># I want to mutate each df with the page number from its PDF, or "innerpageid". </span></span>
<span id="cb26-215"><a href="#cb26-215" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Inner pagination corresponds to each dataframe's nested list element index (j in list[[i]][[j]]) which </span></span>
<span id="cb26-216"><a href="#cb26-216" aria-hidden="true" tabindex="-1"></a>  <span class="co"># is information that gets destroyed as soon as I map to an unnested list. I couldn't find a tidy solution to capturing that nested</span></span>
<span id="cb26-217"><a href="#cb26-217" aria-hidden="true" tabindex="-1"></a>  <span class="co"># "inner" page id before the map, so I used a nested for loop to assign value to innerpageid before appending my mapped/mutated df to</span></span>
<span id="cb26-218"><a href="#cb26-218" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a new single-layer list.</span></span>
<span id="cb26-219"><a href="#cb26-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-220"><a href="#cb26-220" aria-hidden="true" tabindex="-1"></a>allYearsList <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb26-221"><a href="#cb26-221" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(projectFiles_list)) { <span class="co"># seq_along(projectFiles_list) creates vector with a number value for each list element</span></span>
<span id="cb26-222"><a href="#cb26-222" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(projectFiles_list[[i]])) {</span>
<span id="cb26-223"><a href="#cb26-223" aria-hidden="true" tabindex="-1"></a>    projectFiles_list[[i]][[j]] <span class="ot">&lt;-</span> <span class="fu">mutate</span>(projectFiles_list[[i]][[j]], <span class="at">innerpageid =</span> j)</span>
<span id="cb26-224"><a href="#cb26-224" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-225"><a href="#cb26-225" aria-hidden="true" tabindex="-1"></a>  allYearsList <span class="ot">&lt;-</span> <span class="fu">append</span>(allYearsList, <span class="fu">map2</span>(projectFiles_list[[i]], </span>
<span id="cb26-226"><a href="#cb26-226" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">names</span>(projectFiles_list[i]), </span>
<span id="cb26-227"><a href="#cb26-227" aria-hidden="true" tabindex="-1"></a>                                            <span class="sc">~</span>.x <span class="sc">%&gt;%</span> </span>
<span id="cb26-228"><a href="#cb26-228" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">mutate</span>(<span class="at">filename =</span> .y)</span>
<span id="cb26-229"><a href="#cb26-229" aria-hidden="true" tabindex="-1"></a>                                            )</span>
<span id="cb26-230"><a href="#cb26-230" aria-hidden="true" tabindex="-1"></a>                         )</span>
<span id="cb26-231"><a href="#cb26-231" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-232"><a href="#cb26-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-233"><a href="#cb26-233" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this bind_rows takes all of the df observations from all of the list elements and binds them together in a single df.</span></span>
<span id="cb26-234"><a href="#cb26-234" aria-hidden="true" tabindex="-1"></a>  <span class="co"># outerpageid is the 'page' number in an absolute sequence (1 to 78 in this case) rather than segmented by file (1 to 9, 1 to 7 etc.)</span></span>
<span id="cb26-235"><a href="#cb26-235" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Note that outerpageid is not particularly important (it's semantically identical to town, year, innerpageid) </span></span>
<span id="cb26-236"><a href="#cb26-236" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and I should remove this scaffold.</span></span>
<span id="cb26-237"><a href="#cb26-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-238"><a href="#cb26-238" aria-hidden="true" tabindex="-1"></a>allYearsDF <span class="ot">&lt;-</span> allYearsList <span class="sc">%&gt;%</span></span>
<span id="cb26-239"><a href="#cb26-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">'outerpageid'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb26-240"><a href="#cb26-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">c</span>(filename, innerpageid), <span class="at">.after =</span> outerpageid) <span class="sc">%&gt;%</span></span>
<span id="cb26-241"><a href="#cb26-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(height <span class="sc">==</span> <span class="dv">11</span> <span class="sc">&amp;</span> y <span class="sc">&gt;</span> <span class="dv">13</span> <span class="sc">&amp;</span> text <span class="sc">!=</span> <span class="st">"Action:"</span>)</span>
<span id="cb26-242"><a href="#cb26-242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-243"><a href="#cb26-243" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this creates a problem of staggered lines</span></span>
<span id="cb26-244"><a href="#cb26-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-245"><a href="#cb26-245" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF <span class="sc">%&gt;%</span> </span>
<span id="cb26-246"><a href="#cb26-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> <span class="fu">c</span>(outerpageid, filename, innerpageid, y), <span class="at">names_from =</span> x, <span class="at">values_from =</span> text)</span>
<span id="cb26-247"><a href="#cb26-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-248"><a href="#cb26-248" aria-hidden="true" tabindex="-1"></a><span class="co"># solution from https://stackoverflow.com/questions/45515218/combine-rows-in-data-frame-containing-na-to-make-complete-row</span></span>
<span id="cb26-249"><a href="#cb26-249" aria-hidden="true" tabindex="-1"></a><span class="co"># Supply lists by splicing them into dots:</span></span>
<span id="cb26-250"><a href="#cb26-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-251"><a href="#cb26-251" aria-hidden="true" tabindex="-1"></a>coalesce_by_column <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb26-252"><a href="#cb26-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(dplyr<span class="sc">::</span><span class="fu">coalesce</span>(<span class="sc">!!!</span> <span class="fu">as.list</span>(df)))</span>
<span id="cb26-253"><a href="#cb26-253" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-254"><a href="#cb26-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-255"><a href="#cb26-255" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span></span>
<span id="cb26-256"><a href="#cb26-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">outerpageid =</span> <span class="fu">as.integer</span>(outerpageid))</span>
<span id="cb26-257"><a href="#cb26-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-258"><a href="#cb26-258" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span></span>
<span id="cb26-259"><a href="#cb26-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(outerpageid, filename, innerpageid, y) <span class="sc">%&gt;%</span> <span class="co"># outerpageid is redundant here</span></span>
<span id="cb26-260"><a href="#cb26-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(coalesce_by_column) <span class="sc">%&gt;%</span></span>
<span id="cb26-261"><a href="#cb26-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb26-262"><a href="#cb26-262" aria-hidden="true" tabindex="-1"></a><span class="co"># do I need to ungroup() ? doesn't seem to hurt!</span></span>
<span id="cb26-263"><a href="#cb26-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-264"><a href="#cb26-264" aria-hidden="true" tabindex="-1"></a>  <span class="co"># it will help to order columns by numeric order - they are the x coords from left to right. This looks for all non-alpha column names.</span></span>
<span id="cb26-265"><a href="#cb26-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-266"><a href="#cb26-266" aria-hidden="true" tabindex="-1"></a>numcols <span class="ot">=</span> <span class="fu">sort</span>(<span class="fu">as.numeric</span>(<span class="fu">names</span>(allYearsDF_wide)[<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"[a-z]"</span>, <span class="fu">names</span>(allYearsDF_wide))]))</span>
<span id="cb26-267"><a href="#cb26-267" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> <span class="fu">select</span>(allYearsDF_wide, outerpageid, filename, innerpageid, y, <span class="fu">match</span>(numcols, <span class="fu">names</span>(allYearsDF_wide))) </span>
<span id="cb26-268"><a href="#cb26-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-269"><a href="#cb26-269" aria-hidden="true" tabindex="-1"></a>  <span class="co"># now we have a df that is simply x:y coordinates of the page</span></span>
<span id="cb26-270"><a href="#cb26-270" aria-hidden="true" tabindex="-1"></a>  <span class="co"># time to smush cols together, yay smush!</span></span>
<span id="cb26-271"><a href="#cb26-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-272"><a href="#cb26-272" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span> </span>
<span id="cb26-273"><a href="#cb26-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x5to52"</span>, <span class="fu">c</span>(<span class="st">"5"</span><span class="sc">:</span><span class="st">"47"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-274"><a href="#cb26-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x53to197"</span>, <span class="fu">c</span>(<span class="st">"53"</span><span class="sc">:</span><span class="st">"197"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-275"><a href="#cb26-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x198to238"</span>, <span class="fu">c</span>(<span class="st">"198"</span><span class="sc">:</span><span class="st">"233"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-276"><a href="#cb26-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x239to280"</span>, <span class="fu">c</span>(<span class="st">"239"</span><span class="sc">:</span><span class="st">"270"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-277"><a href="#cb26-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x281to329"</span>, <span class="fu">c</span>(<span class="st">"281"</span><span class="sc">:</span><span class="st">"329"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-278"><a href="#cb26-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x330to371"</span>, <span class="fu">c</span>(<span class="st">"330"</span><span class="sc">:</span><span class="st">"371"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-279"><a href="#cb26-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x372to449"</span>, <span class="fu">c</span>(<span class="st">"372"</span><span class="sc">:</span><span class="st">"431"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-280"><a href="#cb26-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(<span class="st">"x450toEnd"</span>, <span class="fu">c</span>(<span class="st">"450"</span><span class="sc">:</span><span class="st">"545"</span>), <span class="at">sep =</span> <span class="st">" "</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">remove =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-281"><a href="#cb26-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-282"><a href="#cb26-282" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note that spacing does differ on each page (as indicated by the colnames), but the boundaries are stable</span></span>
<span id="cb26-283"><a href="#cb26-283" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (as indicated by the united colnames -- I manually confirmed the minimum pixel position of each column on each data frame)</span></span>
<span id="cb26-284"><a href="#cb26-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-285"><a href="#cb26-285" aria-hidden="true" tabindex="-1"></a>  <span class="co"># final tidying of Call_Reason text separated into different columns</span></span>
<span id="cb26-286"><a href="#cb26-286" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this sequence of conditionals looks through new columns named after PDF page x coordinates </span></span>
<span id="cb26-287"><a href="#cb26-287" aria-hidden="true" tabindex="-1"></a>  <span class="co"># then pastes values depending on their x coords, reconstructing variables </span></span>
<span id="cb26-288"><a href="#cb26-288" aria-hidden="true" tabindex="-1"></a>  <span class="co"># from PDF text box fragments</span></span>
<span id="cb26-289"><a href="#cb26-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-290"><a href="#cb26-290" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span></span>
<span id="cb26-291"><a href="#cb26-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x5to52 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x5to52, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb26-292"><a href="#cb26-292" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(x5to52,<span class="st">" "</span>,x53to197), </span>
<span id="cb26-293"><a href="#cb26-293" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">paste0</span>(x5to52)),</span>
<span id="cb26-294"><a href="#cb26-294" aria-hidden="true" tabindex="-1"></a>         <span class="at">x53to197 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x5to52, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb26-295"><a href="#cb26-295" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb26-296"><a href="#cb26-296" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(x53to197)), <span class="co"># delete from additional columns</span></span>
<span id="cb26-297"><a href="#cb26-297" aria-hidden="true" tabindex="-1"></a>         <span class="at">x53to197 =</span> <span class="fu">ifelse</span>(x53to197 <span class="sc">==</span> <span class="st">""</span>, </span>
<span id="cb26-298"><a href="#cb26-298" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb26-299"><a href="#cb26-299" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(x53to197, <span class="st">" "</span>, x198to238, <span class="st">" "</span>, x239to280, <span class="st">" "</span>, x281to329, <span class="st">" "</span>, x330to371, <span class="st">" "</span>, x372to449, <span class="st">" "</span>, x450toEnd)),</span>
<span id="cb26-300"><a href="#cb26-300" aria-hidden="true" tabindex="-1"></a>         <span class="at">x198to238 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb26-301"><a href="#cb26-301" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb26-302"><a href="#cb26-302" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x198to238)), <span class="co"># delete from add'l cols</span></span>
<span id="cb26-303"><a href="#cb26-303" aria-hidden="true" tabindex="-1"></a>         <span class="at">x239to280 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb26-304"><a href="#cb26-304" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>),</span>
<span id="cb26-305"><a href="#cb26-305" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x239to280)), <span class="co"># delete from add'l cols</span></span>
<span id="cb26-306"><a href="#cb26-306" aria-hidden="true" tabindex="-1"></a>         <span class="at">x281to329 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb26-307"><a href="#cb26-307" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb26-308"><a href="#cb26-308" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x281to329)), <span class="co"># delete from add'l cols</span></span>
<span id="cb26-309"><a href="#cb26-309" aria-hidden="true" tabindex="-1"></a>         <span class="at">x330to371 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb26-310"><a href="#cb26-310" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb26-311"><a href="#cb26-311" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x330to371)), <span class="co"># delete from add'l cols</span></span>
<span id="cb26-312"><a href="#cb26-312" aria-hidden="true" tabindex="-1"></a>         <span class="at">x372to449 =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb26-313"><a href="#cb26-313" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>), </span>
<span id="cb26-314"><a href="#cb26-314" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x372to449)), <span class="co"># delete from add'l cols</span></span>
<span id="cb26-315"><a href="#cb26-315" aria-hidden="true" tabindex="-1"></a>         <span class="at">x450toEnd =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(x53to197, <span class="at">type=</span><span class="st">"chars"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb26-316"><a href="#cb26-316" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(<span class="st">""</span>),</span>
<span id="cb26-317"><a href="#cb26-317" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">paste0</span>(x450toEnd)) <span class="co"># delete from add'l cols</span></span>
<span id="cb26-318"><a href="#cb26-318" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb26-319"><a href="#cb26-319" aria-hidden="true" tabindex="-1"></a>  <span class="co"># replace blanks with NAs in the 2nd and 3rd cols. </span></span>
<span id="cb26-320"><a href="#cb26-320" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>), <span class="sc">~</span><span class="fu">na_if</span>(., <span class="st">''</span>)) </span>
<span id="cb26-321"><a href="#cb26-321" aria-hidden="true" tabindex="-1"></a>  <span class="co"># I tried this using paste in the previous mutate, but the result was a text string "NA", not an NA.</span></span>
<span id="cb26-322"><a href="#cb26-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-323"><a href="#cb26-323" aria-hidden="true" tabindex="-1"></a>  <span class="co"># label each action with its call reason</span></span>
<span id="cb26-324"><a href="#cb26-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-325"><a href="#cb26-325" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span></span>
<span id="cb26-326"><a href="#cb26-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(x5to52, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">%&gt;%</span>                             <span class="co"># populate rows to support normalization</span></span>
<span id="cb26-327"><a href="#cb26-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x53to197 =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"Action"</span>, x53to197))  <span class="co"># create a column name</span></span>
<span id="cb26-328"><a href="#cb26-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-329"><a href="#cb26-329" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(allYearsDF_wide)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)] <span class="ot">&lt;-</span> allYearsDF_wide[<span class="dv">1</span>,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)]    <span class="co"># set values from the first row to column headings </span></span>
<span id="cb26-330"><a href="#cb26-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-331"><a href="#cb26-331" aria-hidden="true" tabindex="-1"></a>allYearsDF_wide <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span>                              <span class="co"># tidy column names</span></span>
<span id="cb26-332"><a href="#cb26-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span></span>
<span id="cb26-333"><a href="#cb26-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"._"</span>, <span class="st">"_"</span>, .x, <span class="at">fixed =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-334"><a href="#cb26-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">"@"</span>, <span class="st">"at"</span>, .x, <span class="at">fixed =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-335"><a href="#cb26-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">avg_hours_to_arrive =</span> avg_arrive,</span>
<span id="cb26-336"><a href="#cb26-336" aria-hidden="true" tabindex="-1"></a>         <span class="at">avg_hours_at_scene =</span> avg_time_at_scene) <span class="sc">%&gt;%</span></span>
<span id="cb26-337"><a href="#cb26-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(innerpageid <span class="sc">!=</span> <span class="dv">1</span> <span class="sc">|</span> y <span class="sc">!=</span> <span class="dv">69</span> <span class="sc">|</span> call_reason <span class="sc">!=</span> <span class="st">"Call_Reason"</span>) <span class="sc">%&gt;%</span>   <span class="co"># some y values reliably indicate</span></span>
<span id="cb26-338"><a href="#cb26-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(self <span class="sc">!=</span> <span class="st">"Self_Init"</span>) <span class="sc">%&gt;%</span>                                         <span class="co"># headers/footers on source PDF page format</span></span>
<span id="cb26-339"><a href="#cb26-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_regex</span>(filename, <span class="fu">c</span>(<span class="at">town =</span> <span class="st">"^[A-Za-z]+"</span>, <span class="at">year =</span> <span class="st">"[0-9]{4}$"</span>)) <span class="sc">%&gt;%</span>  <span class="co"># sep filename into town and year</span></span>
<span id="cb26-340"><a href="#cb26-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">town =</span> <span class="fu">factor</span>(town),</span>
<span id="cb26-341"><a href="#cb26-341" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="fu">make_date</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(year), <span class="at">month =</span> <span class="dv">1</span>, <span class="at">day =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-342"><a href="#cb26-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(total, <span class="st">"___%"</span>)) <span class="sc">%&gt;%</span>                                           <span class="co"># this is a total column - don't need it</span></span>
<span id="cb26-343"><a href="#cb26-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(call_reason<span class="sc">:</span>avg_hours_at_scene, <span class="sc">~</span><span class="fu">na_if</span>(., <span class="st">""</span>)))</span>
<span id="cb26-344"><a href="#cb26-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-345"><a href="#cb26-345" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First df achievement unlocked: Call Reasons</span></span>
<span id="cb26-346"><a href="#cb26-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-347"><a href="#cb26-347" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span> </span>
<span id="cb26-348"><a href="#cb26-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(action)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-349"><a href="#cb26-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(self)) <span class="sc">%&gt;%</span></span>
<span id="cb26-350"><a href="#cb26-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(town, year, call_reason, self, disp, avg_hours_to_arrive, avg_hours_at_scene) <span class="sc">%&gt;%</span></span>
<span id="cb26-351"><a href="#cb26-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">factor</span>(call_reason)) <span class="sc">%&gt;%</span></span>
<span id="cb26-352"><a href="#cb26-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"self"</span>, <span class="st">"disp"</span>), as.integer) <span class="sc">%&gt;%</span></span>
<span id="cb26-353"><a href="#cb26-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="st">"avg_hours_to_arrive"</span>, <span class="st">"avg_hours_at_scene"</span>), as.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb26-354"><a href="#cb26-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-355"><a href="#cb26-355" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_hours_to_arrive =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(avg_hours_to_arrive), <span class="dv">0</span>, avg_hours_to_arrive),</span>
<span id="cb26-356"><a href="#cb26-356" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_hours_per_call =</span> avg_hours_to_arrive <span class="sc">+</span> avg_hours_at_scene,</span>
<span id="cb26-357"><a href="#cb26-357" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_hours_per_call =</span> avg_hours_per_call <span class="sc">/</span> <span class="dv">60</span>,    <span class="co"># convert times to hours</span></span>
<span id="cb26-358"><a href="#cb26-358" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls =</span> self <span class="sc">+</span> disp,</span>
<span id="cb26-359"><a href="#cb26-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> totalCalls <span class="sc">*</span> avg_hours_per_call) <span class="sc">%&gt;%</span></span>
<span id="cb26-360"><a href="#cb26-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(avg_hours_to_arrive, avg_hours_at_scene)) <span class="sc">%&gt;%</span></span>
<span id="cb26-361"><a href="#cb26-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"total"</span>, call_reason, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="co"># Final step, get rid of of rows with call_reason = TOTAL</span></span>
<span id="cb26-362"><a href="#cb26-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-363"><a href="#cb26-363" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Second df achievement unlocked: Call Actions (each call reason has 1+ actions)</span></span>
<span id="cb26-364"><a href="#cb26-364" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (note: not used in the current version of the analysis, </span></span>
<span id="cb26-365"><a href="#cb26-365" aria-hidden="true" tabindex="-1"></a>  <span class="co"># but a link to the file is made available in the bibliography</span></span>
<span id="cb26-366"><a href="#cb26-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-367"><a href="#cb26-367" aria-hidden="true" tabindex="-1"></a>callActionsDF <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span> </span>
<span id="cb26-368"><a href="#cb26-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(action)) <span class="sc">%&gt;%</span></span>
<span id="cb26-369"><a href="#cb26-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"total"</span>, call_reason, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-370"><a href="#cb26-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(town, year, call_reason, action))  <span class="sc">%&gt;%</span></span>
<span id="cb26-371"><a href="#cb26-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_regex</span>(action, <span class="fu">c</span>(<span class="at">actionname =</span> <span class="st">".+"</span>, <span class="st">" = "</span>, <span class="at">actioncount =</span> <span class="st">".*"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-372"><a href="#cb26-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">factor</span>(call_reason),</span>
<span id="cb26-373"><a href="#cb26-373" aria-hidden="true" tabindex="-1"></a>         <span class="at">actionname =</span> <span class="fu">factor</span>(actionname),</span>
<span id="cb26-374"><a href="#cb26-374" aria-hidden="true" tabindex="-1"></a>         <span class="at">actioncount =</span> <span class="fu">str_squish</span>(actioncount),</span>
<span id="cb26-375"><a href="#cb26-375" aria-hidden="true" tabindex="-1"></a>         <span class="at">actioncount =</span> <span class="fu">as.integer</span>(actioncount))</span>
<span id="cb26-376"><a href="#cb26-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-377"><a href="#cb26-377" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Third and final df achievement unlocked: Operator demographics, not explicitly related to call reasons/actions,</span></span>
<span id="cb26-378"><a href="#cb26-378" aria-hidden="true" tabindex="-1"></a>  <span class="co"># But we can confidently assume that "operator" means "driver of vehicle"</span></span>
<span id="cb26-379"><a href="#cb26-379" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (note: not used in the current version of the analysis, </span></span>
<span id="cb26-380"><a href="#cb26-380" aria-hidden="true" tabindex="-1"></a>  <span class="co"># but a link to the file is made available in the bibliography</span></span>
<span id="cb26-381"><a href="#cb26-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-382"><a href="#cb26-382" aria-hidden="true" tabindex="-1"></a>operatorSummaryDF <span class="ot">&lt;-</span> allYearsDF_wide <span class="sc">%&gt;%</span> </span>
<span id="cb26-383"><a href="#cb26-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(action)) <span class="sc">%&gt;%</span></span>
<span id="cb26-384"><a href="#cb26-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"total"</span>, call_reason, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-385"><a href="#cb26-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">opcategory =</span> <span class="fu">str_extract</span>(action, <span class="st">"Sex|Race|Ethnicity"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-386"><a href="#cb26-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(opcategory) <span class="sc">%&gt;%</span></span>
<span id="cb26-387"><a href="#cb26-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"total"</span>, action, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-388"><a href="#cb26-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">opid =</span> action) <span class="sc">%&gt;%</span></span>
<span id="cb26-389"><a href="#cb26-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(town, year, opcategory, opid))  <span class="sc">%&gt;%</span></span>
<span id="cb26-390"><a href="#cb26-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_regex</span>(opid, <span class="fu">c</span>(<span class="at">opid =</span> <span class="st">"[A-Za-z/</span><span class="sc">\\</span><span class="st">-</span><span class="sc">\\</span><span class="st">s]+"</span>, <span class="at">opcount =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">s[0-9]{1,3}"</span>, <span class="st">".+"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-391"><a href="#cb26-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">opcategory =</span> <span class="fu">factor</span>(opcategory),</span>
<span id="cb26-392"><a href="#cb26-392" aria-hidden="true" tabindex="-1"></a>         <span class="at">opid =</span> <span class="fu">str_squish</span>(opid),</span>
<span id="cb26-393"><a href="#cb26-393" aria-hidden="true" tabindex="-1"></a>         <span class="at">opid =</span> <span class="fu">factor</span>(opid),</span>
<span id="cb26-394"><a href="#cb26-394" aria-hidden="true" tabindex="-1"></a>         <span class="at">opcount =</span> <span class="fu">str_squish</span>(opcount),</span>
<span id="cb26-395"><a href="#cb26-395" aria-hidden="true" tabindex="-1"></a>         <span class="at">opcount =</span> <span class="fu">as.integer</span>(opcount))</span>
<span id="cb26-396"><a href="#cb26-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-397"><a href="#cb26-397" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-398"><a href="#cb26-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-399"><a href="#cb26-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-400"><a href="#cb26-400" aria-hidden="true" tabindex="-1"></a>See the appendix for a data dictionary and sample summaries of each data frame.</span>
<span id="cb26-401"><a href="#cb26-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-402"><a href="#cb26-402" aria-hidden="true" tabindex="-1"></a>The LPD call data does not show when police response is required or optional. There are also 121 call reasons. To make analysis simpler and yield insights about public safety need, I created 10 "public safety themes" and mapped one to each call reason. This is my interpretation of call reasons to create a taxonomy that permits interpretations of calls according to when police response is required in comparison with the calls that a police officer responds to because another type of first responder is not available. I will remain open to feedback and referrals to standard taxonomies, if any exist. One of the dilemmas of analyzing police data is a lack of clear policing data standards.</span>
<span id="cb26-403"><a href="#cb26-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-404"><a href="#cb26-404" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb26-405"><a href="#cb26-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-406"><a href="#cb26-406" aria-hidden="true" tabindex="-1"></a><span class="fu">## Public safety themes</span></span>
<span id="cb26-407"><a href="#cb26-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-408"><a href="#cb26-408" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Administration</span>
<span id="cb26-409"><a href="#cb26-409" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fire</span>
<span id="cb26-410"><a href="#cb26-410" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Medical</span>
<span id="cb26-411"><a href="#cb26-411" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mental Health or Social Work</span>
<span id="cb26-412"><a href="#cb26-412" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Nonviolent Crime</span>
<span id="cb26-413"><a href="#cb26-413" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Other Safety</span>
<span id="cb26-414"><a href="#cb26-414" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Prevention</span>
<span id="cb26-415"><a href="#cb26-415" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Utility</span>
<span id="cb26-416"><a href="#cb26-416" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Vehicular</span>
<span id="cb26-417"><a href="#cb26-417" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Violent Crime</span>
<span id="cb26-418"><a href="#cb26-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-419"><a href="#cb26-419" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-420"><a href="#cb26-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-421"><a href="#cb26-421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkMapThemes}</span></span>
<span id="cb26-422"><a href="#cb26-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-423"><a href="#cb26-423" aria-hidden="true" tabindex="-1"></a><span class="co"># a vector of all the factors, because I need to create a simpler taxonomy</span></span>
<span id="cb26-424"><a href="#cb26-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-425"><a href="#cb26-425" aria-hidden="true" tabindex="-1"></a>callReasonNameFactors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"209A SERVICE"</span>, <span class="st">"209A VIOLATION"</span>, <span class="st">"911 CALL"</span>, <span class="st">"911 HANG UP"</span>, <span class="st">"911 MIS DIAL"</span>, <span class="st">"911 Text to 911"</span>, <span class="st">"ABANDONED 911 CALL"</span>, <span class="st">"ABANDONED MV"</span>, <span class="st">"ADMINISTRATIVE"</span>, <span class="st">"ALARM BURGLAR OR HOLDUP"</span>, <span class="st">"ANIMAL COMPLAINT"</span>, <span class="st">"ANNOYING PHONE CALLS"</span>, <span class="st">"ARTICLES LOST"</span>, <span class="st">"ARTICLES RECOVERED"</span>, <span class="st">"ASSAULT"</span>, <span class="st">"ASSIST CITIZEN"</span>, <span class="st">"ASSIST OTHER AGENCY"</span>, <span class="st">"BE ON THE LOOK OUT"</span>, <span class="st">"BREAKING &amp; ENTERING AUTO"</span>, <span class="st">"BREAKING &amp; ENTERING PAST"</span>, <span class="st">"BREAKING AND ENTERING"</span>, <span class="st">"BRUSH FIRE"</span>, <span class="st">"BUILDING/LOCATION CHECK"</span>, <span class="st">"BURN/AGRI PERMIT"</span>, <span class="st">"BYLAW VIOLATION"</span>, <span class="st">"Car vs. Deer"</span>, <span class="st">"CARBON MONOXIDE HAZARD"</span>, <span class="st">"CHECK WELFARE"</span>, <span class="st">"CHIMNEY FIRE"</span>, <span class="st">"Civil Issue"</span>, <span class="st">"COMMUNITY POLICING"</span>, <span class="st">"COMPLAINT"</span>, <span class="st">"COURT"</span>, <span class="st">"CRUISER MAINTENANCE"</span>, <span class="st">"CSO FOLLOW UP"</span>, <span class="st">"CSO OUTREACH"</span>, <span class="st">"CUSTODY ISSUE"</span>, <span class="st">"DEATH"</span>, <span class="st">"DETAIL REQUEST"</span>, <span class="st">"DISABLED MV"</span>, <span class="st">"DISTURBANCE"</span>, <span class="st">"DOMESTIC"</span>, <span class="st">"Drill/Testing"</span>, <span class="st">"DRUG OFFENSE"</span>, <span class="st">"DRUNK"</span>, <span class="st">"EMS ALARM - LIFELINE ACTIVATED"</span>, <span class="st">"ESCORT/TRANSPORT"</span>, <span class="st">"EXPLOSION"</span>, <span class="st">"FIGHT"</span>, <span class="st">"FIRE ALARM"</span>, <span class="st">"FIRE WORKS"</span>, <span class="st">"FIRE, OTHER NON-SPECIFIC"</span>, <span class="st">"FIREARMS LICENSING"</span>, <span class="st">"FOLLOW UP INVESTIGATION"</span>, <span class="st">"FRAUD/SCAM"</span>, <span class="st">"GAS LEAK"</span>, <span class="st">"GENERAL INFO"</span>, <span class="st">"HARASSMENT"</span>, <span class="st">"HIT AND RUN"</span>, <span class="st">"ILLEGAL BURN"</span>, <span class="st">"ILLEGAL DUMPING"</span>, <span class="st">"INVESTIGATION"</span>, <span class="st">"JUVENILE OFFENSES"</span>, <span class="st">"KEEP THE PEACE"</span>, <span class="st">"LARCENY"</span>, <span class="st">"LINE DOWN, POWER,PHONE OR CABL"</span>, <span class="st">"LOCKOUT"</span>, <span class="st">"MEDICAL EMERGENCY"</span>, <span class="st">"MISCELLANEOUS"</span>, <span class="st">"MISSING PERSON"</span>, <span class="st">"MOTOR VEHICLE - STOLEN"</span>, <span class="st">"MOTOR VEHICLE ACCIDE W/INJURY"</span>, <span class="st">"MOTOR VEHICLE ACCIDENT NO INJU"</span>, <span class="st">"MOTOR VEHICLE COMPLAINT"</span>, <span class="st">"MOTOR VEHICLE RECOVERED"</span>, <span class="st">"MOTOR VEHICLE VIOLATION"</span>, <span class="st">"NOISE COMPLAINT"</span>, <span class="st">"NOTIFICATION"</span>, <span class="st">"ODOR INVESTIGATION"</span>, <span class="st">"OFFICER WANTED"</span>, <span class="st">"OPEN DOOR"</span>, <span class="st">"Paid Detail"</span>, <span class="st">"PAPERWORK SERVICE"</span>, <span class="st">"PARKING COMPLAINT"</span>, <span class="st">"PATROL AREA"</span>, <span class="st">"POWER OUTAGE/FAILURE"</span>, <span class="st">"RADAR/TRAFFIC ENFORCEMENT"</span>, <span class="st">"RAPE"</span>, <span class="st">"REPOSSESSION"</span>, <span class="st">"RESCUE CALL"</span>, <span class="st">"ROLLING 9"</span>, <span class="st">"ROLLING Q2-1"</span>, <span class="st">"RUNAWAY"</span>, <span class="st">"SAFETY HAZARD"</span>, <span class="st">"SCHOOL RESOURCE OFFICER DUTIES"</span>, <span class="st">"SEARCH"</span>, <span class="st">"Section 12"</span>, <span class="st">"SERVE WARRANT"</span>, <span class="st">"SERVICE CALL"</span>, <span class="st">"SEX OFFENDER REGISTRATION"</span>, <span class="st">"SHOPLIFTING"</span>, <span class="st">"SHOTS FIRED"</span>, <span class="st">"SMOKE INVESTIGATION"</span>, <span class="st">"SOLICITING"</span>, <span class="st">"STRUCTURE FIRE"</span>, <span class="st">"SUICIDE COMMITTED"</span>, <span class="st">"SUICIDE THREAT"</span>, <span class="st">"SUMMONS SERVICE"</span>, <span class="st">"SUSPICIOUS ACTIVITY"</span>, <span class="st">"SUSPICIOUS PACKAGE"</span>, <span class="st">"SUSPICIOUS PERSON"</span>, <span class="st">"SUSPICIOUS VEHICLE"</span>, <span class="st">"SWATTING"</span>, <span class="st">"THREAT"</span>, <span class="st">"TRAFFIC CONTROL"</span>, <span class="st">"TRAFFIC HAZARD"</span>, <span class="st">"TRESPASS"</span>, <span class="st">"TRUANT"</span>, <span class="st">"UNWANTED PERSON"</span>, <span class="st">"VANDALISM"</span>, <span class="st">"VEHICLE FIRE"</span>)</span>
<span id="cb26-426"><a href="#cb26-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-427"><a href="#cb26-427" aria-hidden="true" tabindex="-1"></a><span class="co"># here is that simpler taxonomy!</span></span>
<span id="cb26-428"><a href="#cb26-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-429"><a href="#cb26-429" aria-hidden="true" tabindex="-1"></a>callReasonNameThemes <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Mental Health or Social Work"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Administration"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Administration"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Fire"</span>, <span class="st">"Prevention"</span>, <span class="st">"Fire"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Fire"</span>, <span class="st">"Prevention"</span>, <span class="st">"Fire"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Prevention"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Administration"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Administration"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Medical"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Fire"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Fire"</span>, <span class="st">"Fire"</span>, <span class="st">"Fire"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Utility"</span>, <span class="st">"Administration"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Fire"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Administration"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Prevention"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Utility"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Medical"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Medical"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Administration"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Prevention"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Prevention"</span>, <span class="st">"Utility"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Administration"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Administration"</span>, <span class="st">"Administration"</span>, <span class="st">"Prevention"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Fire"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Fire"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Administration"</span>, <span class="st">"Prevention"</span>, <span class="st">"Prevention"</span>, <span class="st">"Prevention"</span>, <span class="st">"Prevention"</span>, <span class="st">"Violent Crime"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Vehicular"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Mental Health or Social Work"</span>, <span class="st">"Other Safety"</span>, <span class="st">"Nonviolent Crime"</span>, <span class="st">"Fire"</span>)</span>
<span id="cb26-430"><a href="#cb26-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-431"><a href="#cb26-431" aria-hidden="true" tabindex="-1"></a>factorThemesDF <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">call_reason =</span> callReasonNameFactors, <span class="at">call_theme =</span> callReasonNameThemes) <span class="sc">%&gt;%</span></span>
<span id="cb26-432"><a href="#cb26-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">factor</span>(call_reason),</span>
<span id="cb26-433"><a href="#cb26-433" aria-hidden="true" tabindex="-1"></a>         <span class="at">call_theme =</span> <span class="fu">factor</span>(call_theme))</span>
<span id="cb26-434"><a href="#cb26-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-435"><a href="#cb26-435" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> <span class="fu">left_join</span>(callReasonsDF, factorThemesDF, <span class="at">by =</span><span class="st">'call_reason'</span>)</span>
<span id="cb26-436"><a href="#cb26-436" aria-hidden="true" tabindex="-1"></a>callActionsDF <span class="ot">&lt;-</span> <span class="fu">left_join</span>(callActionsDF, factorThemesDF, <span class="at">by =</span><span class="st">'call_reason'</span>)</span>
<span id="cb26-437"><a href="#cb26-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-438"><a href="#cb26-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-439"><a href="#cb26-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-440"><a href="#cb26-440" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis Plan</span></span>
<span id="cb26-441"><a href="#cb26-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-442"><a href="#cb26-442" aria-hidden="true" tabindex="-1"></a>My goal is to analyze and visualize call data in answer to this question: </span>
<span id="cb26-443"><a href="#cb26-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-444"><a href="#cb26-444" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-445"><a href="#cb26-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-446"><a href="#cb26-446" aria-hidden="true" tabindex="-1"></a><span class="fu">## Research question</span></span>
<span id="cb26-447"><a href="#cb26-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-448"><a href="#cb26-448" aria-hidden="true" tabindex="-1"></a>**What is the nature of public safety need behind the increase in calls that police respond to?**</span>
<span id="cb26-449"><a href="#cb26-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-450"><a href="#cb26-450" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-451"><a href="#cb26-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-452"><a href="#cb26-452" aria-hidden="true" tabindex="-1"></a>My analysis plan is to answer the following more specific questions for both towns together, and compared between towns: </span>
<span id="cb26-453"><a href="#cb26-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-454"><a href="#cb26-454" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-455"><a href="#cb26-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-456"><a href="#cb26-456" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specific questions for analysis</span></span>
<span id="cb26-457"><a href="#cb26-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-458"><a href="#cb26-458" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Has the time spent doing police work grown over time?</span>
<span id="cb26-459"><a href="#cb26-459" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Leverett and Wendell began a regionalization agreement in 2020. How has that impacted the data of time spent on calls?</span>
<span id="cb26-460"><a href="#cb26-460" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Which call reasons require the most personnel time?</span>
<span id="cb26-461"><a href="#cb26-461" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>What call reasons have grown the most over time, in terms of personnel time?</span>
<span id="cb26-462"><a href="#cb26-462" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>What call reasons have decreased the most in terms of personnel time?</span>
<span id="cb26-463"><a href="#cb26-463" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>What can we learn about the public safety impact of change in calls in terms of broad themes?</span>
<span id="cb26-464"><a href="#cb26-464" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-465"><a href="#cb26-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-466"><a href="#cb26-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-467"><a href="#cb26-467" aria-hidden="true" tabindex="-1"></a><span class="fu">## Results: Analysis and Visualization</span></span>
<span id="cb26-468"><a href="#cb26-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-469"><a href="#cb26-469" aria-hidden="true" tabindex="-1"></a>To prepare my data for presentation of growth trends compared between call reasons and themes over time, the first code chunk uses grouping and linear regression to calculate estimates of correlation coefficients, and joins and a tribble to package the results together in data frames that make for easier presentation.</span>
<span id="cb26-470"><a href="#cb26-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-471"><a href="#cb26-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkGetCorrelations, fig.width=10, fig.height=5}</span></span>
<span id="cb26-472"><a href="#cb26-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-473"><a href="#cb26-473" aria-hidden="true" tabindex="-1"></a><span class="co"># creating summary DFs, first step is to estimate change in hours per year</span></span>
<span id="cb26-474"><a href="#cb26-474" aria-hidden="true" tabindex="-1"></a><span class="co"># will do this for each factor: call_reason, town, call_theme</span></span>
<span id="cb26-475"><a href="#cb26-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-476"><a href="#cb26-476" aria-hidden="true" tabindex="-1"></a><span class="do">########## trying out this awesomeness to model estimated change in hours each year for each call reason factor</span></span>
<span id="cb26-477"><a href="#cb26-477" aria-hidden="true" tabindex="-1"></a><span class="co"># https://r4stats.com/2017/04/18/group-by-modeling-in-r-made-easy/</span></span>
<span id="cb26-478"><a href="#cb26-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-479"><a href="#cb26-479" aria-hidden="true" tabindex="-1"></a>tempGroupDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-480"><a href="#cb26-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb26-481"><a href="#cb26-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(<span class="fu">year</span>(year)))     <span class="co"># I convert to integer to pass to tidy() below</span></span>
<span id="cb26-482"><a href="#cb26-482" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># This way tidy() returns a model estimate with year unit as predictor</span></span>
<span id="cb26-483"><a href="#cb26-483" aria-hidden="true" tabindex="-1"></a>                                            <span class="co"># If I left it as a date, the model estimate unit would be 1 day rather than 1 year</span></span>
<span id="cb26-484"><a href="#cb26-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-485"><a href="#cb26-485" aria-hidden="true" tabindex="-1"></a><span class="co"># this next df assignment produces a correlation of determination estimate of hourly increase with year as a predictor:</span></span>
<span id="cb26-486"><a href="#cb26-486" aria-hidden="true" tabindex="-1"></a><span class="co"># For each factor call reason, the estimate is how many hours we expect the factor to change in 1 year.</span></span>
<span id="cb26-487"><a href="#cb26-487" aria-hidden="true" tabindex="-1"></a><span class="co"># note that this does not meet the test for statistical significance - p-values in this model are higher than is acceptable.</span></span>
<span id="cb26-488"><a href="#cb26-488" aria-hidden="true" tabindex="-1"></a><span class="co"># this is primarily meant to determine order of factors in terms of predicted change based on the small data set.</span></span>
<span id="cb26-489"><a href="#cb26-489" aria-hidden="true" tabindex="-1"></a>crHoursEstByYear <span class="ot">&lt;-</span> <span class="fu">do</span>(tempGroupDF, </span>
<span id="cb26-490"><a href="#cb26-490" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tidy</span>(</span>
<span id="cb26-491"><a href="#cb26-491" aria-hidden="true" tabindex="-1"></a>     <span class="fu">lm</span>(totalHours <span class="sc">~</span> year, <span class="at">data =</span> .))) <span class="sc">%&gt;%</span>      <span class="co"># tidy() creates a tibble from a linear model</span></span>
<span id="cb26-492"><a href="#cb26-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span>                    <span class="co"># removes intercept values, not needed for this simple analysis</span></span>
<span id="cb26-493"><a href="#cb26-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estYearlyHourChange_Reason =</span> <span class="fu">round</span>(estimate, <span class="dv">1</span>)) <span class="sc">%&gt;%</span>      <span class="co"># replacing NA with 0 - small n, assume no growth</span></span>
<span id="cb26-494"><a href="#cb26-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(estimate)) <span class="sc">%&gt;%</span></span>
<span id="cb26-495"><a href="#cb26-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(call_reason, estYearlyHourChange_Reason))</span>
<span id="cb26-496"><a href="#cb26-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-497"><a href="#cb26-497" aria-hidden="true" tabindex="-1"></a><span class="co"># from https://bookdown.org/pdr_higgins/rmrwr/linear-regression-and-broom-for-tidying-models.html</span></span>
<span id="cb26-498"><a href="#cb26-498" aria-hidden="true" tabindex="-1"></a><span class="co"># "the second column is the estimate. This is the point estimate of the effect of each predictor in the multivariable model. For the intraOp_surgerySize predictor, this is 0.316. This means that for each unit or level increase of intraOp_surgerySize, which is defined on a 1-3 scale from small to large, the pacu_30min_throat pain (on a 0-10 scale), increases by 0.316 points. So a large surgery (2 levels larger than small) will result in, on average, a pacu_30min_throat pain score 0.632 points higher than a small surgery."</span></span>
<span id="cb26-499"><a href="#cb26-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-500"><a href="#cb26-500" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-501"><a href="#cb26-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(crHoursEstByYear, <span class="at">by =</span> <span class="fu">join_by</span>(call_reason))</span>
<span id="cb26-502"><a href="#cb26-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-503"><a href="#cb26-503" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-504"><a href="#cb26-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(estYearlyHourChange_Reason))       <span class="co"># omit call reasons with NA values estimated growth, these have the lowest incidence </span></span>
<span id="cb26-505"><a href="#cb26-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-506"><a href="#cb26-506" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tempGroupDF)</span>
<span id="cb26-507"><a href="#cb26-507" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(crHoursEstByYear)</span>
<span id="cb26-508"><a href="#cb26-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-509"><a href="#cb26-509" aria-hidden="true" tabindex="-1"></a>tempGroupDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-510"><a href="#cb26-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb26-511"><a href="#cb26-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb26-512"><a href="#cb26-512" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls_Reason =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb26-513"><a href="#cb26-513" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours_Reason =</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-514"><a href="#cb26-514" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb26-515"><a href="#cb26-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-516"><a href="#cb26-516" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-517"><a href="#cb26-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tempGroupDF, <span class="at">by =</span> <span class="fu">join_by</span>(call_reason))</span>
<span id="cb26-518"><a href="#cb26-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-519"><a href="#cb26-519" aria-hidden="true" tabindex="-1"></a><span class="do">########## do that again for theme</span></span>
<span id="cb26-520"><a href="#cb26-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-521"><a href="#cb26-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-522"><a href="#cb26-522" aria-hidden="true" tabindex="-1"></a>tempGroupDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-523"><a href="#cb26-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_theme) <span class="sc">%&gt;%</span></span>
<span id="cb26-524"><a href="#cb26-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(<span class="fu">year</span>(year))) </span>
<span id="cb26-525"><a href="#cb26-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-526"><a href="#cb26-526" aria-hidden="true" tabindex="-1"></a>crHoursEstByYear <span class="ot">&lt;-</span> <span class="fu">do</span>(tempGroupDF, </span>
<span id="cb26-527"><a href="#cb26-527" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tidy</span>(</span>
<span id="cb26-528"><a href="#cb26-528" aria-hidden="true" tabindex="-1"></a>     <span class="fu">lm</span>(totalHours <span class="sc">~</span> year, <span class="at">data =</span> .))) <span class="sc">%&gt;%</span>      </span>
<span id="cb26-529"><a href="#cb26-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"year"</span>) <span class="sc">%&gt;%</span>                    </span>
<span id="cb26-530"><a href="#cb26-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estYear_HoursByTheme =</span> <span class="fu">round</span>(estimate, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-531"><a href="#cb26-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(estimate)) <span class="sc">%&gt;%</span></span>
<span id="cb26-532"><a href="#cb26-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(call_theme, estYear_HoursByTheme))</span>
<span id="cb26-533"><a href="#cb26-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-534"><a href="#cb26-534" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-535"><a href="#cb26-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(crHoursEstByYear, <span class="at">by =</span> <span class="fu">join_by</span>(call_theme))</span>
<span id="cb26-536"><a href="#cb26-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-537"><a href="#cb26-537" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-538"><a href="#cb26-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(estYear_HoursByTheme)) </span>
<span id="cb26-539"><a href="#cb26-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-540"><a href="#cb26-540" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(tempGroupDF)</span>
<span id="cb26-541"><a href="#cb26-541" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(crHoursEstByYear)</span>
<span id="cb26-542"><a href="#cb26-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-543"><a href="#cb26-543" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize df for theme: group by year</span></span>
<span id="cb26-544"><a href="#cb26-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-545"><a href="#cb26-545" aria-hidden="true" tabindex="-1"></a>tempGroupDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-546"><a href="#cb26-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_theme) <span class="sc">%&gt;%</span></span>
<span id="cb26-547"><a href="#cb26-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb26-548"><a href="#cb26-548" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls_Theme =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb26-549"><a href="#cb26-549" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours_Theme =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-550"><a href="#cb26-550" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb26-551"><a href="#cb26-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-552"><a href="#cb26-552" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-553"><a href="#cb26-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tempGroupDF, <span class="at">by =</span> <span class="fu">join_by</span>(call_theme))</span>
<span id="cb26-554"><a href="#cb26-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-555"><a href="#cb26-555" aria-hidden="true" tabindex="-1"></a><span class="do">##########</span></span>
<span id="cb26-556"><a href="#cb26-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-557"><a href="#cb26-557" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb26-558"><a href="#cb26-558" aria-hidden="true" tabindex="-1"></a><span class="do">### summary and linear model (lm) calculations for presentation</span></span>
<span id="cb26-559"><a href="#cb26-559" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb26-560"><a href="#cb26-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-561"><a href="#cb26-561" aria-hidden="true" tabindex="-1"></a>crYearDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-562"><a href="#cb26-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb26-563"><a href="#cb26-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb26-564"><a href="#cb26-564" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb26-565"><a href="#cb26-565" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-566"><a href="#cb26-566" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-567"><a href="#cb26-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-568"><a href="#cb26-568" aria-hidden="true" tabindex="-1"></a>crTownYearDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-569"><a href="#cb26-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(town, year) <span class="sc">%&gt;%</span></span>
<span id="cb26-570"><a href="#cb26-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb26-571"><a href="#cb26-571" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb26-572"><a href="#cb26-572" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-573"><a href="#cb26-573" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-574"><a href="#cb26-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-575"><a href="#cb26-575" aria-hidden="true" tabindex="-1"></a>crTownYearThemeDF <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-576"><a href="#cb26-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(town, year, call_theme) <span class="sc">%&gt;%</span></span>
<span id="cb26-577"><a href="#cb26-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb26-578"><a href="#cb26-578" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb26-579"><a href="#cb26-579" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-580"><a href="#cb26-580" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-581"><a href="#cb26-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-582"><a href="#cb26-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-583"><a href="#cb26-583" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate growth percentage of hours worked</span></span>
<span id="cb26-584"><a href="#cb26-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-585"><a href="#cb26-585" aria-hidden="true" tabindex="-1"></a>crYeargrowthPct <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">paste0</span>(<span class="fu">round</span>(</span>
<span id="cb26-586"><a href="#cb26-586" aria-hidden="true" tabindex="-1"></a>  (crYearDF[<span class="dv">5</span>,<span class="dv">3</span>] <span class="sc">-</span> crYearDF[<span class="dv">1</span>,<span class="dv">3</span>]) <span class="sc">/</span> crYearDF[<span class="dv">1</span>,<span class="dv">3</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)[[<span class="dv">1</span>]],</span>
<span id="cb26-587"><a href="#cb26-587" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%"</span>))</span>
<span id="cb26-588"><a href="#cb26-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-589"><a href="#cb26-589" aria-hidden="true" tabindex="-1"></a>crLevgrowthPct <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">paste0</span>(<span class="fu">round</span>(</span>
<span id="cb26-590"><a href="#cb26-590" aria-hidden="true" tabindex="-1"></a>  (crTownYearDF[<span class="dv">5</span>,<span class="dv">4</span>] <span class="sc">-</span> crTownYearDF[<span class="dv">1</span>,<span class="dv">4</span>]) <span class="sc">/</span> crTownYearDF[<span class="dv">1</span>,<span class="dv">4</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)[[<span class="dv">1</span>]],</span>
<span id="cb26-591"><a href="#cb26-591" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%"</span>))</span>
<span id="cb26-592"><a href="#cb26-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-593"><a href="#cb26-593" aria-hidden="true" tabindex="-1"></a>crWengrowthPct <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">paste0</span>(<span class="fu">round</span>(</span>
<span id="cb26-594"><a href="#cb26-594" aria-hidden="true" tabindex="-1"></a>  (crTownYearDF[<span class="dv">10</span>,<span class="dv">4</span>] <span class="sc">-</span> crTownYearDF[<span class="dv">6</span>,<span class="dv">4</span>]) <span class="sc">/</span> crTownYearDF[<span class="dv">6</span>,<span class="dv">4</span>] <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)[[<span class="dv">1</span>]],</span>
<span id="cb26-595"><a href="#cb26-595" aria-hidden="true" tabindex="-1"></a>  <span class="st">"%"</span>))</span>
<span id="cb26-596"><a href="#cb26-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-597"><a href="#cb26-597" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate linear model coefficient estimate of x (hour increase by year)</span></span>
<span id="cb26-598"><a href="#cb26-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-599"><a href="#cb26-599" aria-hidden="true" tabindex="-1"></a>crYeargrowthLM <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">lm</span>(totalHours <span class="sc">~</span> <span class="fu">year</span>(year), </span>
<span id="cb26-600"><a href="#cb26-600" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> crYearDF)<span class="sc">$</span>coefficients[<span class="dv">2</span>], <span class="dv">1</span>)</span>
<span id="cb26-601"><a href="#cb26-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-602"><a href="#cb26-602" aria-hidden="true" tabindex="-1"></a>crYeargrowthLMChar <span class="ot">&lt;-</span> <span class="fu">as.character</span>(crYeargrowthLM)</span>
<span id="cb26-603"><a href="#cb26-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-604"><a href="#cb26-604" aria-hidden="true" tabindex="-1"></a>crLevgrowthLM <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">lm</span>(totalHours <span class="sc">~</span> <span class="fu">year</span>(year), </span>
<span id="cb26-605"><a href="#cb26-605" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> <span class="fu">filter</span>(crTownYearDF, </span>
<span id="cb26-606"><a href="#cb26-606" aria-hidden="true" tabindex="-1"></a>                                        town <span class="sc">==</span> <span class="st">"Leverett"</span>)</span>
<span id="cb26-607"><a href="#cb26-607" aria-hidden="true" tabindex="-1"></a>                          )<span class="sc">$</span>coefficients[<span class="dv">2</span>], <span class="dv">1</span>)</span>
<span id="cb26-608"><a href="#cb26-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-609"><a href="#cb26-609" aria-hidden="true" tabindex="-1"></a>crWengrowthLM <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">lm</span>(totalHours <span class="sc">~</span> <span class="fu">year</span>(year), </span>
<span id="cb26-610"><a href="#cb26-610" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> <span class="fu">filter</span>(crTownYearDF, </span>
<span id="cb26-611"><a href="#cb26-611" aria-hidden="true" tabindex="-1"></a>                                        town <span class="sc">==</span> <span class="st">"Wendell"</span>)</span>
<span id="cb26-612"><a href="#cb26-612" aria-hidden="true" tabindex="-1"></a>                          )<span class="sc">$</span>coefficients[<span class="dv">2</span>], <span class="dv">1</span>)</span>
<span id="cb26-613"><a href="#cb26-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-614"><a href="#cb26-614" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate weekly hour increase per lm</span></span>
<span id="cb26-615"><a href="#cb26-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-616"><a href="#cb26-616" aria-hidden="true" tabindex="-1"></a>crYeargrowthLMweekChar <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">round</span>(crYeargrowthLM <span class="sc">/</span> <span class="dv">52</span>, <span class="dv">1</span>))</span>
<span id="cb26-617"><a href="#cb26-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-618"><a href="#cb26-618" aria-hidden="true" tabindex="-1"></a>crYeargrowthLMweek <span class="ot">&lt;-</span> <span class="fu">round</span>(crYeargrowthLM <span class="sc">/</span> <span class="dv">52</span>, <span class="dv">1</span>)</span>
<span id="cb26-619"><a href="#cb26-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-620"><a href="#cb26-620" aria-hidden="true" tabindex="-1"></a>crLevgrowthLMweek <span class="ot">&lt;-</span> <span class="fu">round</span>(crLevgrowthLM <span class="sc">/</span> <span class="dv">52</span>, <span class="dv">1</span>)</span>
<span id="cb26-621"><a href="#cb26-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-622"><a href="#cb26-622" aria-hidden="true" tabindex="-1"></a>crWengrowthLMweek <span class="ot">&lt;-</span> <span class="fu">round</span>(crWengrowthLM <span class="sc">/</span> <span class="dv">52</span>, <span class="dv">1</span>)</span>
<span id="cb26-623"><a href="#cb26-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-624"><a href="#cb26-624" aria-hidden="true" tabindex="-1"></a>  <span class="co"># assume standard 40-hour work week</span></span>
<span id="cb26-625"><a href="#cb26-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-626"><a href="#cb26-626" aria-hidden="true" tabindex="-1"></a>assumedFTE <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb26-627"><a href="#cb26-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-628"><a href="#cb26-628" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate hour increase per lm in terms of weekly FTE</span></span>
<span id="cb26-629"><a href="#cb26-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-630"><a href="#cb26-630" aria-hidden="true" tabindex="-1"></a>crYeargrowthFTE <span class="ot">&lt;-</span> <span class="fu">round</span>(crYeargrowthLM <span class="sc">/</span> <span class="dv">52</span> <span class="sc">/</span> assumedFTE, <span class="dv">2</span>)</span>
<span id="cb26-631"><a href="#cb26-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-632"><a href="#cb26-632" aria-hidden="true" tabindex="-1"></a>crYeargrowthFTEChar <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">round</span>(crYeargrowthLM <span class="sc">/</span> <span class="dv">52</span> <span class="sc">/</span> assumedFTE, <span class="dv">2</span>))</span>
<span id="cb26-633"><a href="#cb26-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-634"><a href="#cb26-634" aria-hidden="true" tabindex="-1"></a>crLevgrowthFTE <span class="ot">&lt;-</span> <span class="fu">round</span>(crLevgrowthLM <span class="sc">/</span> <span class="dv">52</span> <span class="sc">/</span> assumedFTE, <span class="dv">2</span>)</span>
<span id="cb26-635"><a href="#cb26-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-636"><a href="#cb26-636" aria-hidden="true" tabindex="-1"></a>crWengrowthFTE <span class="ot">&lt;-</span> <span class="fu">round</span>(crWengrowthLM <span class="sc">/</span> <span class="dv">52</span> <span class="sc">/</span> assumedFTE, <span class="dv">2</span>)</span>
<span id="cb26-637"><a href="#cb26-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-638"><a href="#cb26-638" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb26-639"><a href="#cb26-639" aria-hidden="true" tabindex="-1"></a><span class="do">### end of summary and lm calculations </span></span>
<span id="cb26-640"><a href="#cb26-640" aria-hidden="true" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb26-641"><a href="#cb26-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-642"><a href="#cb26-642" aria-hidden="true" tabindex="-1"></a><span class="do">### now assign to df for presentation:</span></span>
<span id="cb26-643"><a href="#cb26-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-644"><a href="#cb26-644" aria-hidden="true" tabindex="-1"></a>crtyGrowthDF <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb26-645"><a href="#cb26-645" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>town, <span class="sc">~</span>total_growth,  <span class="sc">~</span>yr_hr_growth, <span class="sc">~</span>wk_hr_growth, <span class="sc">~</span>fte_growth,</span>
<span id="cb26-646"><a href="#cb26-646" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Leverett"</span>, crLevgrowthPct, crLevgrowthLM, crLevgrowthLMweek, crLevgrowthFTE,</span>
<span id="cb26-647"><a href="#cb26-647" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Wendell"</span>, crWengrowthPct, crWengrowthLM, crWengrowthLMweek, crWengrowthFTE,</span>
<span id="cb26-648"><a href="#cb26-648" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Both Towns"</span>, crYeargrowthPct, crYeargrowthLM, crYeargrowthLMweek, crYeargrowthFTE</span>
<span id="cb26-649"><a href="#cb26-649" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-650"><a href="#cb26-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-651"><a href="#cb26-651" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-652"><a href="#cb26-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-653"><a href="#cb26-653" aria-hidden="true" tabindex="-1"></a><span class="fu">### Total hours working on calls</span></span>
<span id="cb26-654"><a href="#cb26-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-655"><a href="#cb26-655" aria-hidden="true" tabindex="-1"></a>The first question for a municipal department is about what impacts the budget. For this, three key metrics are call volume, average hours worked per call reason, and total hours worked. I took these steps to create the first plot:</span>
<span id="cb26-656"><a href="#cb26-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-657"><a href="#cb26-657" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Grouped by call reason and town to summarize hours.</span>
<span id="cb26-658"><a href="#cb26-658" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Constructed an area plot with an lm trend line.</span>
<span id="cb26-659"><a href="#cb26-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-660"><a href="#cb26-660" aria-hidden="true" tabindex="-1"></a>The change in total hours worked over time shows the big picture:</span>
<span id="cb26-661"><a href="#cb26-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-662"><a href="#cb26-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkTotalHours, fig.width=10, fig.height=5}</span></span>
<span id="cb26-663"><a href="#cb26-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-664"><a href="#cb26-664" aria-hidden="true" tabindex="-1"></a><span class="do">### first plot shows the big picture: change in total hours</span></span>
<span id="cb26-665"><a href="#cb26-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-666"><a href="#cb26-666" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-667"><a href="#cb26-667" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, town) <span class="sc">%&gt;%</span></span>
<span id="cb26-668"><a href="#cb26-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb26-669"><a href="#cb26-669" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-670"><a href="#cb26-670" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb26-671"><a href="#cb26-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> totalHours, <span class="at">fill =</span> town)) <span class="sc">+</span> </span>
<span id="cb26-672"><a href="#cb26-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb26-673"><a href="#cb26-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total hours: Police officers working on calls"</span>,</span>
<span id="cb26-674"><a href="#cb26-674" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb26-675"><a href="#cb26-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb26-676"><a href="#cb26-676" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb26-677"><a href="#cb26-677" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb26-678"><a href="#cb26-678" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb26-679"><a href="#cb26-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb26-680"><a href="#cb26-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb26-681"><a href="#cb26-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span>
<span id="cb26-682"><a href="#cb26-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-683"><a href="#cb26-683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-684"><a href="#cb26-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-685"><a href="#cb26-685" aria-hidden="true" tabindex="-1"></a>The big picture shows **`r crYeargrowthPct` growth** in total hours worked by police officers in the two towns together **from `r year(crYearDF$year)[1]` to `r year(crYearDF$year)[5]`**. </span>
<span id="cb26-686"><a href="#cb26-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-687"><a href="#cb26-687" aria-hidden="true" tabindex="-1"></a>Another way to express this is with a linear model, the **&lt;span style="color:orangered;"&gt;orange trend line&lt;/span&gt;**: we've seen the two towns add **`r crYeargrowthLMChar` hours** of policing every year. This could be useful for the town's personnel planning. Assuming a **`r assumedFTE`-hour full-time equivalence (FTE)** and an increase of `r crYeargrowthLM` hours per year (or **`r crYeargrowthLMweekChar` hours per week**), Leverett and Wendell police call hours grow by **`r crYeargrowthFTEChar` FTE each year**.</span>
<span id="cb26-688"><a href="#cb26-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-689"><a href="#cb26-689" aria-hidden="true" tabindex="-1"></a>For these simple models, I have omitted call reasons with incidence too low to calculate estimated growth. These had NA values for the correlation coefficient which complicates the analysis, and since these call reasons are so infrequent their omission is not to the detriment of analysis. </span>
<span id="cb26-690"><a href="#cb26-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-691"><a href="#cb26-691" aria-hidden="true" tabindex="-1"></a>This answers the first question: </span>
<span id="cb26-692"><a href="#cb26-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-693"><a href="#cb26-693" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-694"><a href="#cb26-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-695"><a href="#cb26-695" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specific question for analysis</span></span>
<span id="cb26-696"><a href="#cb26-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-697"><a href="#cb26-697" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Has the time spent doing police work grown over time?</span>
<span id="cb26-698"><a href="#cb26-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-699"><a href="#cb26-699" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-700"><a href="#cb26-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-701"><a href="#cb26-701" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false}</span>
<span id="cb26-702"><a href="#cb26-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-703"><a href="#cb26-703" aria-hidden="true" tabindex="-1"></a><span class="fu">## An answer!</span></span>
<span id="cb26-704"><a href="#cb26-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-705"><a href="#cb26-705" aria-hidden="true" tabindex="-1"></a>Yes, Leverett and Wendell added <span class="in">`r crYeargrowthLM`</span> hours of policing, or <span class="in">`r crYeargrowthFTE`</span> FTE, every year from <span class="in">`r year(crYearDF$year)[1]`</span> to <span class="in">`r year(crYearDF$year)[5]`</span></span>
<span id="cb26-706"><a href="#cb26-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-707"><a href="#cb26-707" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-708"><a href="#cb26-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-709"><a href="#cb26-709" aria-hidden="true" tabindex="-1"></a>Note that 2,080 hours is a year's worth of FTE, and the call data show that the total hours spent policing in both towns is less than 1 FTE. </span>
<span id="cb26-710"><a href="#cb26-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-711"><a href="#cb26-711" aria-hidden="true" tabindex="-1"></a>Call hour workload is an important factor in public safety personnel management. There is also the need for sufficient coverage so officers are available to respond to calls when they come in. There is also the self-determination of the community: the people who live in a town contribute by right to decisions about public safety. Although these are both necessary elements of a full understanding of policing and public safety, they're beyond the scope of this analysis.</span>
<span id="cb26-712"><a href="#cb26-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-713"><a href="#cb26-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-714"><a href="#cb26-714" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing towns</span></span>
<span id="cb26-715"><a href="#cb26-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-716"><a href="#cb26-716" aria-hidden="true" tabindex="-1"></a>What else could we learn from this data set about what drives this growth in policing?</span>
<span id="cb26-717"><a href="#cb26-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-718"><a href="#cb26-718" aria-hidden="true" tabindex="-1"></a>A simple next step is to compare the towns. Faceting by town lets us compare the change in calls and hours worked over the 5-year period:</span>
<span id="cb26-719"><a href="#cb26-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-720"><a href="#cb26-720" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByTown, fig.width=10, fig.height=10}</span></span>
<span id="cb26-721"><a href="#cb26-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-722"><a href="#cb26-722" aria-hidden="true" tabindex="-1"></a>  <span class="co"># total call volume by town</span></span>
<span id="cb26-723"><a href="#cb26-723" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> crTownYearDF <span class="sc">%&gt;%</span></span>
<span id="cb26-724"><a href="#cb26-724" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> totalCalls, <span class="at">fill =</span> town)) <span class="sc">+</span> </span>
<span id="cb26-725"><a href="#cb26-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb26-726"><a href="#cb26-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total call volume by town"</span>,</span>
<span id="cb26-727"><a href="#cb26-727" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Calls"</span>) <span class="sc">+</span></span>
<span id="cb26-728"><a href="#cb26-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb26-729"><a href="#cb26-729" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb26-730"><a href="#cb26-730" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb26-731"><a href="#cb26-731" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span></span>
<span id="cb26-732"><a href="#cb26-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb26-733"><a href="#cb26-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb26-734"><a href="#cb26-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb26-735"><a href="#cb26-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(town))</span>
<span id="cb26-736"><a href="#cb26-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-737"><a href="#cb26-737" aria-hidden="true" tabindex="-1"></a>  <span class="co"># total hours by town</span></span>
<span id="cb26-738"><a href="#cb26-738" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> crTownYearDF <span class="sc">%&gt;%</span></span>
<span id="cb26-739"><a href="#cb26-739" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> totalHours, <span class="at">fill =</span> town)) <span class="sc">+</span> </span>
<span id="cb26-740"><a href="#cb26-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb26-741"><a href="#cb26-741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total hours by town"</span>,</span>
<span id="cb26-742"><a href="#cb26-742" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb26-743"><a href="#cb26-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb26-744"><a href="#cb26-744" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb26-745"><a href="#cb26-745" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb26-746"><a href="#cb26-746" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span></span>
<span id="cb26-747"><a href="#cb26-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb26-748"><a href="#cb26-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb26-749"><a href="#cb26-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb26-750"><a href="#cb26-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(town))</span>
<span id="cb26-751"><a href="#cb26-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-752"><a href="#cb26-752" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(g1, g2, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb26-753"><a href="#cb26-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-754"><a href="#cb26-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-755"><a href="#cb26-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-756"><a href="#cb26-756" aria-hidden="true" tabindex="-1"></a>Most calls come from Leverett and the LPD works most hours in response to Leverett calls. **&lt;span style="color:orangered;"&gt;Orange trend lines&lt;/span&gt;** have a positive slope on all 4 plots, slightly more so for Wendell. This means that there is a positive correlation coefficient when using year as a predictor of total hours: positive growth over time.</span>
<span id="cb26-757"><a href="#cb26-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-758"><a href="#cb26-758" aria-hidden="true" tabindex="-1"></a>Using the same analysis that I applied to total hours, this table summarizes rates of change that correspond to the **&lt;span style="color:orangered;"&gt;orange trend line&lt;/span&gt;** in these plots: </span>
<span id="cb26-759"><a href="#cb26-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-760"><a href="#cb26-760" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Growth trends: Total hours by town</span></span>
<span id="cb26-761"><a href="#cb26-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-762"><a href="#cb26-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByTownGrowthSummary, fig.width=10, fig.height=4}</span></span>
<span id="cb26-763"><a href="#cb26-763" aria-hidden="true" tabindex="-1"></a>crtyGrowthDF</span>
<span id="cb26-764"><a href="#cb26-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-765"><a href="#cb26-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-766"><a href="#cb26-766" aria-hidden="true" tabindex="-1"></a>This reveals that Wendell, despite their low proportion of calls and hours, has driven most growth in calls compared with Leverett. </span>
<span id="cb26-767"><a href="#cb26-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-768"><a href="#cb26-768" aria-hidden="true" tabindex="-1"></a>It's more accurate and fair to say that missing data from Wendell has driven the appearance of more than half of the rate of growth in the data. As described earlier, I learned from my discussion with LPD Chief Minckler that Wendell's former police chief didn't log calls consistently. Improved data input by LPD officers has created a more accurate record of policing in Wendell. It's possible to use this data set to estimate Wendell's past police call data, but that's beyond the scope of this analysis.</span>
<span id="cb26-769"><a href="#cb26-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-770"><a href="#cb26-770" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-771"><a href="#cb26-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-772"><a href="#cb26-772" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specific questions for analysis</span></span>
<span id="cb26-773"><a href="#cb26-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-774"><a href="#cb26-774" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Leverett and Wendell began a regionalization agreement in 2020. How has that impacted the data of time spent on calls?</span>
<span id="cb26-775"><a href="#cb26-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-776"><a href="#cb26-776" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-777"><a href="#cb26-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-778"><a href="#cb26-778" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false}</span>
<span id="cb26-779"><a href="#cb26-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-780"><a href="#cb26-780" aria-hidden="true" tabindex="-1"></a><span class="fu">## An answer!</span></span>
<span id="cb26-781"><a href="#cb26-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-782"><a href="#cb26-782" aria-hidden="true" tabindex="-1"></a>By taking responsibility for policing in Wendell, LPD officers have improved call data about Wendell policing, bringing it up to LPD quality. When summarizing data inclusively before and after regionalization, Wendell shows **`r as.character(crtyGrowthDF[2,2])` growth** in hours on calls from 2018 to 2022 -- or what appears to be **`r as.character(crtyGrowthDF[2,4])` additional hours** of police work every week. </span>
<span id="cb26-783"><a href="#cb26-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-784"><a href="#cb26-784" aria-hidden="true" tabindex="-1"></a>Anecdotally, I learned from LPD Chief Minckler that the previous Wendell police chief did not log all calls. This probably explains Wendell's high rate. Two to three years from now, LPD will have more data and experience to support a confident assessment of Wendell's true policing needs.</span>
<span id="cb26-785"><a href="#cb26-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-786"><a href="#cb26-786" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-787"><a href="#cb26-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-788"><a href="#cb26-788" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing call reasons</span></span>
<span id="cb26-789"><a href="#cb26-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-790"><a href="#cb26-790" aria-hidden="true" tabindex="-1"></a>With <span class="in">`r as.character(length(levels(callReasonsDF$call_reason))[1])`</span> factor levels, the plot of total hours by call reason is a blur and the legend would take up the whole page. This plot is only useful to show the complication of grouping by call reasons: </span>
<span id="cb26-791"><a href="#cb26-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-792"><a href="#cb26-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByReason1, fig.width=10, fig.height=4}</span></span>
<span id="cb26-793"><a href="#cb26-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-794"><a href="#cb26-794" aria-hidden="true" tabindex="-1"></a>crYearReason <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-795"><a href="#cb26-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb26-796"><a href="#cb26-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb26-797"><a href="#cb26-797" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalCalls =</span> <span class="fu">sum</span>(totalCalls),</span>
<span id="cb26-798"><a href="#cb26-798" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-799"><a href="#cb26-799" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-800"><a href="#cb26-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-801"><a href="#cb26-801" aria-hidden="true" tabindex="-1"></a>crYearReason <span class="sc">%&gt;%</span></span>
<span id="cb26-802"><a href="#cb26-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> totalHours, <span class="at">fill =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb26-803"><a href="#cb26-803" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb26-804"><a href="#cb26-804" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Total hours by call reason"</span>,</span>
<span id="cb26-805"><a href="#cb26-805" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb26-806"><a href="#cb26-806" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb26-807"><a href="#cb26-807" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb26-808"><a href="#cb26-808" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>))</span>
<span id="cb26-809"><a href="#cb26-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-810"><a href="#cb26-810" aria-hidden="true" tabindex="-1"></a><span class="co"># will use this in next chunk to get proportion of each call reason factor</span></span>
<span id="cb26-811"><a href="#cb26-811" aria-hidden="true" tabindex="-1"></a>grandTotalHours <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">sum</span>(callReasonsDF<span class="sc">$</span>totalHours), <span class="dv">0</span>)</span>
<span id="cb26-812"><a href="#cb26-812" aria-hidden="true" tabindex="-1"></a>grandTotalHoursChar <span class="ot">=</span> <span class="fu">as.character</span>(<span class="fu">format</span>(grandTotalHours, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">scientific =</span> <span class="cn">FALSE</span>))</span>
<span id="cb26-813"><a href="#cb26-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-814"><a href="#cb26-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-815"><a href="#cb26-815" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-816"><a href="#cb26-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-817"><a href="#cb26-817" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Top level-of-effort call reasons</span></span>
<span id="cb26-818"><a href="#cb26-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-819"><a href="#cb26-819" aria-hidden="true" tabindex="-1"></a>Grouping by <span class="in">`call_reason`</span> and summing total hours allows me to learn which types of calls take the most time. This lollipop plot shows the top 30 call reasons in terms of hours worked in both towns over the 5-year period. From 2018 to 2022, there was **a grand total of `r grandTotalHoursChar` hours** for all calls in both towns. Each lollipop in the plot shows the absolute number of hours and the percentage of the grand total.</span>
<span id="cb26-820"><a href="#cb26-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-821"><a href="#cb26-821" aria-hidden="true" tabindex="-1"></a>I used factors ordered by linear regression estimates made in a previous code chunk to find the top N call reasons by rate of growth.</span>
<span id="cb26-822"><a href="#cb26-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-823"><a href="#cb26-823" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByReason2, fig.width=10, fig.height=10}</span></span>
<span id="cb26-824"><a href="#cb26-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-825"><a href="#cb26-825" aria-hidden="true" tabindex="-1"></a><span class="co"># this gets factors of top 30 call reasons by hours worked</span></span>
<span id="cb26-826"><a href="#cb26-826" aria-hidden="true" tabindex="-1"></a>crFactorTotals <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-827"><a href="#cb26-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb26-828"><a href="#cb26-828" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb26-829"><a href="#cb26-829" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">round</span>(<span class="fu">sum</span>(totalHours), <span class="dv">1</span>)</span>
<span id="cb26-830"><a href="#cb26-830" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb26-831"><a href="#cb26-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-832"><a href="#cb26-832" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> crFactorTotals <span class="sc">%&gt;%</span></span>
<span id="cb26-833"><a href="#cb26-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(totalHours)) <span class="sc">%&gt;%</span></span>
<span id="cb26-834"><a href="#cb26-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-835"><a href="#cb26-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb26-836"><a href="#cb26-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-837"><a href="#cb26-837" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-838"><a href="#cb26-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb26-839"><a href="#cb26-839" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb26-840"><a href="#cb26-840" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-841"><a href="#cb26-841" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb26-842"><a href="#cb26-842" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-843"><a href="#cb26-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, totalHours)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-844"><a href="#cb26-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span>    <span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb26-845"><a href="#cb26-845" aria-hidden="true" tabindex="-1"></a>                                                              <span class="co"># it works in this plot but not the next one...</span></span>
<span id="cb26-846"><a href="#cb26-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-847"><a href="#cb26-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> totalHours, <span class="at">y =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb26-848"><a href="#cb26-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"dodgerblue4"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  </span>
<span id="cb26-849"><a href="#cb26-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb26-850"><a href="#cb26-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(percentOfAllHours, <span class="st">"%"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-851"><a href="#cb26-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb26-852"><a href="#cb26-852" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1500</span>),</span>
<span id="cb26-853"><a href="#cb26-853" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">250</span>),</span>
<span id="cb26-854"><a href="#cb26-854" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">50</span>),</span>
<span id="cb26-855"><a href="#cb26-855" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"top"</span></span>
<span id="cb26-856"><a href="#cb26-856" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-857"><a href="#cb26-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top level-of-effort"</span>,</span>
<span id="cb26-858"><a href="#cb26-858" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"Top 30 call reasons 2018-2022 (# of hours, % of all hours)"</span>,</span>
<span id="cb26-859"><a href="#cb26-859" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Level-of-effort: Total hours worked"</span>,</span>
<span id="cb26-860"><a href="#cb26-860" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Reasons (top to bottom: most to least LOE)"</span>) <span class="sc">+</span></span>
<span id="cb26-861"><a href="#cb26-861" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_viridis(discrete = T, option = "cividis") +</span></span>
<span id="cb26-862"><a href="#cb26-862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() </span>
<span id="cb26-863"><a href="#cb26-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-864"><a href="#cb26-864" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-865"><a href="#cb26-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-866"><a href="#cb26-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-867"><a href="#cb26-867" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-868"><a href="#cb26-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-869"><a href="#cb26-869" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specific questions for analysis</span></span>
<span id="cb26-870"><a href="#cb26-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-871"><a href="#cb26-871" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Which call reasons require the most personnel time?</span>
<span id="cb26-872"><a href="#cb26-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-873"><a href="#cb26-873" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-874"><a href="#cb26-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-875"><a href="#cb26-875" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false}</span>
<span id="cb26-876"><a href="#cb26-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-877"><a href="#cb26-877" aria-hidden="true" tabindex="-1"></a><span class="fu">## An answer!</span></span>
<span id="cb26-878"><a href="#cb26-878" aria-hidden="true" tabindex="-1"></a><span class="in">`r topHourFactors`</span></span>
<span id="cb26-879"><a href="#cb26-879" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-880"><a href="#cb26-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-881"><a href="#cb26-881" aria-hidden="true" tabindex="-1"></a>We can facet plot to zoom in on the top 9 reasons, and see a correlation coefficient for each one. Some trend up, some trend down. This is interesting, but difficult to see a helpful pattern.</span>
<span id="cb26-882"><a href="#cb26-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-883"><a href="#cb26-883" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByReason3, fig.width=10, fig.height=10}</span></span>
<span id="cb26-884"><a href="#cb26-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-885"><a href="#cb26-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-886"><a href="#cb26-886" aria-hidden="true" tabindex="-1"></a>  <span class="co"># next we only want top 9 reasons with the most total call hours</span></span>
<span id="cb26-887"><a href="#cb26-887" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> topHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb26-888"><a href="#cb26-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(totalHours)) <span class="sc">%&gt;%</span></span>
<span id="cb26-889"><a href="#cb26-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-890"><a href="#cb26-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb26-891"><a href="#cb26-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-892"><a href="#cb26-892" aria-hidden="true" tabindex="-1"></a><span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb26-893"><a href="#cb26-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-894"><a href="#cb26-894" aria-hidden="true" tabindex="-1"></a>crTopHours <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-895"><a href="#cb26-895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason, year) <span class="sc">%&gt;%</span></span>
<span id="cb26-896"><a href="#cb26-896" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb26-897"><a href="#cb26-897" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-898"><a href="#cb26-898" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb26-899"><a href="#cb26-899" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-900"><a href="#cb26-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb26-901"><a href="#cb26-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-902"><a href="#cb26-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, totalHours)) </span>
<span id="cb26-903"><a href="#cb26-903" aria-hidden="true" tabindex="-1"></a>       <span class="co"># this fct_reorder isn't working to reorder, although it works in the previous chunk</span></span>
<span id="cb26-904"><a href="#cb26-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-905"><a href="#cb26-905" aria-hidden="true" tabindex="-1"></a>crTopHours <span class="sc">%&gt;%</span></span>
<span id="cb26-906"><a href="#cb26-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb26-907"><a href="#cb26-907" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> totalHours, </span>
<span id="cb26-908"><a href="#cb26-908" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb26-909"><a href="#cb26-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb26-910"><a href="#cb26-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb26-911"><a href="#cb26-911" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb26-912"><a href="#cb26-912" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">8</span>,</span>
<span id="cb26-913"><a href="#cb26-913" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>,</span>
<span id="cb26-914"><a href="#cb26-914" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb26-915"><a href="#cb26-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leaderboard: Top level-of-effort"</span>,</span>
<span id="cb26-916"><a href="#cb26-916" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"9 call reasons with the most hours"</span>,</span>
<span id="cb26-917"><a href="#cb26-917" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb26-918"><a href="#cb26-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb26-919"><a href="#cb26-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb26-920"><a href="#cb26-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb26-921"><a href="#cb26-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>call_reason) <span class="sc">+</span></span>
<span id="cb26-922"><a href="#cb26-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> </span>
<span id="cb26-923"><a href="#cb26-923" aria-hidden="true" tabindex="-1"></a>          <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb26-924"><a href="#cb26-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-925"><a href="#cb26-925" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-926"><a href="#cb26-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-927"><a href="#cb26-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-928"><a href="#cb26-928" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Top growth call reasons</span></span>
<span id="cb26-929"><a href="#cb26-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-930"><a href="#cb26-930" aria-hidden="true" tabindex="-1"></a>Since we can calculate a trend line for each call reason, we can identify the call reasons with the steepest trend lines as a representation of call level-of-effort that has grown the most since 2018. The next lollipop plot shows the top 30 call reasons by growth. In parity with the previous plot, the <span class="kw">&lt;span</span> <span class="er">style</span><span class="ot">=</span><span class="st">"color:blue;"</span><span class="kw">&gt;</span>blue<span class="kw">&lt;/span&gt;</span> and <span class="kw">&lt;span</span> <span class="er">style</span><span class="ot">=</span><span class="st">"color:orangered;"</span><span class="kw">&gt;</span>orange<span class="kw">&lt;/span&gt;</span> lollipops still represent total hours worked.</span>
<span id="cb26-931"><a href="#cb26-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-932"><a href="#cb26-932" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByReason5, fig.width=10, fig.height=10}</span></span>
<span id="cb26-933"><a href="#cb26-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-934"><a href="#cb26-934" aria-hidden="true" tabindex="-1"></a><span class="co"># this gets factors of top 30 call reasons by growth in hours</span></span>
<span id="cb26-935"><a href="#cb26-935" aria-hidden="true" tabindex="-1"></a>crFactorTotals2 <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-936"><a href="#cb26-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb26-937"><a href="#cb26-937" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb26-938"><a href="#cb26-938" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimateChangeHours =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason)</span>
<span id="cb26-939"><a href="#cb26-939" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb26-940"><a href="#cb26-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-941"><a href="#cb26-941" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(topHourFactors) <span class="co"># clear the previous df</span></span>
<span id="cb26-942"><a href="#cb26-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-943"><a href="#cb26-943" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> crFactorTotals2 <span class="sc">%&gt;%</span></span>
<span id="cb26-944"><a href="#cb26-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(estimateChangeHours)) <span class="sc">%&gt;%</span></span>
<span id="cb26-945"><a href="#cb26-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-946"><a href="#cb26-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb26-947"><a href="#cb26-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-948"><a href="#cb26-948" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-949"><a href="#cb26-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb26-950"><a href="#cb26-950" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb26-951"><a href="#cb26-951" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-952"><a href="#cb26-952" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb26-953"><a href="#cb26-953" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason)</span>
<span id="cb26-954"><a href="#cb26-954" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-955"><a href="#cb26-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, estYearlyHourChange_Reason)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-956"><a href="#cb26-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span>    </span>
<span id="cb26-957"><a href="#cb26-957" aria-hidden="true" tabindex="-1"></a>      <span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb26-958"><a href="#cb26-958" aria-hidden="true" tabindex="-1"></a>      <span class="co"># does it work in this plot?</span></span>
<span id="cb26-959"><a href="#cb26-959" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-960"><a href="#cb26-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> totalHours, <span class="at">y =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb26-961"><a href="#cb26-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"dodgerblue4"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  </span>
<span id="cb26-962"><a href="#cb26-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb26-963"><a href="#cb26-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> </span>
<span id="cb26-964"><a href="#cb26-964" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">"+"</span>, estYearlyHourChange_Reason, <span class="st">" hrs/yr"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-965"><a href="#cb26-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb26-966"><a href="#cb26-966" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1100</span>),</span>
<span id="cb26-967"><a href="#cb26-967" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">250</span>),</span>
<span id="cb26-968"><a href="#cb26-968" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">50</span>),</span>
<span id="cb26-969"><a href="#cb26-969" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"top"</span></span>
<span id="cb26-970"><a href="#cb26-970" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-971"><a href="#cb26-971" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top growth"</span>,</span>
<span id="cb26-972"><a href="#cb26-972" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"Top 30 call reasons by growth"</span>,</span>
<span id="cb26-973"><a href="#cb26-973" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Level-of-effort: Total hours worked"</span>,</span>
<span id="cb26-974"><a href="#cb26-974" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Reasons (top to bottom: most to least growth)"</span>) <span class="sc">+</span></span>
<span id="cb26-975"><a href="#cb26-975" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_viridis(discrete = T, option = "cividis") +</span></span>
<span id="cb26-976"><a href="#cb26-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() </span>
<span id="cb26-977"><a href="#cb26-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-978"><a href="#cb26-978" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-979"><a href="#cb26-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-980"><a href="#cb26-980" aria-hidden="true" tabindex="-1"></a>The top 9 facets by growth reveal somewhat more clearly the public safety landscape of these two towns. </span>
<span id="cb26-981"><a href="#cb26-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-982"><a href="#cb26-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-983"><a href="#cb26-983" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByReason6, fig.width=10, fig.height=10}</span></span>
<span id="cb26-984"><a href="#cb26-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-985"><a href="#cb26-985" aria-hidden="true" tabindex="-1"></a>  <span class="co"># next we only want top 9 high growth reasons with the most total call hours</span></span>
<span id="cb26-986"><a href="#cb26-986" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> topHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb26-987"><a href="#cb26-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(estimateChangeHours)) <span class="sc">%&gt;%</span></span>
<span id="cb26-988"><a href="#cb26-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-989"><a href="#cb26-989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb26-990"><a href="#cb26-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-991"><a href="#cb26-991" aria-hidden="true" tabindex="-1"></a><span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb26-992"><a href="#cb26-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-993"><a href="#cb26-993" aria-hidden="true" tabindex="-1"></a>crTopGrowthHours <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-994"><a href="#cb26-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason, year) <span class="sc">%&gt;%</span></span>
<span id="cb26-995"><a href="#cb26-995" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb26-996"><a href="#cb26-996" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-997"><a href="#cb26-997" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb26-998"><a href="#cb26-998" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason)</span>
<span id="cb26-999"><a href="#cb26-999" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-1000"><a href="#cb26-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb26-1001"><a href="#cb26-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-1002"><a href="#cb26-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, estYearlyHourChange_Reason)) </span>
<span id="cb26-1003"><a href="#cb26-1003" aria-hidden="true" tabindex="-1"></a>        <span class="co"># this fct_reorder isn't working to reorder the facets</span></span>
<span id="cb26-1004"><a href="#cb26-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1005"><a href="#cb26-1005" aria-hidden="true" tabindex="-1"></a>crTopGrowthHours <span class="sc">%&gt;%</span></span>
<span id="cb26-1006"><a href="#cb26-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb26-1007"><a href="#cb26-1007" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> totalHours, </span>
<span id="cb26-1008"><a href="#cb26-1008" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb26-1009"><a href="#cb26-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb26-1010"><a href="#cb26-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb26-1011"><a href="#cb26-1011" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb26-1012"><a href="#cb26-1012" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">8</span>,</span>
<span id="cb26-1013"><a href="#cb26-1013" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>,</span>
<span id="cb26-1014"><a href="#cb26-1014" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb26-1015"><a href="#cb26-1015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leaderboard: Top growth"</span>,</span>
<span id="cb26-1016"><a href="#cb26-1016" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"9 call reasons that have grown the most"</span>,</span>
<span id="cb26-1017"><a href="#cb26-1017" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb26-1018"><a href="#cb26-1018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb26-1019"><a href="#cb26-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb26-1020"><a href="#cb26-1020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb26-1021"><a href="#cb26-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>call_reason) <span class="sc">+</span></span>
<span id="cb26-1022"><a href="#cb26-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> </span>
<span id="cb26-1023"><a href="#cb26-1023" aria-hidden="true" tabindex="-1"></a>          <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb26-1024"><a href="#cb26-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1025"><a href="#cb26-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-1026"><a href="#cb26-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1027"><a href="#cb26-1027" aria-hidden="true" tabindex="-1"></a>Or -- an important reminder that volume and rate are independent from each other -- we may have a set of public safety needs with a mixture of causes. For example, do these rates of change reflect administrative changes in record keeping? Do 'assist citizen' and 'officer wanted' call trends represent change in public safety needs, or change in how calls are logged?  Has the incidence of death been so infrequent, or were calls about a person's death coded differently during 2019 and 2020? This data won't answer these questions, but my hope is that people can use this analysis will help prompt and clarify questions like these.</span>
<span id="cb26-1028"><a href="#cb26-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1029"><a href="#cb26-1029" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Top impact call reasons</span></span>
<span id="cb26-1030"><a href="#cb26-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1031"><a href="#cb26-1031" aria-hidden="true" tabindex="-1"></a>Let's combine total hours with top growth to get a better sense of call reasons with the most impact.  </span>
<span id="cb26-1032"><a href="#cb26-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1033"><a href="#cb26-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByReason7, fig.width=10, fig.height=10}</span></span>
<span id="cb26-1034"><a href="#cb26-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1035"><a href="#cb26-1035" aria-hidden="true" tabindex="-1"></a><span class="co"># this gets factors of top 30 call reasons with top hours worked by growth in hours</span></span>
<span id="cb26-1036"><a href="#cb26-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1037"><a href="#cb26-1037" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(crFactorTotals2)  <span class="co"># clear the previous df</span></span>
<span id="cb26-1038"><a href="#cb26-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1039"><a href="#cb26-1039" aria-hidden="true" tabindex="-1"></a>crFactorTotals2 <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-1040"><a href="#cb26-1040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb26-1041"><a href="#cb26-1041" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb26-1042"><a href="#cb26-1042" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-1043"><a href="#cb26-1043" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb26-1044"><a href="#cb26-1044" aria-hidden="true" tabindex="-1"></a>    <span class="at">productImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-1045"><a href="#cb26-1045" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb26-1046"><a href="#cb26-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1047"><a href="#cb26-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(topHourFactors) <span class="co"># clear the previous df</span></span>
<span id="cb26-1048"><a href="#cb26-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1049"><a href="#cb26-1049" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> crFactorTotals2 <span class="sc">%&gt;%</span></span>
<span id="cb26-1050"><a href="#cb26-1050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(productImpact)) <span class="sc">%&gt;%</span></span>
<span id="cb26-1051"><a href="#cb26-1051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-1052"><a href="#cb26-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb26-1053"><a href="#cb26-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1054"><a href="#cb26-1054" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-1055"><a href="#cb26-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb26-1056"><a href="#cb26-1056" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb26-1057"><a href="#cb26-1057" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-1058"><a href="#cb26-1058" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb26-1059"><a href="#cb26-1059" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb26-1060"><a href="#cb26-1060" aria-hidden="true" tabindex="-1"></a>    <span class="at">productImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-1061"><a href="#cb26-1061" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-1062"><a href="#cb26-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, productImpact)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-1063"><a href="#cb26-1063" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span>    </span>
<span id="cb26-1064"><a href="#cb26-1064" aria-hidden="true" tabindex="-1"></a>      <span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb26-1065"><a href="#cb26-1065" aria-hidden="true" tabindex="-1"></a>      <span class="co"># does it work in this plot?</span></span>
<span id="cb26-1066"><a href="#cb26-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-1067"><a href="#cb26-1067" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> totalHours, <span class="at">y =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb26-1068"><a href="#cb26-1068" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"dodgerblue4"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  </span>
<span id="cb26-1069"><a href="#cb26-1069" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb26-1070"><a href="#cb26-1070" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> </span>
<span id="cb26-1071"><a href="#cb26-1071" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">"+"</span>, estYearlyHourChange_Reason, <span class="st">" hrs/yr"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-1072"><a href="#cb26-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb26-1073"><a href="#cb26-1073" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1100</span>),</span>
<span id="cb26-1074"><a href="#cb26-1074" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">250</span>),</span>
<span id="cb26-1075"><a href="#cb26-1075" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">50</span>),</span>
<span id="cb26-1076"><a href="#cb26-1076" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"top"</span></span>
<span id="cb26-1077"><a href="#cb26-1077" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-1078"><a href="#cb26-1078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top impact"</span>,</span>
<span id="cb26-1079"><a href="#cb26-1079" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"30 call reasons with top level-of-effort and top growth"</span>,</span>
<span id="cb26-1080"><a href="#cb26-1080" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Level-of-effort: Total hours worked"</span>,</span>
<span id="cb26-1081"><a href="#cb26-1081" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Reasons (top to bottom: most to least impact)"</span>) <span class="sc">+</span></span>
<span id="cb26-1082"><a href="#cb26-1082" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_viridis(discrete = T, option = "cividis") +</span></span>
<span id="cb26-1083"><a href="#cb26-1083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() </span>
<span id="cb26-1084"><a href="#cb26-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1085"><a href="#cb26-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-1086"><a href="#cb26-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1087"><a href="#cb26-1087" aria-hidden="true" tabindex="-1"></a>Now we can examine the 9 facets of the most impactful call reasons:</span>
<span id="cb26-1088"><a href="#cb26-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1089"><a href="#cb26-1089" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByReason8, fig.width=10, fig.height=10}</span></span>
<span id="cb26-1090"><a href="#cb26-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1091"><a href="#cb26-1091" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> topHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb26-1092"><a href="#cb26-1092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(productImpact)) <span class="sc">%&gt;%</span></span>
<span id="cb26-1093"><a href="#cb26-1093" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-1094"><a href="#cb26-1094" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb26-1095"><a href="#cb26-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1096"><a href="#cb26-1096" aria-hidden="true" tabindex="-1"></a>crTopGrowthHours <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-1097"><a href="#cb26-1097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason, year) <span class="sc">%&gt;%</span></span>
<span id="cb26-1098"><a href="#cb26-1098" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb26-1099"><a href="#cb26-1099" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-1100"><a href="#cb26-1100" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb26-1101"><a href="#cb26-1101" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb26-1102"><a href="#cb26-1102" aria-hidden="true" tabindex="-1"></a>    <span class="at">productImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-1103"><a href="#cb26-1103" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-1104"><a href="#cb26-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(topHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb26-1105"><a href="#cb26-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-1106"><a href="#cb26-1106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, productImpact)) </span>
<span id="cb26-1107"><a href="#cb26-1107" aria-hidden="true" tabindex="-1"></a>        <span class="co"># this fct_reorder isn't working to reorder the facets</span></span>
<span id="cb26-1108"><a href="#cb26-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1109"><a href="#cb26-1109" aria-hidden="true" tabindex="-1"></a>crTopGrowthHours <span class="sc">%&gt;%</span></span>
<span id="cb26-1110"><a href="#cb26-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb26-1111"><a href="#cb26-1111" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> totalHours, </span>
<span id="cb26-1112"><a href="#cb26-1112" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb26-1113"><a href="#cb26-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb26-1114"><a href="#cb26-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb26-1115"><a href="#cb26-1115" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb26-1116"><a href="#cb26-1116" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">8</span>,</span>
<span id="cb26-1117"><a href="#cb26-1117" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>,</span>
<span id="cb26-1118"><a href="#cb26-1118" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb26-1119"><a href="#cb26-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leaderboard: Top impact"</span>,</span>
<span id="cb26-1120"><a href="#cb26-1120" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"9 call reasons with the most hours that have grown the most"</span>,</span>
<span id="cb26-1121"><a href="#cb26-1121" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb26-1122"><a href="#cb26-1122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb26-1123"><a href="#cb26-1123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb26-1124"><a href="#cb26-1124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb26-1125"><a href="#cb26-1125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>call_reason) <span class="sc">+</span></span>
<span id="cb26-1126"><a href="#cb26-1126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> </span>
<span id="cb26-1127"><a href="#cb26-1127" aria-hidden="true" tabindex="-1"></a>          <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb26-1128"><a href="#cb26-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1129"><a href="#cb26-1129" aria-hidden="true" tabindex="-1"></a>topHourFactors <span class="ot">&lt;-</span> topHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb26-1130"><a href="#cb26-1130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(call_reason, totalHours, estYearlyHourChange_Reason))</span>
<span id="cb26-1131"><a href="#cb26-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1132"><a href="#cb26-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-1133"><a href="#cb26-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1134"><a href="#cb26-1134" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-1135"><a href="#cb26-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1136"><a href="#cb26-1136" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specific questions for analysis</span></span>
<span id="cb26-1137"><a href="#cb26-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1138"><a href="#cb26-1138" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>What call reasons have grown the most over time, in terms of personnel time?</span>
<span id="cb26-1139"><a href="#cb26-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1140"><a href="#cb26-1140" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1141"><a href="#cb26-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1142"><a href="#cb26-1142" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false}</span>
<span id="cb26-1143"><a href="#cb26-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1144"><a href="#cb26-1144" aria-hidden="true" tabindex="-1"></a><span class="fu">## An answer!</span></span>
<span id="cb26-1145"><a href="#cb26-1145" aria-hidden="true" tabindex="-1"></a><span class="in">`r topHourFactors`</span></span>
<span id="cb26-1146"><a href="#cb26-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1147"><a href="#cb26-1147" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1148"><a href="#cb26-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1149"><a href="#cb26-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1150"><a href="#cb26-1150" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Bottom impact call reasons</span></span>
<span id="cb26-1151"><a href="#cb26-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1152"><a href="#cb26-1152" aria-hidden="true" tabindex="-1"></a>Which call reasons have decreased the most?</span>
<span id="cb26-1153"><a href="#cb26-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1154"><a href="#cb26-1154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByReason9, fig.width=10, fig.height=10}</span></span>
<span id="cb26-1155"><a href="#cb26-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1156"><a href="#cb26-1156" aria-hidden="true" tabindex="-1"></a><span class="co"># this gets factors of bottom 30 call reasons with top hours worked by growth in hours</span></span>
<span id="cb26-1157"><a href="#cb26-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1158"><a href="#cb26-1158" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(crFactorTotals2)  <span class="co"># clear the previous df</span></span>
<span id="cb26-1159"><a href="#cb26-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1160"><a href="#cb26-1160" aria-hidden="true" tabindex="-1"></a>crFactorTotals2 <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-1161"><a href="#cb26-1161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb26-1162"><a href="#cb26-1162" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb26-1163"><a href="#cb26-1163" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-1164"><a href="#cb26-1164" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb26-1165"><a href="#cb26-1165" aria-hidden="true" tabindex="-1"></a>    <span class="at">productLeastImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-1166"><a href="#cb26-1166" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb26-1167"><a href="#cb26-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1168"><a href="#cb26-1168" aria-hidden="true" tabindex="-1"></a>bottomHourFactors <span class="ot">&lt;-</span> crFactorTotals2 <span class="sc">%&gt;%</span></span>
<span id="cb26-1169"><a href="#cb26-1169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(productLeastImpact)) <span class="sc">%&gt;%</span></span>
<span id="cb26-1170"><a href="#cb26-1170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-1171"><a href="#cb26-1171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb26-1172"><a href="#cb26-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1173"><a href="#cb26-1173" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-1174"><a href="#cb26-1174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span></span>
<span id="cb26-1175"><a href="#cb26-1175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb26-1176"><a href="#cb26-1176" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-1177"><a href="#cb26-1177" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb26-1178"><a href="#cb26-1178" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb26-1179"><a href="#cb26-1179" aria-hidden="true" tabindex="-1"></a>    <span class="at">productLeastImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-1180"><a href="#cb26-1180" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-1181"><a href="#cb26-1181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, productLeastImpact)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-1182"><a href="#cb26-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(bottomHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span>    </span>
<span id="cb26-1183"><a href="#cb26-1183" aria-hidden="true" tabindex="-1"></a>      <span class="co"># this uses topHourFactors to target factors for removal</span></span>
<span id="cb26-1184"><a href="#cb26-1184" aria-hidden="true" tabindex="-1"></a>      <span class="co"># does it work in this plot?</span></span>
<span id="cb26-1185"><a href="#cb26-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-1186"><a href="#cb26-1186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> totalHours, <span class="at">y =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb26-1187"><a href="#cb26-1187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"dodgerblue4"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span>  </span>
<span id="cb26-1188"><a href="#cb26-1188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb26-1189"><a href="#cb26-1189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> </span>
<span id="cb26-1190"><a href="#cb26-1190" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(estYearlyHourChange_Reason, <span class="st">" hrs/yr"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-1191"><a href="#cb26-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb26-1192"><a href="#cb26-1192" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1600</span>),</span>
<span id="cb26-1193"><a href="#cb26-1193" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1600</span>, <span class="dv">250</span>),</span>
<span id="cb26-1194"><a href="#cb26-1194" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1600</span>, <span class="dv">50</span>),</span>
<span id="cb26-1195"><a href="#cb26-1195" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"bottom"</span></span>
<span id="cb26-1196"><a href="#cb26-1196" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-1197"><a href="#cb26-1197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bottom impact"</span>,</span>
<span id="cb26-1198"><a href="#cb26-1198" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"30 call reasons with the most negative growth </span></span>
<span id="cb26-1199"><a href="#cb26-1199" aria-hidden="true" tabindex="-1"></a><span class="st">and most level-of-effort"</span>,</span>
<span id="cb26-1200"><a href="#cb26-1200" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Level-of-effort: Total hours worked"</span>,</span>
<span id="cb26-1201"><a href="#cb26-1201" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Reasons (top to bottom: least to most negative impact"</span>) <span class="sc">+</span></span>
<span id="cb26-1202"><a href="#cb26-1202" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_viridis(discrete = T, option = "cividis") +</span></span>
<span id="cb26-1203"><a href="#cb26-1203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() </span>
<span id="cb26-1204"><a href="#cb26-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1205"><a href="#cb26-1205" aria-hidden="true" tabindex="-1"></a>bottomHourFactors <span class="ot">&lt;-</span> bottomHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb26-1206"><a href="#cb26-1206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(productLeastImpact)) <span class="sc">%&gt;%</span></span>
<span id="cb26-1207"><a href="#cb26-1207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-1208"><a href="#cb26-1208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="co"># discard the empty factor levels</span></span>
<span id="cb26-1209"><a href="#cb26-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1210"><a href="#cb26-1210" aria-hidden="true" tabindex="-1"></a>crBottomGrowthHours <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-1211"><a href="#cb26-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason, year) <span class="sc">%&gt;%</span></span>
<span id="cb26-1212"><a href="#cb26-1212" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb26-1213"><a href="#cb26-1213" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-1214"><a href="#cb26-1214" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb26-1215"><a href="#cb26-1215" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYearlyHourChange_Reason =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason),</span>
<span id="cb26-1216"><a href="#cb26-1216" aria-hidden="true" tabindex="-1"></a>    <span class="at">productLeastImpact =</span> <span class="fu">mean</span>(estYearlyHourChange_Reason) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-1217"><a href="#cb26-1217" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-1218"><a href="#cb26-1218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(call_reason <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">levels</span>(bottomHourFactors[[<span class="dv">1</span>]]))) <span class="sc">%&gt;%</span></span>
<span id="cb26-1219"><a href="#cb26-1219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-1220"><a href="#cb26-1220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_reason =</span> <span class="fu">fct_reorder</span>(call_reason, productLeastImpact)) </span>
<span id="cb26-1221"><a href="#cb26-1221" aria-hidden="true" tabindex="-1"></a>        <span class="co"># this fct_reorder isn't working to reorder the facets</span></span>
<span id="cb26-1222"><a href="#cb26-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1223"><a href="#cb26-1223" aria-hidden="true" tabindex="-1"></a>crBottomGrowthHours <span class="sc">%&gt;%</span></span>
<span id="cb26-1224"><a href="#cb26-1224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb26-1225"><a href="#cb26-1225" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> totalHours, </span>
<span id="cb26-1226"><a href="#cb26-1226" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> call_reason)) <span class="sc">+</span></span>
<span id="cb26-1227"><a href="#cb26-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb26-1228"><a href="#cb26-1228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb26-1229"><a href="#cb26-1229" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb26-1230"><a href="#cb26-1230" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">8</span>,</span>
<span id="cb26-1231"><a href="#cb26-1231" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>,</span>
<span id="cb26-1232"><a href="#cb26-1232" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb26-1233"><a href="#cb26-1233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leaderboard: Bottom impact"</span>,</span>
<span id="cb26-1234"><a href="#cb26-1234" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"9 call reasons with the most hours that have decreased the most"</span>,</span>
<span id="cb26-1235"><a href="#cb26-1235" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb26-1236"><a href="#cb26-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb26-1237"><a href="#cb26-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb26-1238"><a href="#cb26-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb26-1239"><a href="#cb26-1239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>call_reason) <span class="sc">+</span></span>
<span id="cb26-1240"><a href="#cb26-1240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> </span>
<span id="cb26-1241"><a href="#cb26-1241" aria-hidden="true" tabindex="-1"></a>          <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb26-1242"><a href="#cb26-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1243"><a href="#cb26-1243" aria-hidden="true" tabindex="-1"></a>bottomHourFactors <span class="ot">&lt;-</span> bottomHourFactors <span class="sc">%&gt;%</span></span>
<span id="cb26-1244"><a href="#cb26-1244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(call_reason, totalHours, estYearlyHourChange_Reason))</span>
<span id="cb26-1245"><a href="#cb26-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1246"><a href="#cb26-1246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-1247"><a href="#cb26-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1248"><a href="#cb26-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1249"><a href="#cb26-1249" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-1250"><a href="#cb26-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1251"><a href="#cb26-1251" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specific questions for analysis</span></span>
<span id="cb26-1252"><a href="#cb26-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1253"><a href="#cb26-1253" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>What call reasons have decreased the most in terms of personnel time?</span>
<span id="cb26-1254"><a href="#cb26-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1255"><a href="#cb26-1255" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1256"><a href="#cb26-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1257"><a href="#cb26-1257" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false}</span>
<span id="cb26-1258"><a href="#cb26-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1259"><a href="#cb26-1259" aria-hidden="true" tabindex="-1"></a><span class="fu">## An answer!</span></span>
<span id="cb26-1260"><a href="#cb26-1260" aria-hidden="true" tabindex="-1"></a><span class="in">`r bottomHourFactors`</span></span>
<span id="cb26-1261"><a href="#cb26-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1262"><a href="#cb26-1262" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1263"><a href="#cb26-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1264"><a href="#cb26-1264" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparing themes</span></span>
<span id="cb26-1265"><a href="#cb26-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1266"><a href="#cb26-1266" aria-hidden="true" tabindex="-1"></a>I would still find it helpful to paint with a broader brush. As I described earlier, I interpreted each of the <span class="in">`r as.character(length(levels(callReasonsDF$call_reason))[1])`</span> call reasons according to <span class="in">`r as.character(length(levels(callReasonsDF$call_theme))[1])`</span> call themes:</span>
<span id="cb26-1267"><a href="#cb26-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1268"><a href="#cb26-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1269"><a href="#cb26-1269" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb26-1270"><a href="#cb26-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1271"><a href="#cb26-1271" aria-hidden="true" tabindex="-1"></a><span class="fu">## Public safety themes</span></span>
<span id="cb26-1272"><a href="#cb26-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1273"><a href="#cb26-1273" aria-hidden="true" tabindex="-1"></a><span class="in">`r levels(callReasonsDF$call_theme)`</span></span>
<span id="cb26-1274"><a href="#cb26-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1275"><a href="#cb26-1275" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1276"><a href="#cb26-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1277"><a href="#cb26-1277" aria-hidden="true" tabindex="-1"></a>Let's find out impact in terms of theme.</span>
<span id="cb26-1278"><a href="#cb26-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1279"><a href="#cb26-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1280"><a href="#cb26-1280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByTheme1, fig.width=10, fig.height=6}</span></span>
<span id="cb26-1281"><a href="#cb26-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1282"><a href="#cb26-1282" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-1283"><a href="#cb26-1283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_theme) <span class="sc">%&gt;%</span></span>
<span id="cb26-1284"><a href="#cb26-1284" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb26-1285"><a href="#cb26-1285" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-1286"><a href="#cb26-1286" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb26-1287"><a href="#cb26-1287" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYear_HoursByTheme =</span> <span class="fu">mean</span>(estYear_HoursByTheme),</span>
<span id="cb26-1288"><a href="#cb26-1288" aria-hidden="true" tabindex="-1"></a>    <span class="at">productImpact =</span> <span class="fu">mean</span>(estYear_HoursByTheme) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-1289"><a href="#cb26-1289" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-1290"><a href="#cb26-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_theme =</span> <span class="fu">fct_reorder</span>(call_theme, productImpact)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-1291"><a href="#cb26-1291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> totalHours, <span class="at">y =</span> call_theme)) <span class="sc">+</span></span>
<span id="cb26-1292"><a href="#cb26-1292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"purple4"</span>, <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb26-1293"><a href="#cb26-1293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"orangered"</span>) <span class="sc">+</span> </span>
<span id="cb26-1294"><a href="#cb26-1294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(estYear_HoursByTheme, <span class="st">" hrs/yr"</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb26-1295"><a href="#cb26-1295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb26-1296"><a href="#cb26-1296" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2900</span>),</span>
<span id="cb26-1297"><a href="#cb26-1297" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2900</span>, <span class="dv">500</span>),</span>
<span id="cb26-1298"><a href="#cb26-1298" aria-hidden="true" tabindex="-1"></a>    <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2900</span>, <span class="dv">250</span>),</span>
<span id="cb26-1299"><a href="#cb26-1299" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"bottom"</span></span>
<span id="cb26-1300"><a href="#cb26-1300" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-1301"><a href="#cb26-1301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Thematic impact"</span>,</span>
<span id="cb26-1302"><a href="#cb26-1302" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"Call themes by level-of-effort and growth"</span>,</span>
<span id="cb26-1303"><a href="#cb26-1303" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Level-of-effort: Total hours worked"</span>,</span>
<span id="cb26-1304"><a href="#cb26-1304" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Themes (top to bottom: most to least impact)"</span>) <span class="sc">+</span></span>
<span id="cb26-1305"><a href="#cb26-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() </span>
<span id="cb26-1306"><a href="#cb26-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1307"><a href="#cb26-1307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-1308"><a href="#cb26-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1309"><a href="#cb26-1309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkByTheme2, fig.width=10, fig.height=10}</span></span>
<span id="cb26-1310"><a href="#cb26-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1311"><a href="#cb26-1311" aria-hidden="true" tabindex="-1"></a>callReasonsDF <span class="sc">%&gt;%</span></span>
<span id="cb26-1312"><a href="#cb26-1312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_theme, year) <span class="sc">%&gt;%</span></span>
<span id="cb26-1313"><a href="#cb26-1313" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(</span>
<span id="cb26-1314"><a href="#cb26-1314" aria-hidden="true" tabindex="-1"></a>    <span class="at">totalHours =</span> <span class="fu">sum</span>(totalHours),</span>
<span id="cb26-1315"><a href="#cb26-1315" aria-hidden="true" tabindex="-1"></a>    <span class="at">percentOfAllHours =</span> <span class="fu">round</span>(totalHours <span class="sc">/</span> grandTotalHours <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb26-1316"><a href="#cb26-1316" aria-hidden="true" tabindex="-1"></a>    <span class="at">estYear_HoursByTheme =</span> <span class="fu">mean</span>(estYear_HoursByTheme),</span>
<span id="cb26-1317"><a href="#cb26-1317" aria-hidden="true" tabindex="-1"></a>    <span class="at">productImpact =</span> <span class="fu">mean</span>(estYear_HoursByTheme) <span class="sc">*</span> <span class="fu">sum</span>(totalHours)</span>
<span id="cb26-1318"><a href="#cb26-1318" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb26-1319"><a href="#cb26-1319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">call_theme =</span> <span class="fu">fct_reorder</span>(call_theme, productImpact)) <span class="sc">%&gt;%</span></span>
<span id="cb26-1320"><a href="#cb26-1320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb26-1321"><a href="#cb26-1321" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> totalHours, </span>
<span id="cb26-1322"><a href="#cb26-1322" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> call_theme)) <span class="sc">+</span></span>
<span id="cb26-1323"><a href="#cb26-1323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"lavenderblush"</span>) <span class="sc">+</span></span>
<span id="cb26-1324"><a href="#cb26-1324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm,</span>
<span id="cb26-1325"><a href="#cb26-1325" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb26-1326"><a href="#cb26-1326" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> .<span class="dv">8</span>,</span>
<span id="cb26-1327"><a href="#cb26-1327" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"orangered"</span>,</span>
<span id="cb26-1328"><a href="#cb26-1328" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb26-1329"><a href="#cb26-1329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Leaderboard: Theme impact"</span>,</span>
<span id="cb26-1330"><a href="#cb26-1330" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Hours"</span>) <span class="sc">+</span></span>
<span id="cb26-1331"><a href="#cb26-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete =</span> T, <span class="at">option =</span> <span class="st">"cividis"</span>) <span class="sc">+</span></span>
<span id="cb26-1332"><a href="#cb26-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb26-1333"><a href="#cb26-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb26-1334"><a href="#cb26-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>call_theme) <span class="sc">+</span></span>
<span id="cb26-1335"><a href="#cb26-1335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> </span>
<span id="cb26-1336"><a href="#cb26-1336" aria-hidden="true" tabindex="-1"></a>          <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>, <span class="at">color =</span> <span class="st">"gray40"</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb26-1337"><a href="#cb26-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1338"><a href="#cb26-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-1339"><a href="#cb26-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1340"><a href="#cb26-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1341"><a href="#cb26-1341" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-1342"><a href="#cb26-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1343"><a href="#cb26-1343" aria-hidden="true" tabindex="-1"></a><span class="fu">## Specific questions for analysis</span></span>
<span id="cb26-1344"><a href="#cb26-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1345"><a href="#cb26-1345" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>What can we learn about the public safety impact of change in calls in terms of broad themes?</span>
<span id="cb26-1346"><a href="#cb26-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1347"><a href="#cb26-1347" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1348"><a href="#cb26-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1349"><a href="#cb26-1349" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip icon=false}</span>
<span id="cb26-1350"><a href="#cb26-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1351"><a href="#cb26-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">## An answer!</span></span>
<span id="cb26-1352"><a href="#cb26-1352" aria-hidden="true" tabindex="-1"></a>Call themes with substantial growth are, from most to least impact: Administration, Other Safety, Medical, Utility, and Prevention.</span>
<span id="cb26-1353"><a href="#cb26-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1354"><a href="#cb26-1354" aria-hidden="true" tabindex="-1"></a>Call themes with small growth and impact: Nonviolent Crime, Fire, and Mental Health or Social Work.</span>
<span id="cb26-1355"><a href="#cb26-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1356"><a href="#cb26-1356" aria-hidden="true" tabindex="-1"></a>One call theme has negative growth and small impact: Violent Crime.</span>
<span id="cb26-1357"><a href="#cb26-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1358"><a href="#cb26-1358" aria-hidden="true" tabindex="-1"></a>One call theme has negative growth and enormous impact: Vehicular.</span>
<span id="cb26-1359"><a href="#cb26-1359" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1360"><a href="#cb26-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1361"><a href="#cb26-1361" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conclusion and Discussion</span></span>
<span id="cb26-1362"><a href="#cb26-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1363"><a href="#cb26-1363" aria-hidden="true" tabindex="-1"></a>This was the story of two small, rural Massachusetts towns that have made an agreement to combine their local police departments. By collecting, transforming, and analyzing 5 years of police call data, I've uncovered details about the share of call volume and level-of-effort between the towns, comparison of the level-of-effort of call reasons and how that effort has grown or decreased in the 5-year period, and more broadly, the comparison of level-of-effort growth and decrease observed in 10 public safety themes.</span>
<span id="cb26-1364"><a href="#cb26-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1365"><a href="#cb26-1365" aria-hidden="true" tabindex="-1"></a>By pursuing 6 lines of specific inquiry, my goal was to answer the following general research question:</span>
<span id="cb26-1366"><a href="#cb26-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1367"><a href="#cb26-1367" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning icon=false}</span>
<span id="cb26-1368"><a href="#cb26-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1369"><a href="#cb26-1369" aria-hidden="true" tabindex="-1"></a><span class="fu">## Research question</span></span>
<span id="cb26-1370"><a href="#cb26-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1371"><a href="#cb26-1371" aria-hidden="true" tabindex="-1"></a>**What is the nature of public safety need behind the increase in calls that police respond to?**</span>
<span id="cb26-1372"><a href="#cb26-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1373"><a href="#cb26-1373" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1374"><a href="#cb26-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1375"><a href="#cb26-1375" aria-hidden="true" tabindex="-1"></a>The nature of increased public safety need in Leverett and Wendell appears to be primarily administrative in nature, followed by a variety of 'other safety' calls, medical first response, support of utility service providers, and preventive policing. </span>
<span id="cb26-1376"><a href="#cb26-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1377"><a href="#cb26-1377" aria-hidden="true" tabindex="-1"></a>My research was prompted by the LPD request to the town to create a 4th full-time police officer position to overcome these problems:</span>
<span id="cb26-1378"><a href="#cb26-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1379"><a href="#cb26-1379" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Decreased supply of police officer human resources due to state criminal justice reform.</span>
<span id="cb26-1380"><a href="#cb26-1380" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Increased demand for police officer human resources due to increased call volume in the towns of Leverett and Wendell.</span>
<span id="cb26-1381"><a href="#cb26-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1382"><a href="#cb26-1382" aria-hidden="true" tabindex="-1"></a>Human resource and scheduling needs are important and the problems of POST reform are significant, however the first question is not within the scope of my research question. </span>
<span id="cb26-1383"><a href="#cb26-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1384"><a href="#cb26-1384" aria-hidden="true" tabindex="-1"></a>For the second question, I propose that my analysis shows the inadequacy of a rationale for hiring based on increased call volume without consideration of how level-of-effort (hours per call) has changed. Police hours on calls in Leverett and Wendell, with a department of 3 full-time officers, have not exceeded 1 FTE in the 5-year period 2018-2022. At a growth rate of +0.04 FTE/year it will take 25 years to justify LPD personnel growth by 1 FTE. In addition, I propose that the cause of emergency calls that police respond to is important: If these towns are dealing primarily with unmet medical needs and increased utility work along with administrative tasks, I find it difficult to understand how more police officers will help meet these needs. Since most our increased needs appear to be about administration, medical emergency, and utility service support, hiring additional police officers seems like the wrong move. </span>
<span id="cb26-1385"><a href="#cb26-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1386"><a href="#cb26-1386" aria-hidden="true" tabindex="-1"></a>More officers would likely help with preventive policing and 'other safety' calls, and the case can be made that the efforts of preventive policing have contributed to the low growth rate of nonviolent crime and the negative rate of violent crime. Setting aside that this data doesn't verify a causal relationship between prevention work and crime rates, the low crime numbers throughout the 5-year period makes me want to find out how much more reduction is possible, and whether the amount of work done on preventive police activities is proportional. </span>
<span id="cb26-1387"><a href="#cb26-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1388"><a href="#cb26-1388" aria-hidden="true" tabindex="-1"></a>If I could recommend a course of action to Leverett and Wendell, it would be to take a closer look at administration, 'other safety', medical, utility, and prevention calls: ask if policing is the efficacious public response to the needs that drive these calls, or whether there are alternatives to policing that could better meet needs and ease the challenge of public administration. It so happens that I can make this recommendation, because I live here and I have been active in my town's government.</span>
<span id="cb26-1389"><a href="#cb26-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1390"><a href="#cb26-1390" aria-hidden="true" tabindex="-1"></a>My analysis is limited by assumptions made about the call data as an accurate representation of public safety incidents and police response -- when in fact we've learned that Wendell call data is very poor quality before 2020. My attempt to classify call reasons by themes is not well-informed by criminal justice standards, and I'd need to address this before others could adopt the methodology. My plots reflect my inexperience with linear regression modeling, and my aesthetic deficits.</span>
<span id="cb26-1391"><a href="#cb26-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1392"><a href="#cb26-1392" aria-hidden="true" tabindex="-1"></a>If I continue my research of this topic, I'd like to search for data that supports analysis about: </span>
<span id="cb26-1393"><a href="#cb26-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1394"><a href="#cb26-1394" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The relationship between level-of-effort and change over time to call actions taken by officers, details of which are included in this data set.</span>
<span id="cb26-1395"><a href="#cb26-1395" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Demographics of people involved in calls (responding officers, suspects, victims and other affected parties), which is only partially included in this data set.</span>
<span id="cb26-1396"><a href="#cb26-1396" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Police work details not included in this data, such as time of year, day of week, and time of day patterns; geographic information; officer call notes; and relationships between different calls reasons.</span>
<span id="cb26-1397"><a href="#cb26-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1398"><a href="#cb26-1398" aria-hidden="true" tabindex="-1"></a>I hope that my data and thematic analysis demonstrates an approach to examining police work in a rural small town setting that's useful to municipal administrators responsible for police oversight, personnel budgets, public safety decision-making, and data-driven community dialogue.</span>
<span id="cb26-1399"><a href="#cb26-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1400"><a href="#cb26-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1401"><a href="#cb26-1401" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bibliography</span></span>
<span id="cb26-1402"><a href="#cb26-1402" aria-hidden="true" tabindex="-1"></a>I received the data for this analysis by email directly from LPD Chief Scott Minckler in late March, 2023. The original format of the data was 10 PDF reports exported from the police department's software application <span class="co">[</span><span class="ot">IMC-Central Square</span><span class="co">](https://www.centralsquare.com/)</span>. Follow this link for copies of the original reports, as well as CSV exports from this analysis of the call reason, call action, and operator demographic data parsed from the source reports: </span>
<span id="cb26-1403"><a href="#cb26-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1404"><a href="#cb26-1404" aria-hidden="true" tabindex="-1"></a><span class="ot">&lt;https://github.com/timshores/601_Spring_2023/tree/template/posts/TimShores_FinalProject_Data&gt;</span></span>
<span id="cb26-1405"><a href="#cb26-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1406"><a href="#cb26-1406" aria-hidden="true" tabindex="-1"></a><span class="fu">## Appendix </span></span>
<span id="cb26-1407"><a href="#cb26-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1408"><a href="#cb26-1408" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Dictionary</span></span>
<span id="cb26-1409"><a href="#cb26-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1410"><a href="#cb26-1410" aria-hidden="true" tabindex="-1"></a>These are the final data frame variables: </span>
<span id="cb26-1411"><a href="#cb26-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1412"><a href="#cb26-1412" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb26-1413"><a href="#cb26-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1414"><a href="#cb26-1414" aria-hidden="true" tabindex="-1"></a><span class="fu">## callReasonsDF</span></span>
<span id="cb26-1415"><a href="#cb26-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1416"><a href="#cb26-1416" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(callReasonsDF)[3]`**: factor with 121 levels, describes the type of incident that resulted in a call to LPD or Shelburne Dispatch</span>
<span id="cb26-1417"><a href="#cb26-1417" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(callReasonsDF)[4]`**: the number of calls per call_reason made directly to LPD (or WPD before 2021)</span>
<span id="cb26-1418"><a href="#cb26-1418" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(callReasonsDF)[5]`**: the number of calls per call_reason made to Shelburne Dispatch</span>
<span id="cb26-1419"><a href="#cb26-1419" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(callReasonsDF)[6]`**: mean time in hours to work per call. </span>
<span id="cb26-1420"><a href="#cb26-1420" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1421"><a href="#cb26-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1422"><a href="#cb26-1422" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb26-1423"><a href="#cb26-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1424"><a href="#cb26-1424" aria-hidden="true" tabindex="-1"></a><span class="fu">## callActionsDF</span></span>
<span id="cb26-1425"><a href="#cb26-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1426"><a href="#cb26-1426" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(callActionsDF)[3]`**: Factor with 121 levels, same as in callReasonsDF</span>
<span id="cb26-1427"><a href="#cb26-1427" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(callActionsDF)[4]`**: Factor with 47 levels, one for each action outcome for a call</span>
<span id="cb26-1428"><a href="#cb26-1428" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(callActionsDF)[5]`**: Count of actionnames for each call_reason</span>
<span id="cb26-1429"><a href="#cb26-1429" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1430"><a href="#cb26-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1431"><a href="#cb26-1431" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb26-1432"><a href="#cb26-1432" aria-hidden="true" tabindex="-1"></a><span class="fu">## operatorSummaryDF</span></span>
<span id="cb26-1433"><a href="#cb26-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1434"><a href="#cb26-1434" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(operatorSummaryDF)[3]`**: Factor with 3 levels: Ethnicity, Race, or Sex</span>
<span id="cb26-1435"><a href="#cb26-1435" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(operatorSummaryDF)[4]`**: Factor with 11 levels corresponding to specific ethnicity, races, sexes</span>
<span id="cb26-1436"><a href="#cb26-1436" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(operatorSummaryDF)[4]`**: Count of vehicle operators for each opid</span>
<span id="cb26-1437"><a href="#cb26-1437" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1438"><a href="#cb26-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1439"><a href="#cb26-1439" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon=false}</span>
<span id="cb26-1440"><a href="#cb26-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1441"><a href="#cb26-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key variables</span></span>
<span id="cb26-1442"><a href="#cb26-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1443"><a href="#cb26-1443" aria-hidden="true" tabindex="-1"></a>Each data frame includes the following variables that identify when and where the incident and response happened:</span>
<span id="cb26-1444"><a href="#cb26-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1445"><a href="#cb26-1445" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(callReasonsDF)[1]`**: 2-level factor, Leverett or Wendell</span>
<span id="cb26-1446"><a href="#cb26-1446" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`r colnames(callReasonsDF)[2]`**: date, 2018 to 2022 (in all cases, month = 1 and day = 1)</span>
<span id="cb26-1447"><a href="#cb26-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1448"><a href="#cb26-1448" aria-hidden="true" tabindex="-1"></a>I can join reason and action data by using town, year, and call_reason as a compound key.</span>
<span id="cb26-1449"><a href="#cb26-1449" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb26-1450"><a href="#cb26-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1451"><a href="#cb26-1451" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sample summaries of the call reasons data frame</span></span>
<span id="cb26-1452"><a href="#cb26-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1453"><a href="#cb26-1453" aria-hidden="true" tabindex="-1"></a>To get a sense of the scale of time spent on calls, these 3 tables show (1) a summary of time per call by the top 5 call reason mean times; (2) a summary of time per call by town; and (3) a summary of time per call by year.</span>
<span id="cb26-1454"><a href="#cb26-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1455"><a href="#cb26-1455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r chunkAppendix}</span></span>
<span id="cb26-1456"><a href="#cb26-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1457"><a href="#cb26-1457" aria-hidden="true" tabindex="-1"></a><span class="co">#define function to calculate mode</span></span>
<span id="cb26-1458"><a href="#cb26-1458" aria-hidden="true" tabindex="-1"></a>find_mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb26-1459"><a href="#cb26-1459" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">unique</span>(x[<span class="sc">!</span><span class="fu">is.na</span>(x)]) <span class="co"># unique list as an index, without NA</span></span>
<span id="cb26-1460"><a href="#cb26-1460" aria-hidden="true" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">tabulate</span>(<span class="fu">match</span>(x[<span class="sc">!</span><span class="fu">is.na</span>(x)], u))  <span class="co"># count how many times each index member occurs</span></span>
<span id="cb26-1461"><a href="#cb26-1461" aria-hidden="true" tabindex="-1"></a>  u[tab <span class="sc">==</span> <span class="fu">max</span>(tab)] <span class="co">#  the max occurrence is the mode</span></span>
<span id="cb26-1462"><a href="#cb26-1462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(u) <span class="co"># return mean in case the data is multimodal</span></span>
<span id="cb26-1463"><a href="#cb26-1463" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-1464"><a href="#cb26-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1465"><a href="#cb26-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1466"><a href="#cb26-1466" aria-hidden="true" tabindex="-1"></a>callReasonsDF_ReasonSummary <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span> </span>
<span id="cb26-1467"><a href="#cb26-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(call_reason) <span class="sc">%&gt;%</span> </span>
<span id="cb26-1468"><a href="#cb26-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb26-1469"><a href="#cb26-1469" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanHrs =</span> <span class="fu">mean</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb26-1470"><a href="#cb26-1470" aria-hidden="true" tabindex="-1"></a>    <span class="at">modeHrs =</span> <span class="fu">find_mode</span>(avg_hours_per_call), </span>
<span id="cb26-1471"><a href="#cb26-1471" aria-hidden="true" tabindex="-1"></a>    <span class="at">minHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>], </span>
<span id="cb26-1472"><a href="#cb26-1472" aria-hidden="true" tabindex="-1"></a>    <span class="at">lHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">2</span>], </span>
<span id="cb26-1473"><a href="#cb26-1473" aria-hidden="true" tabindex="-1"></a>    <span class="at">medHrs =</span> <span class="fu">median</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb26-1474"><a href="#cb26-1474" aria-hidden="true" tabindex="-1"></a>    <span class="at">uHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">4</span>], </span>
<span id="cb26-1475"><a href="#cb26-1475" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">5</span>]</span>
<span id="cb26-1476"><a href="#cb26-1476" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb26-1477"><a href="#cb26-1477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(meanHrs))</span>
<span id="cb26-1478"><a href="#cb26-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1479"><a href="#cb26-1479" aria-hidden="true" tabindex="-1"></a>crReasonRoundedDF <span class="ot">&lt;-</span> callReasonsDF_ReasonSummary <span class="sc">%&gt;%</span> </span>
<span id="cb26-1480"><a href="#cb26-1480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb26-1481"><a href="#cb26-1481" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(crReasonRoundedDF, <span class="dv">5</span>)</span>
<span id="cb26-1482"><a href="#cb26-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1483"><a href="#cb26-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1484"><a href="#cb26-1484" aria-hidden="true" tabindex="-1"></a>callReasonsDF_TownSummary <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span> </span>
<span id="cb26-1485"><a href="#cb26-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(town) <span class="sc">%&gt;%</span> </span>
<span id="cb26-1486"><a href="#cb26-1486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb26-1487"><a href="#cb26-1487" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanHrs =</span> <span class="fu">mean</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb26-1488"><a href="#cb26-1488" aria-hidden="true" tabindex="-1"></a>    <span class="at">modeHrs =</span> <span class="fu">find_mode</span>(avg_hours_per_call), </span>
<span id="cb26-1489"><a href="#cb26-1489" aria-hidden="true" tabindex="-1"></a>    <span class="at">minHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>], </span>
<span id="cb26-1490"><a href="#cb26-1490" aria-hidden="true" tabindex="-1"></a>    <span class="at">lHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">2</span>], </span>
<span id="cb26-1491"><a href="#cb26-1491" aria-hidden="true" tabindex="-1"></a>    <span class="at">medHrs =</span> <span class="fu">median</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb26-1492"><a href="#cb26-1492" aria-hidden="true" tabindex="-1"></a>    <span class="at">uHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">4</span>], </span>
<span id="cb26-1493"><a href="#cb26-1493" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">5</span>]</span>
<span id="cb26-1494"><a href="#cb26-1494" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb26-1495"><a href="#cb26-1495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(meanHrs))</span>
<span id="cb26-1496"><a href="#cb26-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1497"><a href="#cb26-1497" aria-hidden="true" tabindex="-1"></a>crTownRoundedDF <span class="ot">&lt;-</span> callReasonsDF_TownSummary <span class="sc">%&gt;%</span> </span>
<span id="cb26-1498"><a href="#cb26-1498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb26-1499"><a href="#cb26-1499" aria-hidden="true" tabindex="-1"></a>crTownRoundedDF</span>
<span id="cb26-1500"><a href="#cb26-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1501"><a href="#cb26-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1502"><a href="#cb26-1502" aria-hidden="true" tabindex="-1"></a>callReasonsDF_YearSummary <span class="ot">&lt;-</span> callReasonsDF <span class="sc">%&gt;%</span> </span>
<span id="cb26-1503"><a href="#cb26-1503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb26-1504"><a href="#cb26-1504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb26-1505"><a href="#cb26-1505" aria-hidden="true" tabindex="-1"></a>    <span class="at">meanHrs =</span> <span class="fu">mean</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb26-1506"><a href="#cb26-1506" aria-hidden="true" tabindex="-1"></a>    <span class="at">modeHrs =</span> <span class="fu">find_mode</span>(avg_hours_per_call), </span>
<span id="cb26-1507"><a href="#cb26-1507" aria-hidden="true" tabindex="-1"></a>    <span class="at">minHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>], </span>
<span id="cb26-1508"><a href="#cb26-1508" aria-hidden="true" tabindex="-1"></a>    <span class="at">lHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">2</span>], </span>
<span id="cb26-1509"><a href="#cb26-1509" aria-hidden="true" tabindex="-1"></a>    <span class="at">medHrs =</span> <span class="fu">median</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb26-1510"><a href="#cb26-1510" aria-hidden="true" tabindex="-1"></a>    <span class="at">uHingeHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">4</span>], </span>
<span id="cb26-1511"><a href="#cb26-1511" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxHrs =</span> <span class="fu">fivenum</span>(avg_hours_per_call, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)[<span class="dv">5</span>]</span>
<span id="cb26-1512"><a href="#cb26-1512" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb26-1513"><a href="#cb26-1513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(meanHrs))</span>
<span id="cb26-1514"><a href="#cb26-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1515"><a href="#cb26-1515" aria-hidden="true" tabindex="-1"></a>crYearRoundedDF <span class="ot">&lt;-</span> callReasonsDF_YearSummary <span class="sc">%&gt;%</span> </span>
<span id="cb26-1516"><a href="#cb26-1516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb26-1517"><a href="#cb26-1517" aria-hidden="true" tabindex="-1"></a>crYearRoundedDF</span>
<span id="cb26-1518"><a href="#cb26-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-1519"><a href="#cb26-1519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>